(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[27,39],{165:function(e,t,c){"use strict";c.r(t),c.d(t,"Orders",(function(){return m})),c.d(t,"FullOrder",(function(){return g})),c.d(t,"Disputes",(function(){return N})),c.d(t,"FullDispute",(function(){return S}));var n=c(23),s=c.n(n),i=c(28),r=c(13),l=c(10),a=c(3),j=c(1),d=c(9),o=c(4),b=c(2),u=c(12),O=c(17),h=c(174),x=c(0),f=Object(j.lazy)((function(){return Promise.all([c.e(0),c.e(4)]).then(c.bind(null,158)).then((function(e){return{default:e.MilestoneForm}}))})),m=function(e){var t=e.status,c=e.onClick,n=Object(j.useContext)(u.d),s=n.cart,i=n.userType,r=Object(j.useState)(0),b=Object(a.a)(r,2),h=b[0],f=b[1],m=Object(j.useState)(1),g=Object(a.a)(m,2),y=g[0],N=g[1],C=Object(j.useState)(20),S=Object(a.a)(C,2),k=S[0],D=(S[1],Object(j.useState)("")),M=Object(a.a)(D,2),Y=M[0],F=(M[1],Object(j.useState)("")),w=Object(a.a)(F,2),_=w[0],R=(w[1],Object(j.useState)(null)),A=Object(a.a)(R,2),P=A[0],E=(A[1],Object(j.useState)({column:"createdAt",order:"dsc"})),T=Object(a.a)(E,2),z=T[0],q=(T[1],Object(j.useState)([])),H=Object(a.a)(q,2),L=H[0],I=H[1],W=Object(j.useState)(!1),B=Object(a.a)(W,2),U=B[0],J=B[1],K=Object(j.useState)([]),V=Object(a.a)(K,2),G=V[0],Q=V[1],X=Object(j.useState)(null),Z=Object(a.a)(X,2),$=Z[0],ee=Z[1],te=Object(j.useState)([]),ce=Object(a.a)(te,2),ne=ce[0],se=ce[1];return Object(j.useEffect)((function(){var e,c=Object(d.L)({time:null===P||void 0===P?void 0:P.startDate,format:"YYYY-MM-DD"}),n=Object(d.L)({time:null===(e=new Date(null===P||void 0===P?void 0:P.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getOrders?".concat(new URLSearchParams(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({user:"buyer"},_&&{q:_}),{},{page:y,perPage:k,sort:z.column,order:z.order},P&&{dateFrom:c,dateTo:n}),Y&&{type:Y}),t&&{status:t})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(I(e.orders),f(e.total))})).catch((function(e){console.log(e),ee(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return ee(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[Y,_,y,k,P,t]),Object(j.useEffect)((function(){fetch("/api/getCartDetail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:s})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&se(e.carts)})).catch((function(e){console.log(e),ee(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return ee(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get cart detail. Make sure you're online."})]})]}))}))}),[s]),Object(j.useEffect)((function(){U||Q([])}),[U]),Object(j.useEffect)((function(){0===G.length&&J(!1)}),[G]),Object(x.jsxs)(x.Fragment,{children:["seller"===i&&Object(x.jsx)(o.a,{to:"/account/myShop/orders"}),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"My Orders"})}),G.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table orders",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Order"}),Object(x.jsx)("th",{className:"date",children:"Purchase Date"}),Object(x.jsx)("th",{children:"Total"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[L.map((function(e){return Object(x.jsx)(v,{onClick:c,order:e,setOrders:I,selectAll:U,setBatch:Q,batch:G},e._id)})),(null===t||void 0===t?void 0:t.includes("pending"))&&ne.map((function(e){return Object(x.jsx)(p,{order:e},e.seller._id)})),0===L.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No order yet."})})]})]}),Object(x.jsx)(d.u,{total:h,btns:5,currentPage:y,perPage:k,setPage:N}),Object(x.jsx)(O.Modal,{className:"msg",open:$,children:$})]})]})},p=function(e){var t,c=e.order,n=(e.setOrder,Object(j.useRef)()),s=Object(j.useRef)(),i=Object(o.g)(),r=+(c.products.reduce((function(e,t){return(e+Object(d.K)({product:t.product,gst:c.seller.gst})*t.qty).fix()}),0)+((null===(t=c.seller.shopInfo)||void 0===t?void 0:t.shippingCost)||0)).fix();return Object(x.jsxs)("tr",{className:"order",onClick:function(e){e.nativeEvent.path.includes(n.current)||e.nativeEvent.path.includes(s.current)||i.push("/account/cart")},children:[Object(x.jsx)("td",{children:"-"}),Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:new Date})}),Object(x.jsxs)("td",{children:["\u20b9",r]}),Object(x.jsx)("td",{children:"Draft"}),Object(x.jsx)("td",{ref:n,children:Object(x.jsx)(d.a,{icon:Object(x.jsx)(d.g,{}),children:Object(x.jsx)(b.b,{to:"/account/cart",children:"View Detail"})})})]})},v=function(e){var t=e.order,c=e.setOrders,n=e.selectAll,s=e.setBatch,i=e.batch,h=e.onClick,f=Object(j.useRef)(),m=Object(j.useRef)(),p=Object(o.g)(),v=(Object(j.useContext)(u.d).user,Object(j.useState)(n||!1)),g=Object(a.a)(v,2),y=g[0],N=g[1],C=Object(j.useState)(!1),S=Object(a.a)(C,2),k=(S[0],S[1],Object(j.useState)(!1)),D=Object(a.a)(k,2),M=D[0],Y=D[1],F=function(){fetch("/api/cancelOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(l.a)(Object(l.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))},w=function(){fetch("/api/requestCancellation",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(l.a)(Object(l.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))};return Object(j.useEffect)((function(){N(n)}),[n]),Object(j.useEffect)((function(){s(y?function(e){return[].concat(Object(r.a)(e),[t._id])}:function(e){return e.filter((function(e){return e!==t._id}))})}),[y]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"order ".concat(y?"selected":""),onClick:function(e){e.nativeEvent.path.includes(f.current)||e.nativeEvent.path.includes(m.current)||i.length>0||null===h||void 0===h||h(t._id)},children:[Object(x.jsx)("td",{children:t._id}),Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:t.createdAt})}),Object(x.jsxs)("td",{children:["\u20b9",t.total]}),Object(x.jsx)("td",{children:t.status}),Object(x.jsx)("td",{ref:f,children:0===i.length&&Object(x.jsxs)(d.a,{icon:Object(x.jsx)(d.g,{}),children:[Object(x.jsx)(b.b,{to:"".concat(p.location.pathname,"/").concat(t._id),children:"View Detail"}),"pending"===t.status&&Object(x.jsx)(b.b,{to:"#",onClick:function(e){Object(O.Confirm)({label:"Order Cancellation",question:"You sure want to cancel this order?",callback:F})},children:"Cancel order"}),"approved"===t.status&&Object(x.jsx)(b.b,{to:"#",onClick:function(e){Object(O.Confirm)({label:"Order Cancellation",question:"You sure want to request cancellation for this order?",callback:w})},children:"Request Cancellation"})]})})]}),Object(x.jsx)(O.Modal,{className:"msg",open:M,children:M})]})},g=function(e){var t=e.history,c=e.match,n=Object(j.useContext)(u.d).userType,s=Object(j.useState)(null),i=Object(a.a)(s,2),o=i[0],h=i[1],m=Object(j.useState)(null),p=Object(a.a)(m,2),v=p[0],g=p[1],N=Object(j.useState)(!1),C=Object(a.a)(N,2),S=C[0],k=C[1],D=Object(j.useState)(!1),M=Object(a.a)(D,2),Y=M[0],F=M[1],w=Object(j.useState)(!1),_=Object(a.a)(w,2),R=_[0],A=_[1];Object(j.useRef)();if(Object(j.useEffect)((function(){fetch("/api/singleOrder?_id=".concat(c.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?g(e.order):h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get order. Make sure you're online."})]})]}))}))}),[]),Object(j.useEffect)((function(){if("delivered"===(null===v||void 0===v?void 0:v.status)&&(null===v||void 0===v?void 0:v.refundable)){var e=0;switch(v.refundable){case"Upto 24 Hours After Delivery":e=1;break;case"Upto 7 Days After Delivery":e=7;break;case"Upto 15 Days After Delivery":e=15;break;default:return}var t=new Date((new Date).getTime()+864e5*e);new Date<t?F(t):F(null)}else F(null)}),[v]),v){var P,E,T,z,q,H,L=v.products.reduce((function(e,t){return(e+Object(d.K)({product:t.product,gst:!0})*t.qty).fix()}),0),I="percent"===(null===(P=v.coupon)||void 0===P?void 0:P.type)&&Math.min(L/100*v.coupon.amount,v.coupon.maxDiscount)||"flat"===(null===(E=v.coupon)||void 0===E?void 0:E.type)&&(null===(T=v.coupon)||void 0===T?void 0:T.amount)||0,W=((L-I+v.shippingCost)/100*v.fee).fix();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"actions",children:[Object(x.jsxs)(b.b,{to:"".concat(t.location.pathname.replace("/"+c.params._id,"")?t.location.pathname.replace("/"+c.params._id,""):"seller"===n?"/account/orders":"/account/orders/current"),className:"back",children:[Object(x.jsx)(d.c,{}),"Back"]}),Y&&Object(x.jsx)("button",{onClick:function(){return A(!0)},children:"Issue refund"})]}),Object(x.jsxs)("div",{className:"singleOrder",children:[Object(x.jsxs)("div",{className:"summery",children:[Object(x.jsx)("h3",{children:"Order Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Seller"}),Object(x.jsx)(d.G,{user:v.seller})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order ID"}),v._id]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status"}),v.status]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order placed"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:v.createdAt})]}),"delivered"===v.status&&Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivered at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:v.deliveredAt})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refundable"}),v.refundable||"N/A"]}),Y&&Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refund till"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:Y})]}),Object(x.jsx)("li",{}),Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Delivery Address"}),Object(x.jsx)("span",{})]}),Object(x.jsx)(x.Fragment,{children:Object.entries(v.deliveryDetail).map((function(e,t){var c=Object(a.a)(e,2),n=c[0],s=c[1];return"deliveryTime"===n?Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivery date"}),v.deliveryDetail.deliveryTime?Object(x.jsx)(d.s,{format:"DD MMM, YYYY hh:mma",children:v.deliveryDetail.deliveryTime}):"N/A"]},t):Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:n}),s]},t)}))})]})]}),Object(x.jsxs)("div",{className:"products",children:[Object(x.jsx)("h3",{children:"Products"}),Object(x.jsx)("ul",{children:v.products.map((function(e,t){var c=e.product,n=e.qty;return Object(x.jsxs)("li",{children:[Object(x.jsx)(d.n,{src:c.images[0]||"/open_box.png"}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsx)("p",{children:c.name}),Object(x.jsxs)("p",{className:"qty",children:["QTY: ",n]})]}),Object(x.jsxs)("div",{className:"price",children:[Object(x.jsxs)("span",{children:[Object(d.K)({product:c,gst:!0})," x ",n]}),"\u20b9",Object(d.K)({product:c,gst:!0})*n]})]},t)}))}),Object(x.jsxs)("div",{className:"total",children:[Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Total"}),"\u20b9",L]}),v.coupon&&Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Coupon Code ",v.coupon.code,Object(x.jsx)("br",{}),"Discount"," ","percent"===v.coupon.type?Object(x.jsxs)(x.Fragment,{children:[v.coupon.amount,"% (Upto \u20b9",v.coupon.maxDiscount,")"]}):Object(x.jsx)(x.Fragment,{children:"flat"})]}),Object(x.jsxs)("span",{children:["\u20b9",I]})]})}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Shipping"}),"\u20b9",v.shippingCost||"N/A"]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Delivery Pay fee ",v.fee,"%"]}),"\u20b9",W]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Grand Total"}),"\u20b9",v.total]})]})]}),Object(x.jsxs)("div",{className:"milestones",children:[Object(x.jsx)("h3",{children:"Milestones"}),Object(x.jsx)("p",{className:"subtitle",children:"Click to view milestone detail."}),Object(x.jsxs)("table",{cellSpacing:0,cellPadding:0,children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:"Date"}),Object(x.jsx)("td",{children:"Descrption"}),Object(x.jsx)("td",{children:"Amount"}),Object(x.jsx)("td",{children:"Status"})]})}),Object(x.jsxs)("tbody",{children:[v.milestones.map((function(e){return Object(x.jsxs)("tr",{onClick:function(){return t.push("/account/hold?q=".concat(e._id))},children:[Object(x.jsx)("td",{children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(x.jsx)("td",{children:e.dscr}),Object(x.jsxs)("td",{children:["\u20b9",e.amount]}),Object(x.jsx)("td",{children:e.status})]},e._id)})),0===v.milestones.length&&Object(x.jsx)("tr",{className:"placeholdert",children:Object(x.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(x.jsxs)("div",{className:"delivery",children:[Object(x.jsx)("h3",{children:"Proof of delivery"}),(null===(z=v.files)||void 0===z?void 0:z.length)>0?Object(x.jsx)("div",{className:"thumbs",children:Object(x.jsx)(d.q,{links:v.files})}):Object(x.jsx)(x.Fragment,{children:"No files added."})]}),Object(x.jsxs)("section",{className:"terms",children:[Object(x.jsx)("h3",{children:"Return Policy Terms"}),Object(x.jsxs)("ul",{children:[null===(q=v.terms)||void 0===q?void 0:q.map((function(e,t){return Object(x.jsx)("li",{children:e},t)})),!(null===(H=v.terms)||void 0===H?void 0:H.length)&&Object(x.jsx)("li",{children:"No terms has been set by the seller yet."})]})]})]}),Object(x.jsx)(O.Modal,{head:!0,label:"Create Milestone",setOpen:k,className:"milestoneRequest",open:S,children:Object(x.jsx)(f,{action:"create",definedAmount:v.total,client:v.seller,order:v._id,onSuccess:function(e){k(!1),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(x.jsx)("h4",{children:"Milestone has been created"})]}),Object(x.jsx)(b.b,{to:"/account/hold",onClick:function(){return h(null)},children:"Check your Delivery pay Hold"})]})),g((function(t){return Object(l.a)(Object(l.a)({},t),{},{milestones:[].concat(Object(r.a)(t.milestones),[e])})}))}})}),Object(x.jsx)(O.Modal,{open:R,head:!0,label:"Issue Refund",setOpen:A,className:"issueRefund",children:Object(x.jsx)(y,{order:v,onSuccess:function(e){A(!1),g((function(e){return Object(l.a)(Object(l.a)({},e),{},{status:"refundPending"})})),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Refund has been issued."})]})]}))}})}),Object(x.jsx)(O.Modal,{className:"msg",open:o,children:o})]})}return Object(x.jsx)(x.Fragment,{children:"Loading"})},y=function(e){var t=e.order,c=e.onSuccess,n=Object(j.useState)(null),r=Object(a.a)(n,2),l=r[0],o=r[1],b=Object(j.useState)(!1),u=Object(a.a)(b,2),f=u[0],m=u[1],p=Object(j.useState)(""),v=Object(a.a)(p,2),g=v[0],y=v[1],N=Object(j.useState)(""),C=Object(a.a)(N,2),S=C[0],k=C[1],D=Object(j.useState)([]),M=Object(a.a)(D,2),Y=M[0],F=M[1],w=function(){var e=Object(i.a)(s.a.mark((function e(n){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),m(!0),!Y.length){e.next=8;break}return e.next=5,Object(d.F)({files:Y,setMsg:o});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:i=e.t0,fetch("/api/issueRefund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t._id,issue:g,dscr:S,files:i})}).then((function(e){return e.json()})).then((function(e){m(!1),"ok"===e.code?null===c||void 0===c||c(e.refund):o(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return o(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund could not be issued. Try again."})]})]}))})).catch((function(e){m(!1),console.log(e),o(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return o(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund could not be issued. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("form",{onSubmit:w,children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Issue"}),Object(x.jsx)("input",{type:"text",required:!0,value:g,onChange:function(e){return y(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Descrption"}),Object(x.jsx)(h.a,{required:!0,value:S,onChange:function(e){return k(e.target.value)}})]}),Object(x.jsxs)("section",{className:"images",children:[Object(x.jsx)("label",{children:"Upload relevant files"}),Object(x.jsx)(d.k,{accept:"image/*, video/*, audio/*",multiple:!0,onChange:function(e){return F(e)}})]}),Object(x.jsx)("section",{className:"btns",children:Object(x.jsx)("button",{className:"submit",children:"Submit"})})]}),f&&Object(x.jsx)("div",{className:"spinnerContainer",children:Object(x.jsx)("div",{className:"spinner"})}),Object(x.jsx)(O.Modal,{className:"msg",open:l,children:l})]})},N=function(e){var t=e.status,c=Object(j.useState)(0),n=Object(a.a)(c,2),s=n[0],i=n[1],r=Object(j.useState)(1),o=Object(a.a)(r,2),b=o[0],u=o[1],h=Object(j.useState)(20),f=Object(a.a)(h,2),m=f[0],p=(f[1],Object(j.useState)("")),v=Object(a.a)(p,2),g=v[0],y=(v[1],Object(j.useState)({column:"createdAt",order:"dsc"})),N=Object(a.a)(y,2),S=N[0],k=(N[1],Object(j.useState)([])),D=Object(a.a)(k,2),M=D[0],Y=D[1],F=Object(j.useState)(!1),w=Object(a.a)(F,2),_=w[0],R=w[1],A=Object(j.useState)([]),P=Object(a.a)(A,2),E=P[0],T=P[1],z=Object(j.useState)(null),q=Object(a.a)(z,2),H=q[0],L=q[1];return Object(j.useEffect)((function(){fetch("/api/getDisputes?".concat(new URLSearchParams(Object(l.a)(Object(l.a)({},g&&{q:g}),{},{page:b,perPage:m,sort:S.column,order:S.order},t&&{status:t})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(Y(e.disputes),i(e.total))})).catch((function(e){console.log(e),L(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return L(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[g,b,m,t]),Object(j.useEffect)((function(){_||T([])}),[_]),Object(j.useEffect)((function(){0===E.length&&R(!1)}),[E]),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"My Disputes"})}),E.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table disuptes",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"date",children:"Raised at"}),Object(x.jsx)("th",{children:"User"}),Object(x.jsx)("th",{children:"Issue"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[M.map((function(e){return Object(x.jsx)(C,{dispute:e,setDisputes:Y},e._id)})),0===M.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No Dispute yet."})})]})]}),Object(x.jsx)(d.u,{total:s,btns:5,currentPage:b,perPage:m,setPage:u}),Object(x.jsx)(O.Modal,{className:"msg",open:H,children:H})]})},C=function(e){var t=e.dispute,c=(e.setDisputes,Object(j.useRef)()),n=Object(j.useRef)(),s=Object(o.g)(),i=Object(j.useContext)(u.d).user,r=Object(j.useState)(!1),l=Object(a.a)(r,2),h=(l[0],l[1],Object(j.useState)(!1)),f=Object(a.a)(h,2),m=f[0],p=(f[1],t.plaintiff._id===i._id?"defendant":"plaintiff");return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"dispute",onClick:function(e){e.nativeEvent.path.includes(c.current)||e.nativeEvent.path.includes(n.current)||s.push("".concat(s.location.pathname,"/").concat(t._id))},children:[Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:t.createdAt})}),Object(x.jsx)("td",{children:Object(x.jsx)(d.G,{user:t[p]})}),Object(x.jsx)("td",{children:t.issue}),Object(x.jsx)("td",{children:t.status}),Object(x.jsx)("td",{ref:c,children:Object(x.jsx)(d.a,{icon:Object(x.jsx)(d.g,{}),children:Object(x.jsx)(b.b,{to:"".concat(s.location.pathname,"/").concat(t._id),children:"View Detail"})})})]}),Object(x.jsx)(O.Modal,{className:"msg",open:m,children:m})]})},S=function(e){e.history,e.location;var t,c,n=e.match,s=Object(j.useState)(null),i=Object(a.a)(s,2),r=i[0],l=i[1],o=Object(j.useState)(null),b=Object(a.a)(o,2),u=b[0],h=b[1];return Object(j.useEffect)((function(){fetch("/api/singleDispute?_id=".concat(n.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&l(e.dispute)})).catch((function(e){console.log(e),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get Dispute. Make sure you're online."})]})]}))}))}),[]),r?Object(x.jsxs)("div",{className:"singleDispute ".concat(r.status),children:[Object(x.jsxs)("div",{className:"disputeSummery",children:[Object(x.jsx)("div",{className:"benner",children:"Dispute Summery"}),Object(x.jsxs)("ul",{className:"disputeDetail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Dispute ID:"}),Object(x.jsx)("div",{className:"data",children:r._id})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status:"}),Object(x.jsx)("div",{className:"data",children:r.status})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Issue:"}),Object(x.jsx)("div",{className:"data",children:r.issue})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Issued by:"}),Object(x.jsx)("div",{className:"data",children:r.plaintiff.role})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Dispute filed:"}),Object(x.jsx)("div",{className:"data",children:Object(x.jsx)(d.s,{format:"hh:mm a, DD MMM, YYYY",children:r.createdAt})})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone amount:"}),Object(x.jsxs)("div",{className:"data",children:["\u20b9 ",r.milestone.amount]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone description:"}),Object(x.jsx)("div",{className:"data",children:r.milestone.dscr})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone products:"}),Object(x.jsxs)("div",{className:"data",children:[null===(t=r.milestone.products)||void 0===t?void 0:t.map((function(e,t){return Object(x.jsx)("li",{children:e.name},t)})),(null===(c=r.milestone.products)||void 0===c?void 0:c.length)?null:"No product selected"]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone created:"}),Object(x.jsx)("div",{className:"data",children:Object(x.jsx)(d.s,{format:"hh:mm a, DD MMM, YYYY",children:r.milestone.createdAt})})]})]})]}),Object(x.jsx)(k,{role:"plaintiff",dispute:r,setData:l}),Object(x.jsx)(k,{role:"defendant",dispute:r,setData:l}),Object(x.jsx)(O.Modal,{open:u,className:"msg",children:u})]}):Object(x.jsxs)("div",{className:"singleDispute loading",children:[Object(x.jsxs)("div",{className:"disputeSummery",children:[Object(x.jsx)("div",{className:"benner",children:"Dispute Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]}),Object(x.jsxs)("div",{className:"plaintiff",children:[Object(x.jsx)("div",{className:"benner",children:"Plaintiff"}),Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)("div",{className:"img"}),Object(x.jsx)("div",{className:"name"})]}),Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]}),Object(x.jsxs)("div",{className:"defendant",children:[Object(x.jsx)("div",{className:"benner",children:"Defendant"}),Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)("div",{className:"img"}),Object(x.jsx)("div",{className:"name"})]}),Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]})]})},k=function(e){var t,c,n,s,i,r,o,b=e.role,u=e.dispute,h=e.setData,f=Object(j.useState)(null),m=Object(a.a)(f,2),p=m[0],v=m[1];return Object(x.jsxs)("div",{className:"".concat(b," ").concat(u[b].role," ").concat(u.winner===u[b]._id?"winner":""),children:[Object(x.jsxs)("div",{className:"benner",children:[b,"pendingVerdict"===u.status&&(null===(t=u.defendant.case)||void 0===t?void 0:t.dscr)&&Object(x.jsx)("button",{onClick:function(){return Object(O.Confirm)({className:"disputeResolveConfirm",label:"Dispute resolve",question:Object(x.jsxs)(x.Fragment,{children:["Are you sure"," ",Object(x.jsx)("span",{className:"name",children:u[b].firstName+" "+u[b].lastName})," ",Object(x.jsxs)("span",{className:"role",children:["(",b,")"]})," is the winner of this dispute?"]}),callback:function(){return e=u[b]._id,void fetch("/api/resolveDispute",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:u._id,winner:e})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Dispute Successfully resolved."})]})]})),h((function(t){return Object(l.a)(Object(l.a)({},t),{},{winner:e.dispute.winner,status:e.dispute.status})}))):v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:e.message})]})]}))})).catch((function(e){console.log(e),v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Dispute Could not be resolved. Make sure you' a're online."})]})]}))}));var e}})},children:"Winner"}),u.winner===u[b]._id&&Object(x.jsx)("p",{className:"winnerTag",children:"Winner"})]}),Object(x.jsxs)("div",{className:"content",children:[Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)(d.n,{src:u[b].profileImg||"/profile-user.jpg"}),Object(x.jsxs)("p",{className:"name",children:[u[b].firstName+" "+u[b].lastName,Object(x.jsx)("span",{className:"phone",children:u[b].phone})]})]}),(null===(c=u[b].case)||void 0===c?void 0:c.dscr)?Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Role:"})," ",Object(x.jsx)("div",{children:u[b].role})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Current Balance:"})," ",Object(x.jsxs)("div",{children:["\u20b9 ",null===(n=u[b].balance)||void 0===n?void 0:n.fix()]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Case:"})," ",Object(x.jsx)("div",{children:(null===(s=u[b].case)||void 0===s?void 0:s.dscr)||"N/A"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Evidence:"})," ",Object(x.jsx)("div",{className:"thumbs",children:(null===(i=u[b].case)||void 0===i||null===(r=i.files)||void 0===r?void 0:r.length)?Object(x.jsx)(d.q,{links:null===(o=u[b].case)||void 0===o?void 0:o.files}):"N/A"})]})]}):Object(x.jsx)("p",{className:"noRes",children:"Has not responded yet."})]}),Object(x.jsx)(O.Modal,{open:p,className:"msg",children:p})]})};t.default=function(){var e=Object(o.g)(),t=Object(j.useContext)(u.d).userType,c=Object(j.useState)(null),n=Object(a.a)(c,2),s=n[0],i=(n[1],Object(j.useState)([])),r=Object(a.a)(i,2),l=(r[0],r[1]);return Object(j.useEffect)((function(){fetch("/api/categories").then((function(e){return e.json()})).then((function(e){l(e.categories)}))}),[]),Object(x.jsxs)(x.Fragment,{children:["seller"===t&&Object(x.jsx)(o.a,{to:"/account/myShop/orders"}),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{style:{display:"none"},children:Object(x.jsx)(d.H,{})}),Object(x.jsxs)(o.d,{children:[Object(x.jsx)(o.b,{path:"/account/orders/current/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/current",children:Object(x.jsx)(m,{status:"approved|shipped|refundPending",onClick:function(t){return e.push("/account/orders/current/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/pending/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/pending",children:Object(x.jsx)(m,{status:"pending",onClick:function(t){return e.push("/account/orders/pending/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/history/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/history",children:Object(x.jsx)(m,{status:"delivered|cancelled|declined|refunded",onClick:function(t){return e.push("/account/orders/history/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/dispute/:_id",component:S}),Object(x.jsx)(o.b,{path:"/account/orders/dispute",component:N})]}),Object(x.jsx)(O.Modal,{className:"msg",open:s,children:s})]})]})}},174:function(e,t,c){"use strict";var n=c(11),s=c(24),i=c(1),r=i.useLayoutEffect,l=function(e){var t=Object(i.useRef)(e);return r((function(){t.current=e})),t},a=function(e,t){"function"!==typeof e?e.current=t:e(t)},j=function(e,t){var c=Object(i.useRef)();return Object(i.useCallback)((function(n){e.current=n,c.current&&a(c.current,null),c.current=t,t&&a(t,n)}),[t])},d={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},o=function(e){Object.keys(d).forEach((function(t){e.style.setProperty(t,d[t],"important")}))},b=null;var u=function(){},O=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],h=!!document.documentElement.currentStyle,x=function(e,t){var c=e.cacheMeasurements,r=e.maxRows,a=e.minRows,d=e.onChange,x=void 0===d?u:d,f=e.onHeightChange,m=void 0===f?u:f,p=Object(s.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var v=void 0!==p.value,g=Object(i.useRef)(null),y=j(g,t),N=Object(i.useRef)(0),C=Object(i.useRef)(),S=function(){var e=g.current,t=c&&C.current?C.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var c,n=(c=t,O.reduce((function(e,t){return e[t]=c[t],e}),{})),s=n.boxSizing;return""===s?null:(h&&"border-box"===s&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px"),{sizingStyle:n,paddingSize:parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),borderSize:parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth)})}(e);if(t){C.current=t;var n=function(e,t,c,n){void 0===c&&(c=1),void 0===n&&(n=1/0),b||((b=document.createElement("textarea")).setAttribute("tabindex","-1"),b.setAttribute("aria-hidden","true"),o(b)),null===b.parentNode&&document.body.appendChild(b);var s=e.paddingSize,i=e.borderSize,r=e.sizingStyle,l=r.boxSizing;Object.keys(r).forEach((function(e){var t=e;b.style[t]=r[t]})),o(b),b.value=t;var a=function(e,t){var c=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?c+t.borderSize:c-t.paddingSize}(b,e);b.value="x";var j=b.scrollHeight-s,d=j*c;"border-box"===l&&(d=d+s+i),a=Math.max(d,a);var u=j*n;return"border-box"===l&&(u=u+s+i),[a=Math.min(u,a),j]}(t,e.value||e.placeholder||"x",a,r),s=n[0],i=n[1];N.current!==s&&(N.current=s,e.style.setProperty("height",s+"px","important"),m(s,{rowHeight:i}))}};return Object(i.useLayoutEffect)(S),function(e){var t=l(e);Object(i.useLayoutEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[])}(S),Object(i.createElement)("textarea",Object(n.a)({},p,{onChange:function(e){v||S(),x(e)},ref:y}))},f=Object(i.forwardRef)(x);t.a=f}}]);
//# sourceMappingURL=27.0c06a101.chunk.js.map