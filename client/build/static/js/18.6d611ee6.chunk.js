(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[18],{158:function(e,t,n){"use strict";n.r(t),n.d(t,"MilestoneForm",(function(){return x})),n.d(t,"MilestoneReleaseForm",(function(){return m})),n.d(t,"AddressForm",(function(){return p})),n.d(t,"DisputeForm",(function(){return f})),n.d(t,"TicketForm",(function(){return v})),n.d(t,"TicketReplyForm",(function(){return g}));var c=n(23),s=n.n(c),l=n(28),i=n(10),a=n(3),r=n(1),o=n(12),j=n(9),u=n(2),d=n(17),b=n(174),O=n(175),h=(n(176),n(0)),x=function(e){var t,n,c,s,l=e.action,b=e.client,x=e.onSuccess,m=e.definedAmount,p=e.order,f=e.refund,v=e.strict,g=Object(r.useContext)(o.d),y=g.user,N=(g.setUser,g.config),C=Object(r.useState)(!1),k=Object(a.a)(C,2),S=k[0],F=k[1],M=Object(r.useState)(""),D=Object(a.a)(M,2),R=(D[0],D[1],Object(r.useState)(!1)),q=Object(a.a)(R,2),_=(q[0],q[1],Object(r.useState)(Object(i.a)({},y))),P=Object(a.a)(_,2),T=P[0],w=(P[1],Object(r.useState)(Object(i.a)({},b))),A=Object(a.a)(w,2),I=A[0],Y=(A[1],Object(r.useState)("")),B=Object(a.a)(Y,2),J=B[0],H=B[1],z=Object(r.useState)(m||""),L=Object(a.a)(z,2),E=L[0],U=L[1],V=Object(r.useState)(0),G=Object(a.a)(V,2),Z=G[0],K=G[1],Q=Object(r.useState)(null),W=Object(a.a)(Q,2),X=W[0],$=W[1],ee=Object(r.useRef)(),te=Object(r.useCallback)((function(){fetch("/api/requestMilestone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({buyer_id:b._id,amount:E,dscr:J,order:p,refund:f})}).then((function(e){return e.json()})).then((function(e){F(!1),"ok"===e.code?null===x||void 0===x||x(e.milestone):$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not request milestone. Try again."})]})]}))})).catch((function(e){F(!1),console.log(e),$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not request milestone. Make sure you're online."})]})]}))}))}),[I,T,E,J]),ne=Object(r.useCallback)((function(){fetch("/api/createMilestone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seller:Object(i.a)({},I),amount:E,dscr:J,order:p,refund:f})}).then((function(e){return e.json()})).then((function(e){F(!1),"ok"===e.code?null===x||void 0===x||x(Object(i.a)({},e)):403===e.code?$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Insufficient fund"}),Object(h.jsx)(u.b,{to:"/account/profile/wallet",children:"Add Money to your wallet now."})]})]})):$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not create milestone. Try again"})]})]}))})).catch((function(e){F(!1),console.log(e),$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not create milestone. Make sure you're online."})]})]}))}))}),[I,T,E,J]);return Object(r.useEffect)((function(){K((function(){return(+E/100*N.fee).fix()}))}),[E]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"milestonesForm",onSubmit:function(e){F(!0),e.preventDefault(),Object(O.b)(Object(h.jsxs)("div",{className:"toast",children:["Milestone is being"," ","create"===l?"created.":"requested."," ",Object(h.jsx)("button",{className:"undo",onClick:function(){ee.current=null},children:"Undo"})]}),{position:"bottom-center",autoClose:8e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,onClose:function(){var e;null===(e=ee.current)||void 0===e||e.call(ee),F(!1)},draggable:!0,progress:void 0}),ee.current="create"===l?ne:te},children:[Object(h.jsxs)("section",{className:"transactionDetail",children:[Object(h.jsxs)("section",{className:"amount",children:[Object(h.jsx)("label",{children:"Amount"}),Object(h.jsx)(j.t,{readOnly:v,min:10,defaultValue:m||0,required:!0,onChange:function(e){return U((+e.target.value).toString())}})]}),E&&Object(h.jsxs)(h.Fragment,{children:["create"===l&&Object(h.jsxs)("label",{className:"receivable",children:[b.firstName," ",b.lastName," will recieve \u20b9",(E-Z).fix()]}),"request"===l&&Object(h.jsxs)("label",{className:"receivable",children:["You will recieve \u20b9",(E-Z).fix()]})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Detail"}),Object(h.jsx)("input",{value:J,required:!0,onChange:function(e){return H(e.target.value)}})]}),Object(h.jsx)("button",{type:"submit",children:"create"===l?"Create Milestone":"Request Milestone"})]}),Object(h.jsxs)("section",{className:"clientDetail",children:["request"===l&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.n,{src:(null===b||void 0===b?void 0:b.profileImg)||"/profile-user.jpg"}),Object(h.jsx)("label",{children:"Buyer Information"}),Object(h.jsxs)("div",{className:"detail",children:[Object(h.jsxs)("section",{className:"profileDetail",children:[Object(h.jsx)("p",{className:"name",children:(null===b||void 0===b?void 0:b.firstName)+" "+(null===b||void 0===b?void 0:b.lastName)}),Object(h.jsx)("p",{className:"phone",children:null===b||void 0===b?void 0:b.phone}),Object(h.jsx)("p",{className:"email",children:null===b||void 0===b?void 0:b.email})]}),(null===b||void 0===b||null===(t=b.address)||void 0===t?void 0:t.street)&&Object(h.jsx)("section",{className:"address",children:Object(h.jsxs)("p",{className:"street",children:[null===(n=b.address)||void 0===n?void 0:n.street,", ",null===(c=b.address)||void 0===c?void 0:c.city,","," ",null===(s=b.address)||void 0===s?void 0:s.zip]})})]})]}),"request"===l?null:Object(h.jsxs)("div",{className:"sellerInfo",children:[Object(h.jsx)(j.n,{src:(null===I||void 0===I?void 0:I.profileImg)||"/profile-user.jpg"}),Object(h.jsx)("label",{children:"Seller Information"}),Object(h.jsx)("div",{className:"detail",children:Object(h.jsxs)("section",{className:"profileDetail",children:[Object(h.jsxs)("p",{className:"name",children:[null===I||void 0===I?void 0:I.firstName," ",null===I||void 0===I?void 0:I.lastName]}),Object(h.jsx)("p",{className:"phone",children:null===I||void 0===I?void 0:I.phone}),Object(h.jsx)("p",{className:"email",children:null===I||void 0===I?void 0:I.email})]})})]})]})]}),S&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(d.Modal,{className:"msg",open:X,children:X})]})},m=function(e){var t=e.milestone,n=e.setReleaseForm,c=e.onSuccess,s=Object(r.useState)(t.amount),l=Object(a.a)(s,2),i=l[0],o=(l[1],Object(r.useState)(null)),u=Object(a.a)(o,2),b=u[0],O=u[1];return Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/releaseMilestone",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id,amount:i})}).then((function(e){return e.json()})).then((function(e){var t=e.code,n=e.milestone;n?null===c||void 0===c||c(n):O(403===t?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return O(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not release Milestone due to low balance."})]})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return O(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not release Milestone."})]})]}))})).catch((function(e){console.log(e),h.Fragment,j.i}))},children:["You sure want to release this Milestone?",Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{type:"submit",children:"Confirm"}),Object(h.jsx)("button",{className:"cancel",type:"button",onClick:function(){return n(!1)},children:"Cancel"})]}),Object(h.jsx)(d.Modal,{open:b,className:"msg",children:b})]})},p=function(e){var t,n,c,s,l,i,o,j=e.client,u=e.onSuccess,d=e.onCancel,b=Object(r.useState)(j?j.name||j.firstName+" "+j.lastName:""),O=Object(a.a)(b,2),x=O[0],m=O[1],p=Object(r.useState)((null===j||void 0===j?void 0:j.phone)||""),f=Object(a.a)(p,2),v=f[0],g=f[1],y=Object(r.useState)((null===j||void 0===j||null===(t=j.address)||void 0===t?void 0:t.zip)||""),N=Object(a.a)(y,2),C=N[0],k=N[1],S=Object(r.useState)((null===j||void 0===j||null===(n=j.address)||void 0===n?void 0:n.locality)||""),F=Object(a.a)(S,2),M=F[0],D=F[1],R=Object(r.useState)((null===j||void 0===j||null===(c=j.address)||void 0===c?void 0:c.street)||""),q=Object(a.a)(R,2),_=q[0],P=q[1],T=Object(r.useState)((null===j||void 0===j||null===(s=j.address)||void 0===s?void 0:s.city)||""),w=Object(a.a)(T,2),A=w[0],I=w[1],Y=Object(r.useState)((null===j||void 0===j||null===(l=j.address)||void 0===l?void 0:l.state)||""),B=Object(a.a)(Y,2),J=B[0],H=B[1],z=Object(r.useState)((null===j||void 0===j||null===(i=j.address)||void 0===i?void 0:i.landmark)||""),L=Object(a.a)(z,2),E=L[0],U=L[1],V=Object(r.useState)((null===j||void 0===j||null===(o=j.address)||void 0===o?void 0:o.altPhone)||""),G=Object(a.a)(V,2),Z=G[0],K=G[1];return Object(h.jsxs)("form",{className:"addressForm",onSubmit:function(e){e.preventDefault(),null===u||void 0===u||u({address:{name:x,phone:v,street:_,city:A,state:J,zip:C,locality:M,landmark:E,altPhone:Z}})},children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"name",children:"Full Name"}),Object(h.jsx)("input",{value:x,onChange:function(e){return m(e.target.value)},type:"text",name:"name",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"phone",children:"Phone Number"}),Object(h.jsx)("input",{value:v,onChange:function(e){return g(e.target.value)},type:"tel",name:"phone",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"zip",children:"PIN Code"}),Object(h.jsx)("input",{value:C,onChange:function(e){return k(e.target.value)},type:"number",name:"zip",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"locality",children:"Locality"}),Object(h.jsx)("input",{value:M,onChange:function(e){return D(e.target.value)},type:"text",name:"locality",required:!0})]}),Object(h.jsxs)("section",{className:"street",children:[Object(h.jsx)("label",{htmlFor:"address",children:"Address"}),Object(h.jsx)("textarea",{value:_,onChange:function(e){return P(e.target.value)},resiz:"off",type:"text",name:"address",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"city",children:"City"}),Object(h.jsx)("input",{value:A,onChange:function(e){return I(e.target.value)},type:"text",name:"city",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"state",children:"State"}),Object(h.jsx)("input",{value:J,onChange:function(e){return H(e.target.value)},type:"text",name:"state",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"landmark",children:"Landmark (Optional)"}),Object(h.jsx)("input",{value:E,onChange:function(e){return U(e.target.value)},type:"text",name:"landmark"})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"altPhone",children:"Alternate Phone (Optional)"}),Object(h.jsx)("input",{value:Z,onChange:function(e){return K(e.target.value)},type:"tel",name:"altPhone"})]}),Object(h.jsx)("button",{className:"save",children:"Save"}),Object(h.jsx)("button",{className:"cancel",type:"button",onClick:function(){return null===d||void 0===d?void 0:d()},children:"Cancel"}),Object(h.jsx)("section",{className:"pBtm"})]})},f=function(e){var t=e.milestone,n=(e.setDisputeForm,e.onSuccess),c=Object(r.useState)(""),i=Object(a.a)(c,2),o=i[0],u=i[1],O=Object(r.useState)(!1),x=Object(a.a)(O,2),m=x[0],p=x[1],f=Object(r.useState)(""),v=Object(a.a)(f,2),g=v[0],y=v[1],N=Object(r.useState)([]),C=Object(a.a)(N,2),k=C[0],S=C[1],F=Object(r.useState)(null),M=Object(a.a)(F,2),D=M[0],R=M[1],q=function(){var e=Object(l.a)(s.a.mark((function e(c){var l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),p(!0),!k.length){e.next=8;break}return e.next=5,Object(j.F)({files:k,setMsg:R});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:l=e.t0,fetch("/api/fileDispute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issue:o,milestoneId:t._id,defendantId:t.client._id,_case:{dscr:g,files:l}})}).then((function(e){return e.json()})).then((function(e){p(!1),"ok"===e.code?null===n||void 0===n||n(e.milestone):403===e.code?R(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return R(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Insufficient fund! you have to have \u20b9500 in your wallet to file a dispute."})]})]})):R(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return R(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not file dispute."})]})]}))})).catch((function(e){p(!0),console.log(e),R(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return R(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not file dispute. make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"disputeForm",onSubmit:q,children:[Object(h.jsx)("h4",{children:"You feel like you are getting scammed?"}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"issue",children:"Issue"}),Object(h.jsx)(j.h,{name:"issue",options:"buyer"===t.role?[{label:"Buyer Not Releasing Payments",value:"Buyer Not Releasing Payments"}]:[{label:"Goods Not Received",value:"Goods Not Received"},{label:"Services Not Received",value:"Services Not Received"},{label:"Damaged",value:"Damaged"},{label:"Not As Agreed",value:"Not As Agreed"},{label:"Not As Displayed",value:"Not As Displayed"}],onChange:function(e){u(e.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"description",children:"Description"}),Object(h.jsx)(b.a,{name:"description",value:g,required:!0,onChange:function(e){return y(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload images to prove your case. ie: Product of image, proof of delivery."}),Object(h.jsx)(j.k,{multiple:!0,accept:"audio/*,video/*,image/*",onChange:function(e){return S(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),m&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(d.Modal,{open:D,className:"msg",children:D})]})},v=function(e){var t=e.onSuccess,n=Object(r.useState)(!1),c=Object(a.a)(n,2),i=c[0],o=c[1],u=Object(r.useState)(!1),O=Object(a.a)(u,2),x=O[0],m=O[1],p=Object(r.useState)(""),f=Object(a.a)(p,2),v=f[0],g=f[1],y=Object(r.useState)(""),N=Object(a.a)(y,2),C=N[0],k=N[1],S=Object(r.useState)(""),F=Object(a.a)(S,2),M=F[0],D=F[1],R=Object(r.useState)(""),q=Object(a.a)(R,2),_=q[0],P=q[1],T=Object(r.useState)(""),w=Object(a.a)(T,2),A=w[0],I=w[1],Y=function(){var e=Object(l.a)(s.a.mark((function e(n){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o(!0),!_.length){e.next=8;break}return e.next=5,Object(j.F)({files:_,setMsg:m});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:c=e.t0,fetch("/api/openTicket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issue:v,milestone:C,transaction:M,message:{body:A,files:c}})}).then((function(e){return e.json()})).then((function(e){o(!1),"ok"===e.code?null===t||void 0===t||t(e.ticket):"milestone ID is invalid"===e.message?m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Milestone Id is invalid."})]})]})):m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Ticket could not be submitted."})]})]}))})).catch((function(e){o(!1),console.log(e),m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Ticket could not be submitted. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"ticketForm",onSubmit:Y,children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Issue"}),Object(h.jsx)("input",{value:v,required:!0,onChange:function(e){return g(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Milestone ID (optional)"}),Object(h.jsx)("input",{value:C,onChange:function(e){return k(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Transaction ID (optional)"}),Object(h.jsx)("input",{value:M,onChange:function(e){return D(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Detail"}),Object(h.jsx)(b.a,{required:!0,value:A,onChange:function(e){return I(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload relevant files (optional)"}),Object(h.jsx)(j.k,{onChange:function(e){return P(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),i&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(d.Modal,{open:x,className:"msg",children:x})]})},g=function(e){var t=e._id,n=e.onSuccess,c=Object(r.useState)(!1),i=Object(a.a)(c,2),o=i[0],u=i[1],O=Object(r.useState)(!1),x=Object(a.a)(O,2),m=x[0],p=x[1],f=Object(r.useState)([]),v=Object(a.a)(f,2),g=v[0],y=v[1],N=Object(r.useState)(""),C=Object(a.a)(N,2),k=C[0],S=C[1],F=function(){var e=Object(l.a)(s.a.mark((function e(c){var l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),u(!0),!g.length){e.next=8;break}return e.next=5,Object(j.F)({files:g,setMsg:p});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:l=e.t0,fetch("/api/addTicketReply",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t,message:{body:k,files:l}})}).then((function(e){return e.json()})).then((function(e){u(!1),"ok"===e.code?null===n||void 0===n||n(e.ticket):p(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return p(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Reply could not be submitted."})]})]}))})).catch((function(e){u(!1),console.log(e),p(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return p(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Reply could not be submitted. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"ticketReplyForm",onSubmit:F,children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Message"}),Object(h.jsx)(b.a,{required:!0,value:k,onChange:function(e){return S(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload relevant files (optional)"}),Object(h.jsx)(j.k,{accept:"audio/*,video/*,image/*",multiple:!0,onChange:function(e){return y(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),o&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(d.Modal,{open:m,className:"msg",children:m})]})}},168:function(e,t,n){"use strict";n.r(t);var c=n(10),s=n(3),l=n(1),i=n(12),a=n(4),r=n(17),o=n(9),j=n(158),u=n(214),d=n.n(u),b=n(0);n(249);var O=function(e){var t,n=e.milestone;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"clientDetail",children:[Object(b.jsxs)("div",{className:"profile",children:[Object(b.jsx)(o.n,{src:n.client.profileImg||"/profile-user.jpg"}),Object(b.jsx)("p",{className:"name",children:n.client.firstName+" "+n.client.lastName})]}),Object(b.jsx)("div",{className:"milestoneDetail",children:Object(b.jsxs)("ul",{children:[Object(b.jsxs)("li",{children:[Object(b.jsx)("p",{children:"Date"}),"-",Object(b.jsx)("p",{children:Object(b.jsx)(o.s,{format:"DD MMM, YYYY. hh:mm a",children:n.createdAt})})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("p",{children:"Role"}),"-",Object(b.jsx)("p",{className:"role",children:n.role})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("p",{children:"Desciption"}),"-",Object(b.jsx)("p",{children:n.dscr})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("p",{children:"Milestone ID"}),"-",Object(b.jsx)("p",{children:n._id})]}),Object(b.jsxs)("li",{className:"status",children:[Object(b.jsx)("p",{children:"Status"}),"-",Object(b.jsx)("p",{children:n.status})]})]})})]}),Object(b.jsxs)("ul",{className:"steps ".concat(n.status," ").concat(null===(t=n.dispute)||void 0===t?void 0:t.status),children:[Object(b.jsxs)("li",{className:"step pending",children:[Object(b.jsxs)("div",{className:"icons",children:[Object(b.jsx)(o.B,{className:"default"}),Object(b.jsx)(o.z,{className:"blank"}),Object(b.jsx)(o.A,{className:"filled"})]}),Object(b.jsx)("p",{children:"Deposite recieved"})]}),Object(b.jsxs)("li",{className:"progress pending",children:[Object(b.jsx)(o.w,{}),Object(b.jsx)(o.x,{}),Object(b.jsx)(o.y,{})]}),Object(b.jsxs)("li",{className:"step onhold",children:[Object(b.jsxs)("div",{className:"icons",children:[Object(b.jsx)(o.B,{className:"default"}),Object(b.jsx)(o.z,{className:"blank"}),Object(b.jsx)(o.A,{className:"filled"})]}),Object(b.jsx)("p",{children:"Funds on Hold"})]}),Object(b.jsxs)("li",{className:"progress onhold",children:[Object(b.jsx)(o.w,{}),Object(b.jsx)(o.x,{}),Object(b.jsx)(o.y,{})]}),Object(b.jsxs)("li",{className:"step released",children:[Object(b.jsxs)("div",{className:"icons",children:[Object(b.jsx)(o.B,{className:"default"}),Object(b.jsx)(o.z,{className:"blank"}),Object(b.jsx)(o.A,{className:"filled"})]}),Object(b.jsx)("p",{children:"Released"})]})]})]})},h=function(e){var t,n,i,u,d,h,x=e.milestone,m=e.setMilestones,p=(Object(a.g)(),Object(l.useState)(!1)),f=Object(s.a)(p,2),v=f[0],g=f[1],y=Object(l.useState)(!1),N=Object(s.a)(y,2),C=N[0],k=N[1],S=Object(l.useState)(null),F=Object(s.a)(S,2),M=F[0],D=F[1],R=null,q=null;(null===(t=x.dispute)||void 0===t?void 0:t.plaintiff._id)===x.client._id?(R=null===(u=x.dispute)||void 0===u||null===(d=u.defendant)||void 0===d||null===(h=d.case)||void 0===h?void 0:h.dscr,q="client"):(null===(n=x.dispute)||void 0===n?void 0:n.defendant._id)===x.client._id&&(q="self");var _=function(){fetch("/api/approveMilestone",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({milestone_id:x._id,amount:x.amount})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?m((function(t){return t.map((function(t){return t._id===e.milestone._id?Object(c.a)(Object(c.a)({},e.milestone),{},{client:x.client,role:x.role}):t}))})):403===e.code?D(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not approve milestone due to low balance."})]})]})):D(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not approve milestone. Please try again."})]})]}))})).catch((function(e){console.log(e),D(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not approve milestone. Make sure you're online"})]})]}))}))};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("li",{className:"milestone seller",children:[Object(b.jsx)(O,{milestone:x}),Object(b.jsxs)("div",{className:"clas",children:[Object(b.jsxs)("h4",{children:["\u20b9",x.amount]}),Object(b.jsxs)("div",{className:"btns",children:["pending"===x.status&&Object(b.jsx)("a",{onClick:function(){return Object(r.Confirm)({label:"Milestone Approval",question:"You sure want to approve this milestone?",callback:_})},children:"Approve"}),"pendingRelease"===x.status&&Object(b.jsx)("a",{className:"released",children:"Release requested"}),("inProgress"===x.status||"pendingRelease"===x.status)&&Object(b.jsx)("a",{onClick:function(){return g(!0)},children:"Release"}),"released"===x.status&&Object(b.jsx)("a",{className:"dispute",onClick:function(){return k(!0)},children:"Raise Dispute"}),("client"===q&&R||"self"===q)&&Object(b.jsxs)("a",{className:"disputed",children:["Dispute ",null===(i=x.dispute)||void 0===i?void 0:i.status]}),"client"===q&&!R&&Object(b.jsx)("a",{className:"disputeRes",onClick:function(){return k(!0)},children:"Approve Dispute"}),"declined"===x.status&&Object(b.jsx)("a",{className:"disputed",children:"Declined"}),Object(b.jsx)(r.Modal,{open:M,className:"msg",children:M})]})]}),Object(b.jsx)(r.Modal,{open:v,head:!0,label:"Release Money",setOpen:g,className:"milestoneReleaseForm",children:Object(b.jsx)(j.MilestoneReleaseForm,{milestone:x,setReleaseForm:g,onSuccess:function(e){m((function(t){return t.map((function(t){return t._id===e._id?Object(c.a)(Object(c.a)({},e),{},{client:t.client,role:t.role}):t}))})),g(!1),D(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsxs)("h4",{className:"amount",children:["\u20b9",e.amount]}),Object(b.jsx)("h4",{children:"Milestone has been released."})]})]}))}})}),Object(b.jsx)(r.Modal,{open:C,head:!0,label:"Raise Dispute",setOpen:k,className:"disputeForm",children:Object(b.jsx)(j.DisputeForm,{milestone:x,setDisputeForm:k,onSuccess:function(e){m((function(t){return t.map((function(t){return t._id===e._id?Object(c.a)(Object(c.a)({},e),{},{client:t.client,role:t.role}):t}))})),k(!1),D(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsx)("h4",{children:"client"===q?"Case submit success. Dispute pending for verdict.":"Dispute filed succefully."})]})]}))}})})]},x._id),Object(b.jsx)(r.Modal,{className:"msg",open:M,children:M})]})},x=function(e){var t,n,i,a,u,d,h=e.milestone,x=e.setMilestones,m=Object(l.useState)(!1),p=Object(s.a)(m,2),f=p[0],v=p[1],g=Object(l.useState)(null),y=Object(s.a)(g,2),N=y[0],C=y[1],k=null,S=null;(null===(t=h.dispute)||void 0===t?void 0:t.plaintiff._id)===h.client._id?(k=null===(a=h.dispute)||void 0===a||null===(u=a.defendant)||void 0===u||null===(d=u.case)||void 0===d?void 0:d.dscr,S="client"):(null===(n=h.dispute)||void 0===n?void 0:n.defendant._id)===h.client._id&&(S="self");var F=function(){fetch("/api/declineMilestone",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:h._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(x((function(t){return t.map((function(t){return t._id===e.milestone._id?Object(c.a)(Object(c.a)({},e.milestone),{},{client:h.client,role:h.role}):t}))})),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsx)("h4",{children:"Milestone succefully declined."})]})]}))):C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Milestone succefully declined."})]})]}))})).catch((function(e){console.log(e),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not decline milestone. Make sure you're online"})]})]}))}))},M=function(){fetch("/api/cancelMilestoneRequest",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:h._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(x((function(e){return e.filter((function(e){return e._id!==h._id}))})),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsx)("h4",{children:"Milestone request cancelled."})]})]}))):C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not cancel milestone request. Try again."})]})]}))})).catch((function(e){console.log(e),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not cancel milestone request. Make sure you're online."})]})]}))}))},D=function(){fetch("/api/requestRelease",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:h._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(x((function(t){return t.map((function(t){return t._id===e.milestone._id?Object(c.a)(Object(c.a)({},e.milestone),{},{client:h.client,role:h.role}):t}))})),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsx)("h4",{children:"Milestone request cancelled."})]})]}))):C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not request release. Try again."})]})]}))})).catch((function(e){console.log(e),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not request release. Make sure you're online."})]})]}))}))};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("li",{className:"milestone buyer",children:[Object(b.jsx)(O,{milestone:h}),Object(b.jsxs)("div",{className:"clas",children:[Object(b.jsxs)("h4",{children:["\u20b9",h.amount]}),Object(b.jsxs)("div",{className:"btns",children:["pendingRelease"===h.status&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("a",{className:"released",children:"Release requested"}),Object(b.jsx)("a",{className:"dispute",onClick:function(){return v(!0)},children:"Raise Dispute"})]}),"pending"===h.status&&Object(b.jsx)("a",{className:"disputeRes",onClick:function(){return Object(r.Confirm)({label:"Cancel Milestone request",question:"You sure want to cancel this request?",callback:M})},children:"Cancel Request"}),"released"===h.status&&Object(b.jsx)("a",{className:"released",children:"Released"}),("client"===S&&k||"self"===S)&&Object(b.jsxs)("a",{className:"disputed",children:["Dispute ",null===(i=h.dispute)||void 0===i?void 0:i.status]}),"client"===S&&!k&&Object(b.jsx)("a",{className:"disputeRes",onClick:function(){return v(!0)},children:"Approve Dispute"}),"inProgress"===h.status&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("a",{onClick:function(){return Object(r.Confirm)({label:"Request Release",question:"You sure want to request release of this milestone?",callback:D})},children:"Request Release"}),Object(b.jsx)("a",{className:"disputeRes",onClick:function(){return Object(r.Confirm)({label:"Decline Milestone",question:"You sure want to decline this milestone?",callback:F})},children:"Decline"})]}),"declined"===h.status&&Object(b.jsx)("a",{className:"disputed",children:"Declined"})]})]}),Object(b.jsx)(r.Modal,{open:f,head:!0,label:"Raise Dispute",setOpen:v,className:"disputeForm",children:Object(b.jsx)(j.DisputeForm,{milestone:h,setDisputeForm:v,onSuccess:function(e){x((function(t){return t.map((function(t){return t._id===e._id?Object(c.a)(Object(c.a)({},e),{},{client:t.client,role:t.role}):t}))})),v(!1),C(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return C(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.C,{}),Object(b.jsx)("h4",{children:"client"===S?"Case submit success. Dispute pending for verdict.":"Dispute filed succefully."})]})]}))}})})]},h._id),Object(b.jsx)(r.Modal,{className:"msg",open:N,children:N})]})};t.default=function(e){var t,n=e.history,a=e.location,j=(e.match,Object(l.useContext)(i.d).userType),u=Object(l.useState)([]),O=Object(s.a)(u,2),m=O[0],p=O[1],f=Object(l.useState)(null),v=Object(s.a)(f,2),g=v[0],y=v[1],N=Object(l.useState)(d.a.parse(a.search).page||1),C=Object(s.a)(N,2),k=C[0],S=C[1],F=Object(l.useState)(d.a.parse(a.search).perPage||20),M=Object(s.a)(F,2),D=M[0],R=M[1],q=Object(l.useState)((null===(t=d.a.parse(a.search).q)||void 0===t?void 0:t.replace(/\/(?!.*\/).*/,""))||""),_=Object(s.a)(q,2),P=_[0],T=_[1],w=Object(l.useState)(d.a.parse(a.search).status||""),A=Object(s.a)(w,2),I=A[0],Y=A[1],B=Object(l.useState)(null),J=Object(s.a)(B,2),H=J[0],z=J[1],L=Object(l.useState)({column:d.a.parse(a.search).sort||"createdAt",order:d.a.parse(a.search).order||"dsc"}),E=Object(s.a)(L,2),U=E[0],V=(E[1],Object(l.useState)(null)),G=Object(s.a)(V,2),Z=G[0],K=G[1];return Object(l.useEffect)((function(){fetch("/api/milestone".concat(a.search)).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(p(e.milestones),y(e.total))})).catch((function(e){console.log(e),K(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return K(null)},children:"Okay"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(o.i,{}),Object(b.jsx)("h4",{children:"Could not update milestones."})]})]}))}))}),[a.search,j]),Object(l.useEffect)((function(){var e,t=Object(o.L)({time:null===H||void 0===H?void 0:H.startDate,format:"YYYY-MM-DD"}),s=Object(o.L)({time:null===(e=new Date(null===H||void 0===H?void 0:H.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});n.replace({pathname:a.pathname,search:"?"+new URLSearchParams(Object(c.a)(Object(c.a)(Object(c.a)({page:k,perPage:D,sort:U.column,order:U.order},P&&{q:P}),H&&{dateFrom:t,dateTo:s}),I&&{status:I})).toString()})}),[k,D,U.column,U.order,P,H,I,j]),Object(b.jsxs)("div",{className:"holdContainer",children:[Object(b.jsx)("div",{style:{display:"none"},children:Object(b.jsx)(o.H,{})}),Object(b.jsxs)("div",{className:"benner",children:[Object(b.jsx)("h4",{children:"Secure your transactions"}),Object(b.jsx)("p",{children:"All payments and transactions come here"})]}),Object(b.jsx)("div",{className:"head",children:Object(b.jsxs)("div",{className:"filters",children:[Object(b.jsxs)("section",{children:[Object(b.jsx)("label",{children:"Total:"}),g]}),Object(b.jsxs)("section",{children:[Object(b.jsx)("label",{children:"Per Page:"}),Object(b.jsx)(o.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return R(e.value)}})]}),Object(b.jsxs)("section",{className:"search",children:[Object(b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(b.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(b.jsx)("input",{value:P,onChange:function(e){return T(e.target.value)},placeholder:"Search Buyer's or Seller's name, phone, Milestone ID"}),P&&Object(b.jsx)("button",{onClick:function(){return T("")},children:Object(b.jsx)(o.H,{})})]}),Object(b.jsxs)("section",{className:"status",children:[Object(b.jsx)("label",{children:"Status:"}),Object(b.jsx)(o.h,{defaultValue:I||0,options:[{label:"All",value:""},{label:"In Progress",value:"inProgress"},{label:"Pending",value:"pending"},{label:"Release requested",value:"pendingRelease"},{label:"Released",value:"released"},{label:"Dispute",value:"dispute"}],onChange:function(e){return Y(e.value)}})]}),Object(b.jsx)("section",{className:"date",children:Object(b.jsx)(o.o,{dateRange:H,onChange:function(e){return z(e)}})})]})}),Object(b.jsxs)("ul",{className:"milestones",children:[m.map((function(e,t){return"seller"===e.role?Object(b.jsx)(h,{milestone:e,setMilestones:p},t):Object(b.jsx)(x,{milestone:e,setMilestones:p},t)})),0===m.length&&Object(b.jsx)("p",{className:"placeholder",children:"No transaction yet."})]}),Object(b.jsx)(o.u,{total:g,perPage:D,currentPage:k,btns:5,setPage:S}),Object(b.jsx)(r.Modal,{className:"msg",open:Z,children:Z})]})}},249:function(e,t,n){}}]);
//# sourceMappingURL=18.6d611ee6.chunk.js.map