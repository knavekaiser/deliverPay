(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[14],{167:function(e,t,n){"use strict";n.r(t),n.d(t,"updateProfileInfo",(function(){return O}));var c=n(14),s=n.n(c),a=n(4),r=n(52),i=n(3),l=n(16),d=n(1),o=n(8),j=n(168),u=n(7),b=n(2),h=n(0);function O(e){return f.apply(this,arguments)}function f(){return(f=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(a.a)({},t))}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(201);var m=function(e){var t=e.method,n=e.setMsg,c=Object(d.useContext)(o.d).setUser,s=Object(d.useState)(!1),r=Object(i.a)(s,2),l=r[0],O=r[1],f=Object(d.useCallback)((function(e){fetch("/api/deletePaymentMethod",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e._id})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?c((function(t){return Object(a.a)(Object(a.a)({},t),{},{paymentMethods:t.paymentMethods.filter((function(t){return t._id!==e._id}))})})):n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Payment method could not be deleted."})]})]}))}))}),[]);return Object(h.jsxs)("li",{children:[Object(h.jsxs)("div",{className:"actions",children:[Object(h.jsx)("button",{className:"edit",onClick:function(){return O(t.__t)},children:"Edit"}),Object(h.jsx)("button",{className:"delete",onClick:function(){return Object(u.Confirm)({label:"Payment method delete",question:"Do you want to delete this payment method?",callback:function(){return f(t)}})},children:"Delete"})]}),"BankCard"===t.__t&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.BankCard,{card:t}),l===t.__t&&Object(h.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:O,className:"editPaymentMethod",children:Object(h.jsx)(j.BankCardForm,{prefill:t,onSuccess:function(e){e&&(O(!1),n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.E,{}),Object(h.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]}),"BankAccount"===t.__t&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.BankAccount,{account:t}),l===t.__t&&Object(h.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:O,className:"editPaymentMethod",children:Object(h.jsx)(j.NetBankingForm,{prefill:t,onSuccess:function(e){e&&(O(!1),n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.E,{}),Object(h.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]})]})},x=function(e){var t=e.label,n=e.fields,c=e.value,a=e.onError,j=e.setMsg,u=e.formData,O=Object(d.useContext)(o.d).setUser,f=Object(d.useState)(!1),m=Object(i.a)(f,2),x=m[0],p=m[1],C=Object(d.useRef)(null),g=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c,l,d,o,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n={},c=Object(r.a)(new FormData(t.target).entries());try{for(c.s();!(l=c.n()).done;)d=Object(i.a)(l.value,2),o=d[0],h=d[1],n[o]=h}catch(s){c.e(s)}finally{c.f()}if(!n.password||n.password===n.confirm_password){e.next=7;break}return null===a||void 0===a||a(),e.abrupt("return");case 7:if(n["address.city"]&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,c=e.coords.longitude;n["address.location"]={type:"Point",coordinates:[c,t]}})),!n["kyc.files"]){e.next=15;break}return e.next=11,Object(b.H)({files:u,setMsg:j});case 11:if(e.t0=e.sent,e.t0){e.next=14;break}e.t0=[];case 14:n["kyc.files"]=e.t0;case 15:if(!n["gst.detail.files"]){e.next=22;break}return e.next=18,Object(b.H)({files:u,setMsg:j});case 18:if(e.t1=e.sent,e.t1){e.next=21;break}e.t1=[];case 21:n["gst.detail.files"]=e.t1;case 22:fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){var t=e.user;t?(O(t),p(!1)):alert("someting went wrong")})).catch((function(e){console.log(e),alert("someting went wrong")}));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("li",{children:[Object(h.jsx)("p",{className:"label",children:t}),Object(h.jsxs)("form",{ref:C,onSubmit:g,children:[x?Object(h.jsx)("div",{className:"inputs",children:n}):Object(h.jsx)("div",{className:"currentValue",children:c}),Object(h.jsx)("div",{className:"btns",children:x?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{type:"submit",children:"Save changes"},"submit"),Object(h.jsx)("button",{type:"button",onClick:function(){return p(!1)},children:"Cancel"},"cancel")]}):Object(h.jsx)("button",{type:"button",onClick:function(){return p(!0)},children:"Edit"},"edit")})]})]})};t.default=function(e){e.history,e.match,e.location;var t,n,c,s,l,j,f,p,C=Object(d.useContext)(o.d),g=C.user,v=C.setUser,y=Object(d.useState)(!1),k=Object(i.a)(y,2),N=k[0],w=k[1],P=Object(d.useState)(null),M=Object(i.a)(P,2),F=M[0],_=M[1],S=Object(d.useState)([]),q=Object(i.a)(S,2),E=q[0],V=q[1],I=Object(d.useState)([]),D=Object(i.a)(I,2);D[0],D[1];return Object(h.jsxs)("div",{className:"profileContainer",children:[Object(h.jsxs)("div",{className:"benner",children:[Object(h.jsxs)("div",{className:"profileImg",children:[Object(h.jsx)(b.n,{src:g.profileImg||"/profile-user.jpg"}),Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"91.832",height:"25.468",viewBox:"0 0 91.832 25.468",children:Object(h.jsxs)("g",{id:"Path_1937","data-name":"Path 1937",transform:"translate(15.429 -9.647)",fill:"#fff",children:[Object(h.jsx)("path",{d:"M 29.79687690734863 34.6146240234375 C 22.21588897705078 34.6146240234375 13.43720626831055 32.0111198425293 5.0779709815979 27.28368377685547 C -2.8753981590271 22.78578186035156 -9.78753662109375 16.7585563659668 -14.48426628112793 10.24203777313232 C -13.95890235900879 10.24473857879639 -13.30369663238525 10.25548648834229 -12.80753517150879 10.26361274719238 C -12.44524097442627 10.26955413818359 -12.15906429290771 10.27424812316895 -12.02891159057617 10.27424812316895 C -11.93940830230713 10.27424812316895 -11.86373233795166 10.26253128051758 -11.79978466033936 10.24241733551025 C -11.48864650726318 10.21196746826172 -10.04010391235352 10.17821311950684 -5.149840831756592 10.17821311950684 C -1.226676225662231 10.17821311950684 4.093100070953369 10.19837760925293 9.725229263305664 10.21973037719727 C 16.20444107055664 10.24428367614746 23.54814720153809 10.27211856842041 29.79687690734863 10.27211856842041 C 31.89767646789551 10.27211856842041 43.68988800048828 10.22107124328613 56.17448806762695 10.16702461242676 L 59.24650192260742 10.15374183654785 C 60.32665252685547 10.14907169342041 61.61424255371094 10.14680099487305 63.18285369873047 10.14680099487305 C 64.99295043945313 10.14680099487305 66.92156219482422 10.14978885650635 68.78666687011719 10.15269470214844 C 70.55825042724609 10.1554479598999 72.23158264160156 10.15804767608643 73.72422027587891 10.15804767608643 C 74.4501953125 10.15804767608643 75.08247375488281 10.1574182510376 75.63590240478516 10.15613842010498 C 74.24596405029297 13.15391826629639 71.95748138427734 16.1362361907959 68.82386779785156 19.03109550476074 C 65.67525482177734 21.9398250579834 61.6738166809082 24.71903610229492 57.25215911865234 27.06828308105469 C 52.91740798950195 29.37135314941406 48.15610122680664 31.27616500854492 43.48295974731445 32.57678985595703 C 38.69290161132813 33.90995407104492 33.96032333374023 34.6146240234375 29.79687690734863 34.6146240234375 Z",stroke:"none"}),Object(h.jsx)("path",{d:"M 63.18235397338867 10.64679336547852 C 61.61428070068359 10.64679336547852 60.32755279541016 10.64906692504883 59.24865341186523 10.65373229980469 L 56.18099212646484 10.6670036315918 C 43.69374084472656 10.72105407714844 31.89901733398438 10.77211761474609 29.79687881469727 10.77211761474609 C 23.54719161987305 10.77211761474609 16.2029914855957 10.74428176879883 9.723331451416016 10.71971893310547 C 4.091693878173828 10.69837951660156 -1.227619171142578 10.67821884155273 -5.149848937988281 10.67821884155273 C -9.844169616699219 10.67821884155273 -11.33226013183594 10.70873641967773 -11.7083740234375 10.73677062988281 C -11.80277252197266 10.76053237915039 -11.90915679931641 10.77424240112305 -12.0289306640625 10.77424240112305 C -12.16323089599609 10.77424240112305 -12.45131683349609 10.7695198059082 -12.81605529785156 10.76354217529297 C -13.01943206787109 10.76021194458008 -13.24966430664063 10.75643920898438 -13.48653411865234 10.75296401977539 C -8.851593017578125 16.903076171875 -2.239547729492188 22.57095718383789 5.324104309082031 26.84845542907715 C 13.60947799682617 31.53411865234375 22.30074310302734 34.11461639404297 29.79687881469727 34.11461639404297 C 33.91565704345703 34.11461639404297 38.60186767578125 33.41628265380859 43.34890747070313 32.0950927734375 C 47.98773193359375 30.80401802062988 52.71426773071289 28.91309356689453 57.0175666809082 26.62672996520996 C 61.40182876586914 24.29735565185547 65.3670654296875 21.5438175201416 68.48458099365234 18.6638298034668 C 71.32099151611328 16.04351997375488 73.45128631591797 13.35661125183105 74.83492279052734 10.65748596191406 C 74.4908447265625 10.65786743164063 74.12125396728516 10.65805435180664 73.72370147705078 10.65805435180664 C 72.23068237304688 10.65805435180664 70.55716705322266 10.65545654296875 68.78539276123047 10.65269470214844 C 66.92047119140625 10.6497917175293 64.9920654296875 10.64679336547852 63.18235397338867 10.64679336547852 M 63.18235778808594 9.646797180175781 C 66.69034576416016 9.646797180175781 70.639892578125 9.658050537109375 73.72370910644531 9.658050537109375 C 74.72272491455078 9.658050537109375 75.63052368164063 9.656867980957031 76.4033203125 9.653743743896484 C 70.7041015625 23.3221435546875 47.19384002685547 35.11461639404297 29.79687881469727 35.11461639404297 C 13.80905532836914 35.11461639404297 -5.7138671875 23.84020614624023 -15.427734375 9.772117614746094 C -15.45098876953125 9.749141693115234 -15.14891815185547 9.741405487060547 -14.71451568603516 9.741401672363281 C -13.8193359375 9.741401672363281 -12.36181640625 9.774246215820313 -12.02893829345703 9.774246215820313 C -11.98212432861328 9.774246215820313 -11.95759582519531 9.773597717285156 -11.9599609375 9.772117614746094 C -12.07225799560547 9.701694488525391 -9.402595520019531 9.678211212158203 -5.14984130859375 9.678211212158203 C 3.356430053710938 9.678211212158203 18.19854354858398 9.772117614746094 29.79687881469727 9.772117614746094 C 32.07231903076172 9.772117614746094 46.01445388793945 9.710941314697266 59.24433135986328 9.653743743896484 C 60.42824935913086 9.648624420166016 61.76977157592773 9.646797180175781 63.18235778808594 9.646797180175781 Z",stroke:"none",fill:"#336cf9"})]})}),Object(h.jsx)("input",{type:"file",accept:".jpg, .png, .jpeg",onChange:function(e){var t=e.target.files[0],n="https://cdn.deliverypay.in";if(t){var c,s=new FormData,i=Object(r.a)(e.target.files);try{for(i.s();!(c=i.n()).done;){var l=c.value;s.append("file",l)}}catch(d){i.e(d)}finally{i.f()}fetch("".concat(n,"/upload"),{method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?O({profileImg:n+"/"+e.files[0]}).then((function(e){e.user&&v((function(t){return Object(a.a)(Object(a.a)({},t),{},{profileImg:e.user.profileImg})}))})):_(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return _(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Image upload failed"})]})]}))})).catch((function(e){_(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return _(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Image upload failed. Make sure you're online."})]})]}))}))}}}),Object(h.jsx)("label",{children:"Edit"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{className:"name",children:g.firstName+" "+g.lastName}),Object(h.jsxs)("p",{className:"id",children:["Delivery pay ID: ",g.userId||g._id]})]})]}),Object(h.jsxs)("div",{className:"settings",children:[Object(h.jsx)("div",{className:"head",children:"Account Settings"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)(x,{label:"Name",fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"First name",defaultValue:g.firstName,name:"firstName",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"last name",defaultValue:g.lastName,name:"lastName",required:!0})})]}),value:g.firstName+" "+g.lastName}),Object(h.jsx)(x,{label:"Phone Number",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Phone Number",defaultValue:g.phone,name:"phone",required:!0,pattern:"^(\\+91|91|1|)\\d{10}$"})})}),value:g.phone}),Object(h.jsx)(x,{label:"Email",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"email",placeholder:"Phone Number",defaultValue:g.email,name:"email",required:!0})})}),value:g.email}),Object(h.jsx)(x,{label:"Password",onError:function(){return w(!0)},fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Password",name:"password",required:!0,type:"password",onChange:function(e){return w(!1)}})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Confirm password",name:"confirm_password",required:!0,type:"password",onChange:function(e){return w(!1)}})}),N&&Object(h.jsx)("p",{className:"errMsg",children:"Password did not match."})]}),value:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),Object(h.jsx)(x,{label:"Gender",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Gender",defaultValue:g.gender,name:"gender",required:!0})})}),value:g.gender}),Object(h.jsx)(x,{label:"Age",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"number",placeholder:"Age",defaultValue:g.age,name:"age",required:!0})})}),value:g.age}),Object(h.jsx)(x,{label:"Address",fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"Address",defaultValue:g.address.street,name:"address.street",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"City",defaultValue:g.address.city,name:"address.city",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"State",defaultValue:g.address.state,name:"address.state",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"number",placeholder:"PIN Code",defaultValue:g.address.zip,name:"address.zip",required:!0})})]}),value:"".concat((null===(t=g.address)||void 0===t?void 0:t.street)||""," ").concat((null===(n=g.address)||void 0===n?void 0:n.city)||""," ").concat((null===(c=g.address)||void 0===c?void 0:c.state)||""," ").concat((null===(s=g.address)||void 0===s?void 0:s.zip)||"")})]})]}),Object(h.jsxs)("div",{className:"kyc",children:[Object(h.jsx)("div",{className:"head",children:"KYC"}),Object(h.jsx)("ul",{children:Object(h.jsx)(x,{label:"KYC",setMsg:_,formData:E,fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Upload files for verification."}),Object(h.jsx)(b.k,{multiple:!0,prefill:null===(l=g.kyc)||void 0===l?void 0:l.files,name:"kyc.files",onChange:function(e){return V(e)}})]})}),value:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("p",{children:["Status: ",(null===(j=g.kyc)||void 0===j?void 0:j.verified)?"Verified":"Unverified"]}),Object(h.jsx)("label",{children:"Files for verification:"}),Object(h.jsx)("ul",{className:"thumbs",children:Object(h.jsx)(b.q,{links:null===(f=g.kyc)||void 0===f?void 0:f.files})})]})})})]}),Object(h.jsxs)("div",{className:"paymentMethods",children:[Object(h.jsx)("div",{className:"head",children:"Payment Methods"}),Object(h.jsxs)("ul",{className:"methods",children:[g.paymentMethods.map((function(e,t){return Object(h.jsx)(m,{setMsg:_,method:e},t)})),0===(null===(p=g.paymentMethods)||void 0===p?void 0:p.length)&&Object(h.jsx)("p",{children:"No payment method added."})]})]}),Object(h.jsx)(u.Modal,{className:"msg",open:F,children:F})]})}},201:function(e,t,n){}}]);
//# sourceMappingURL=14.60172116.chunk.js.map