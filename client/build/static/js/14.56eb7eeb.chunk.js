(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[14],{159:function(e,t,c){"use strict";c.r(t),c.d(t,"updateProfileInfo",(function(){return f}));var n=c(23),s=c.n(n),a=c(46),i=c(10),r=c(3),l=c(28),o=c(1),j=c(12),d=c(161),u=c(17),b=c(9),h=c(177),O=c.n(h),x=c(0);function f(e){return p.apply(this,arguments)}function p(){return(p=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c(197);var m=function(e){var t=e.method,c=e.setMsg,n=Object(o.useContext)(j.d).setUser,s=Object(o.useState)(!1),a=Object(r.a)(s,2),l=a[0],h=a[1],O=Object(o.useCallback)((function(e){fetch("/api/deletePaymentMethod",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e._id})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?n((function(t){return Object(i.a)(Object(i.a)({},t),{},{paymentMethods:t.paymentMethods.filter((function(t){return t._id!==e._id}))})})):c(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return c(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Payment method could not be deleted."})]})]}))}))}),[]);return Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"actions",children:[Object(x.jsx)("button",{className:"edit",onClick:function(){return h(t.__t)},children:"Edit"}),Object(x.jsx)("button",{className:"delete",onClick:function(){return Object(u.Confirm)({label:"Payment method delete",question:"Do you want to delete this payment method?",callback:function(){return O(t)}})},children:"Delete"})]}),"BankCard"===t.__t&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.BankCard,{card:t}),l===t.__t&&Object(x.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:h,className:"editPaymentMethod",children:Object(x.jsx)(d.BankCardForm,{prefill:t,onSuccess:function(e){e&&(h(!1),c(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return c(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.C,{}),Object(x.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]}),"BankAccount"===t.__t&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.BankAccount,{account:t}),l===t.__t&&Object(x.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:h,className:"editPaymentMethod",children:Object(x.jsx)(d.NetBankingForm,{prefill:t,onSuccess:function(e){e&&(h(!1),c(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return c(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.C,{}),Object(x.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]})]})},v=function(e){var t=e.label,c=e.fields,n=e.value,i=e.onError,d=e.setMsg,u=e.formData,h=Object(o.useContext)(j.d).setUser,O=Object(o.useState)(!1),f=Object(r.a)(O,2),p=f[0],m=f[1],v=Object(o.useRef)(null),g=function(){var e=Object(l.a)(s.a.mark((function e(t){var c,n,l,o,j,O;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),c={},n=Object(a.a)(new FormData(t.target).entries());try{for(n.s();!(l=n.n()).done;)o=Object(r.a)(l.value,2),j=o[0],O=o[1],c[j]=O}catch(s){n.e(s)}finally{n.f()}if(!c.password||c.password===c.confirm_password){e.next=7;break}return null===i||void 0===i||i(),e.abrupt("return");case 7:if(c["address.city"]&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,n=e.coords.longitude;c["address.location"]={type:"Point",coordinates:[n,t]}})),!c["kyc.files"]){e.next=15;break}return e.next=11,Object(b.F)({files:u,setMsg:d});case 11:if(e.t0=e.sent,e.t0){e.next=14;break}e.t0=[];case 14:c["kyc.files"]=e.t0;case 15:if(!c["gst.detail.files"]){e.next=22;break}return e.next=18,Object(b.F)({files:u,setMsg:d});case 18:if(e.t1=e.sent,e.t1){e.next=21;break}e.t1=[];case 21:c["gst.detail.files"]=e.t1;case 22:fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){var t=e.user;t?(h(t),m(!1)):alert("someting went wrong")})).catch((function(e){console.log(e),alert("someting went wrong")}));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("li",{children:[Object(x.jsx)("p",{className:"label",children:t}),Object(x.jsxs)("form",{ref:v,onSubmit:g,children:[p?Object(x.jsx)("div",{className:"inputs",children:c}):Object(x.jsx)("div",{className:"currentValue",children:n}),Object(x.jsx)("div",{className:"btns",children:p?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{type:"submit",children:"Save changes"},"submit"),Object(x.jsx)("button",{type:"button",onClick:function(){return m(!1)},children:"Cancel"},"cancel")]}):Object(x.jsx)("button",{type:"button",onClick:function(){return m(!0)},children:"Edit"},"edit")})]})]})};t.default=function(e){e.history,e.match,e.location;var t,c,n,s,l,d,h,p,g=Object(o.useContext)(j.d),k=g.user,y=g.setUser,C=Object(o.useState)(!1),N=Object(r.a)(C,2),M=N[0],S=N[1],F=Object(o.useState)(null),P=Object(r.a)(F,2),_=P[0],D=P[1],A=Object(o.useState)([]),w=Object(r.a)(A,2),T=w[0],I=w[1],Y=Object(o.useState)([]),q=Object(r.a)(Y,2),E=(q[0],q[1],function(e){e.googleId&&f({googleId:e.googleId}).then((function(t){y((function(t){return Object(i.a)(Object(i.a)({},t),{},{googleId:e.googleId})})),D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.C,{}),Object(x.jsx)("h4",{children:"Google account successfully connected."})]})]}))})).catch((function(e){console.log(e),D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Could not connect Google account."})]})]}))}))}),R=function(e){f({googleId:null}).then((function(e){e.user?(y((function(e){return Object(i.a)(Object(i.a)({},e),{},{googleId:null})})),D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.C,{}),Object(x.jsx)("h4",{children:"Successfully disconnected Google."})]})]}))):D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Could not disconnect Google account. Please try again."})]})]}))})).catch((function(e){console.log(e),D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Could not disconnect Google account."})]})]}))}))};return Object(x.jsxs)("div",{className:"profileContainer",children:[Object(x.jsxs)("div",{className:"benner",children:[Object(x.jsxs)("div",{className:"profileImg",children:[Object(x.jsx)(b.n,{src:k.profileImg||"/profile-user.jpg"}),Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"91.832",height:"25.468",viewBox:"0 0 91.832 25.468",children:Object(x.jsxs)("g",{id:"Path_1937","data-name":"Path 1937",transform:"translate(15.429 -9.647)",fill:"#fff",children:[Object(x.jsx)("path",{d:"M 29.79687690734863 34.6146240234375 C 22.21588897705078 34.6146240234375 13.43720626831055 32.0111198425293 5.0779709815979 27.28368377685547 C -2.8753981590271 22.78578186035156 -9.78753662109375 16.7585563659668 -14.48426628112793 10.24203777313232 C -13.95890235900879 10.24473857879639 -13.30369663238525 10.25548648834229 -12.80753517150879 10.26361274719238 C -12.44524097442627 10.26955413818359 -12.15906429290771 10.27424812316895 -12.02891159057617 10.27424812316895 C -11.93940830230713 10.27424812316895 -11.86373233795166 10.26253128051758 -11.79978466033936 10.24241733551025 C -11.48864650726318 10.21196746826172 -10.04010391235352 10.17821311950684 -5.149840831756592 10.17821311950684 C -1.226676225662231 10.17821311950684 4.093100070953369 10.19837760925293 9.725229263305664 10.21973037719727 C 16.20444107055664 10.24428367614746 23.54814720153809 10.27211856842041 29.79687690734863 10.27211856842041 C 31.89767646789551 10.27211856842041 43.68988800048828 10.22107124328613 56.17448806762695 10.16702461242676 L 59.24650192260742 10.15374183654785 C 60.32665252685547 10.14907169342041 61.61424255371094 10.14680099487305 63.18285369873047 10.14680099487305 C 64.99295043945313 10.14680099487305 66.92156219482422 10.14978885650635 68.78666687011719 10.15269470214844 C 70.55825042724609 10.1554479598999 72.23158264160156 10.15804767608643 73.72422027587891 10.15804767608643 C 74.4501953125 10.15804767608643 75.08247375488281 10.1574182510376 75.63590240478516 10.15613842010498 C 74.24596405029297 13.15391826629639 71.95748138427734 16.1362361907959 68.82386779785156 19.03109550476074 C 65.67525482177734 21.9398250579834 61.6738166809082 24.71903610229492 57.25215911865234 27.06828308105469 C 52.91740798950195 29.37135314941406 48.15610122680664 31.27616500854492 43.48295974731445 32.57678985595703 C 38.69290161132813 33.90995407104492 33.96032333374023 34.6146240234375 29.79687690734863 34.6146240234375 Z",stroke:"none"}),Object(x.jsx)("path",{d:"M 63.18235397338867 10.64679336547852 C 61.61428070068359 10.64679336547852 60.32755279541016 10.64906692504883 59.24865341186523 10.65373229980469 L 56.18099212646484 10.6670036315918 C 43.69374084472656 10.72105407714844 31.89901733398438 10.77211761474609 29.79687881469727 10.77211761474609 C 23.54719161987305 10.77211761474609 16.2029914855957 10.74428176879883 9.723331451416016 10.71971893310547 C 4.091693878173828 10.69837951660156 -1.227619171142578 10.67821884155273 -5.149848937988281 10.67821884155273 C -9.844169616699219 10.67821884155273 -11.33226013183594 10.70873641967773 -11.7083740234375 10.73677062988281 C -11.80277252197266 10.76053237915039 -11.90915679931641 10.77424240112305 -12.0289306640625 10.77424240112305 C -12.16323089599609 10.77424240112305 -12.45131683349609 10.7695198059082 -12.81605529785156 10.76354217529297 C -13.01943206787109 10.76021194458008 -13.24966430664063 10.75643920898438 -13.48653411865234 10.75296401977539 C -8.851593017578125 16.903076171875 -2.239547729492188 22.57095718383789 5.324104309082031 26.84845542907715 C 13.60947799682617 31.53411865234375 22.30074310302734 34.11461639404297 29.79687881469727 34.11461639404297 C 33.91565704345703 34.11461639404297 38.60186767578125 33.41628265380859 43.34890747070313 32.0950927734375 C 47.98773193359375 30.80401802062988 52.71426773071289 28.91309356689453 57.0175666809082 26.62672996520996 C 61.40182876586914 24.29735565185547 65.3670654296875 21.5438175201416 68.48458099365234 18.6638298034668 C 71.32099151611328 16.04351997375488 73.45128631591797 13.35661125183105 74.83492279052734 10.65748596191406 C 74.4908447265625 10.65786743164063 74.12125396728516 10.65805435180664 73.72370147705078 10.65805435180664 C 72.23068237304688 10.65805435180664 70.55716705322266 10.65545654296875 68.78539276123047 10.65269470214844 C 66.92047119140625 10.6497917175293 64.9920654296875 10.64679336547852 63.18235397338867 10.64679336547852 M 63.18235778808594 9.646797180175781 C 66.69034576416016 9.646797180175781 70.639892578125 9.658050537109375 73.72370910644531 9.658050537109375 C 74.72272491455078 9.658050537109375 75.63052368164063 9.656867980957031 76.4033203125 9.653743743896484 C 70.7041015625 23.3221435546875 47.19384002685547 35.11461639404297 29.79687881469727 35.11461639404297 C 13.80905532836914 35.11461639404297 -5.7138671875 23.84020614624023 -15.427734375 9.772117614746094 C -15.45098876953125 9.749141693115234 -15.14891815185547 9.741405487060547 -14.71451568603516 9.741401672363281 C -13.8193359375 9.741401672363281 -12.36181640625 9.774246215820313 -12.02893829345703 9.774246215820313 C -11.98212432861328 9.774246215820313 -11.95759582519531 9.773597717285156 -11.9599609375 9.772117614746094 C -12.07225799560547 9.701694488525391 -9.402595520019531 9.678211212158203 -5.14984130859375 9.678211212158203 C 3.356430053710938 9.678211212158203 18.19854354858398 9.772117614746094 29.79687881469727 9.772117614746094 C 32.07231903076172 9.772117614746094 46.01445388793945 9.710941314697266 59.24433135986328 9.653743743896484 C 60.42824935913086 9.648624420166016 61.76977157592773 9.646797180175781 63.18235778808594 9.646797180175781 Z",stroke:"none",fill:"#336cf9"})]})}),Object(x.jsx)("input",{type:"file",accept:".jpg, .png, .jpeg",onChange:function(e){var t=e.target.files[0],c="https://cdn.deliverypay.in";if(t){var n,s=new FormData,r=Object(a.a)(e.target.files);try{for(r.s();!(n=r.n()).done;){var l=n.value;s.append("file",l)}}catch(o){r.e(o)}finally{r.f()}fetch("".concat(c,"/upload"),{method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?f({profileImg:c+"/"+e.files[0]}).then((function(e){e.user&&y((function(t){return Object(i.a)(Object(i.a)({},t),{},{profileImg:e.user.profileImg})}))})):D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Image upload failed"})]})]}))})).catch((function(e){D(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return D(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.i,{}),Object(x.jsx)("h4",{children:"Image upload failed. Make sure you're online."})]})]}))}))}}}),Object(x.jsx)("label",{children:"Edit"})]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"name",children:k.firstName+" "+k.lastName}),Object(x.jsxs)("p",{className:"id",children:["Delivery pay ID: ",k.userId||k._id]})]})]}),Object(x.jsxs)("div",{className:"settings",children:[Object(x.jsx)("div",{className:"head",children:"Account Settings"}),Object(x.jsxs)("ul",{children:[Object(x.jsx)(v,{label:"Name",fields:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"First name",defaultValue:k.firstName,name:"firstName",required:!0})}),Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"last name",defaultValue:k.lastName,name:"lastName",required:!0})})]}),value:k.firstName+" "+k.lastName}),Object(x.jsx)(v,{label:"Phone Number",fields:Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"Phone Number",defaultValue:k.phone,name:"phone",required:!0,pattern:"^(\\+91|91|1|)\\d{10}$"})})}),value:k.phone}),Object(x.jsx)(v,{label:"Email",fields:Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"email",placeholder:"Phone Number",defaultValue:k.email,name:"email",required:!0})})}),value:k.email}),Object(x.jsx)(v,{label:"Password",onError:function(){return S(!0)},fields:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"Password",name:"password",required:!0,type:"password",onChange:function(e){return S(!1)}})}),Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"Confirm password",name:"confirm_password",required:!0,type:"password",onChange:function(e){return S(!1)}})}),M&&Object(x.jsx)("p",{className:"errMsg",children:"Password did not match."})]}),value:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),Object(x.jsx)(v,{label:"Gender",fields:Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("section",{children:Object(x.jsx)("input",{placeholder:"Gender",defaultValue:k.gender,name:"gender",required:!0})})}),value:k.gender}),Object(x.jsx)(v,{label:"Age",fields:Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"number",placeholder:"Age",defaultValue:k.age,name:"age",required:!0})})}),value:k.age}),Object(x.jsx)(v,{label:"Address",fields:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"text",placeholder:"Address",defaultValue:k.address.street,name:"address.street",required:!0})}),Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"text",placeholder:"City",defaultValue:k.address.city,name:"address.city",required:!0})}),Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"text",placeholder:"State",defaultValue:k.address.state,name:"address.state",required:!0})}),Object(x.jsx)("section",{children:Object(x.jsx)("input",{type:"number",placeholder:"PIN Code",defaultValue:k.address.zip,name:"address.zip",required:!0})})]}),value:"".concat((null===(t=k.address)||void 0===t?void 0:t.street)||""," ").concat((null===(c=k.address)||void 0===c?void 0:c.city)||""," ").concat((null===(n=k.address)||void 0===n?void 0:n.state)||""," ").concat((null===(s=k.address)||void 0===s?void 0:s.zip)||"")})]})]}),Object(x.jsxs)("div",{className:"kyc",children:[Object(x.jsx)("div",{className:"head",children:"KYC"}),Object(x.jsx)("ul",{children:Object(x.jsx)(v,{label:"KYC",setMsg:D,formData:T,fields:Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Upload files for verification."}),Object(x.jsx)(b.k,{multiple:!0,prefill:null===(l=k.kyc)||void 0===l?void 0:l.files,name:"kyc.files",onChange:function(e){return I(e)}})]})}),value:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:["Status: ",(null===(d=k.kyc)||void 0===d?void 0:d.verified)?"Verified":"Unverified"]}),Object(x.jsx)("label",{children:"Files for verification:"}),Object(x.jsx)("ul",{className:"thumbs",children:Object(x.jsx)(b.q,{links:null===(h=k.kyc)||void 0===h?void 0:h.files})})]})})})]}),Object(x.jsxs)("div",{className:"paymentMethods",children:[Object(x.jsx)("div",{className:"head",children:"Payment Methods"}),Object(x.jsxs)("ul",{className:"methods",children:[k.paymentMethods.map((function(e,t){return Object(x.jsx)(m,{setMsg:D,method:e},t)})),0===(null===(p=k.paymentMethods)||void 0===p?void 0:p.length)&&Object(x.jsx)("p",{children:"No payment method added."})]})]}),Object(x.jsxs)("div",{className:"socials",children:[Object(x.jsx)("div",{className:"head",children:"Connect Social Accounts"}),Object(x.jsx)("ul",{className:"providers",children:k.googleId?Object(x.jsx)(O.a,{className:"google",clientId:"978249749020-kjq65au1n373ur5oap7n4ebo2fq1jdhq.apps.googleusercontent.com",buttonText:"Disconnect from Google",onSuccess:R,onFailure:R,cookiePolicy:"single_host_origin"}):Object(x.jsx)(O.a,{className:"google",clientId:"978249749020-kjq65au1n373ur5oap7n4ebo2fq1jdhq.apps.googleusercontent.com",buttonText:"Connect with Google",onSuccess:E,onFailure:E,cookiePolicy:"single_host_origin"})})]}),Object(x.jsx)(u.Modal,{className:"msg",open:_,children:_})]})}},169:function(e,t,c){"use strict";c.r(t);var n=c(13),s=c(10),a=c(3),i=c(23),r=c.n(i),l=c(28),o=c(1),j=c(12),d=c(9),u=c(17),b=c(4),h=c(2),O=c(174),x=c(0),f=Object(o.lazy)((function(){return Promise.all([c.e(0),c.e(3)]).then(c.bind(null,158)).then((function(e){return{default:e.MilestoneForm}}))})),p=function(e){var t=e.order,c=e.setOrders,i=e.selectAll,r=e.setBatch,l=e.batch,O=Object(o.useRef)(),f=Object(o.useRef)(),p=Object(b.g)(),m=(Object(o.useContext)(j.d).user,Object(o.useState)(i||!1)),v=Object(a.a)(m,2),g=v[0],k=v[1],y=Object(o.useState)(!1),C=Object(a.a)(y,2),N=(C[0],C[1],Object(o.useState)(!1)),M=Object(a.a)(N,2),S=M[0],F=M[1],P=function(){fetch("/api/declineOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(s.a)(Object(s.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))},_=function(){fetch("/api/acceptOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(s.a)(Object(s.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not accept order. Make sure you're online."})]})]}))}))},D=function(){fetch("/api/requestCancellation",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(s.a)(Object(s.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),F(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))};return Object(o.useEffect)((function(){k(i)}),[i]),Object(o.useEffect)((function(){r(g?function(e){return[].concat(Object(n.a)(e),[t._id])}:function(e){return e.filter((function(e){return e!==t._id}))})}),[g]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"order ".concat(g?"selected":""),onClick:function(e){e.nativeEvent.path.includes(O.current)||e.nativeEvent.path.includes(f.current)||l.length>0||p.push("/account/myShop/orders/".concat(t._id))},children:[Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:t.createdAt})}),Object(x.jsx)("td",{className:"user",children:Object(x.jsx)(d.G,{user:t.buyer})}),Object(x.jsx)("td",{children:t.products.reduce((function(e,t){return e+t.qty}),0)}),Object(x.jsx)("td",{children:t.refundable||"N/A"}),Object(x.jsx)("td",{children:t.milestones.length||"N/A"}),Object(x.jsx)("td",{children:t.status}),Object(x.jsxs)("td",{children:["\u20b9",t.total]}),Object(x.jsx)("td",{ref:O,children:0===l.length&&Object(x.jsxs)(d.a,{icon:Object(x.jsx)(d.g,{}),children:[Object(x.jsx)(h.b,{to:"/account/myShopping/orders/".concat(t._id),children:"View Detail"}),"pending"===t.status&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Accept Order",question:"You sure want to accept this order?",callback:_})},children:"Accept order"}),Object(x.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Order Cancellation",question:"You sure want to cancel this order?",callback:P})},children:"Cancel order"})]}),"approved"===t.status&&Object(x.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Order Cancellation",question:"You sure want to request cancellation for this order?",callback:D})},children:"Request Cancellation"})]})})]}),Object(x.jsx)(u.Modal,{className:"msg",open:S,children:S})]})},m=function(e){var t,c=e.history,i=e.match,r=Object(o.useContext)(j.d),l=r.user,b=r.userType,O=Object(o.useState)(null),p=Object(a.a)(O,2),m=p[0],g=p[1],k=Object(o.useState)(null),y=Object(a.a)(k,2),C=y[0],N=y[1],M=Object(o.useState)((null===(t=l.shopInfo)||void 0===t?void 0:t.shippingCost)||0),S=Object(a.a)(M,2),F=(S[0],S[1]),P=Object(o.useState)(null),_=Object(a.a)(P,2),D=(_[0],_[1],Object(o.useState)("")),A=Object(a.a)(D,2),w=(A[0],A[1],Object(o.useState)(!1)),T=Object(a.a)(w,2),I=T[0],Y=T[1],q=Object(o.useState)(!1),E=Object(a.a)(q,2),R=E[0],B=E[1],U=(Object(o.useRef)(),function(){fetch("/api/acceptOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"approved"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Order approved."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not accept order. Make sure you're online."})]})]}))}))}),V=function(){fetch("/api/declineOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"declined"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Order declined."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not decline order. Make sure you're online."})]})]}))}))},G=function(){fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id,status:"shipped"})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},C),{},{status:"shipped"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Order has been updated. Don't forget to upload proof of shipping below."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Order could not be updated. Try again."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Order could not be updated. Make sure you're online."})]})]}))}))},H=function(){fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id,status:"delivered"})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},C),{},{status:"delivered"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Order has been updated. Don't forget to upload proof of delivery below."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Order could not be updated. Try again."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Order could not be updated. Make sure you're online."})]})]}))}))};if(Object(o.useEffect)((function(){fetch("/api/singleOrder?_id=".concat(i.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N(e.order),F(e.shippingCost)):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get order. Make sure you're online."})]})]}))}))}),[]),C){var L,J,K,W,z,Z=C.products.reduce((function(e,t){return(e+Object(d.K)({product:t.product,gst:!0})*t.qty).fix()}),0),Q="percent"===(null===(L=C.coupon)||void 0===L?void 0:L.type)&&Math.min(Z/100*C.coupon.amount,C.coupon.maxDiscount)||"flat"===(null===(J=C.coupon)||void 0===J?void 0:J.type)&&(null===(K=C.coupon)||void 0===K?void 0:K.amount)||0;((Z-Q+C.shippingCost)/100*C.fee).fix();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"actions",children:[Object(x.jsxs)(h.b,{to:"/account/".concat("seller"===b?"myShop":"myShopping","/orders"),className:"back",children:[Object(x.jsx)(d.c,{}),"Back"]}),"approved"===C.status&&Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Mark Order as Shipped",question:"Did you ship the order?",callback:G})},children:"Mark as Shipped"}),"shipped"===C.status&&Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Mark Order as Delivered",question:"Has the order been delivered?",callback:H})},children:"Mark as Delivered"}),"pending"===C.status&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){Object(u.Confirm)({lable:"Accept Order",question:Object(x.jsx)(x.Fragment,{children:"You sure want to accept this order?"}),callback:U})},children:"Accept"}),Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Decline Order",question:"You sure want to decline this order?",callback:V})},children:"Decline"})]})]}),Object(x.jsxs)("div",{className:"singleOrder",children:[Object(x.jsxs)("div",{className:"summery",children:[Object(x.jsx)("h3",{children:"Order Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Buyer"}),Object(x.jsx)(d.G,{user:C.buyer})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order ID"}),C._id]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status"}),C.status]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Submitted at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:C.createdAt})]}),Object(x.jsx)("li",{}),Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Delivery Address"}),Object(x.jsx)("span",{})]}),Object.entries(C.deliveryDetail).map((function(e,t){var c=Object(a.a)(e,2),n=c[0],s=c[1];return"deliveryWithin"===n?Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivery within"}),C.deliveryDetail.deliveryWithin," days"]},t):Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:n}),s]},t)}))]})]}),Object(x.jsxs)("div",{className:"products",children:[Object(x.jsx)("h3",{children:"Products"}),Object(x.jsx)("ul",{children:C.products.map((function(e,t){var c=e.product,n=e.qty,s=e.available;return Object(x.jsxs)("li",{children:[Object(x.jsx)(d.n,{src:c.images[0]||"/open_box.png"}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsx)("p",{children:c.name}),Object(x.jsxs)("p",{className:"qty",children:["QTY: ",n]}),"pending"===C.status&&Object(x.jsxs)("p",{className:"available",children:["Available: ",s.toString()]})]}),Object(x.jsxs)("div",{className:"price",children:[Object(x.jsxs)("span",{children:[Object(d.K)({product:c,gst:!0})," x ",n]}),"\u20b9",(Object(d.K)({product:c,gst:!0})*n).fix()]})]},t)}))}),Object(x.jsxs)("div",{className:"total",children:[Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Total"}),"\u20b9",Z]}),C.coupon&&Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Coupon Code ",C.coupon.code,Object(x.jsx)("br",{}),"Discount"," ","percent"===C.coupon.type?Object(x.jsxs)(x.Fragment,{children:[C.coupon.amount,"% (Upto \u20b9",C.coupon.maxDiscount,")"]}):Object(x.jsx)(x.Fragment,{children:"flat"})]}),Object(x.jsxs)("span",{children:["\u20b9",Q]})]})}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Shipping"}),"\u20b9",C.shippingCost]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Delivery Pay fee ",C.fee,"%"]}),"\u20b9",(C.total-C.total/(C.fee+100)*100).fix()]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Grand Total"}),"\u20b9",C.total.fix()]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"You'll recieve"}),"\u20b9",(C.total/(C.fee+100)*100).fix()]})]})]}),Object(x.jsxs)("div",{className:"milestones",children:[Object(x.jsx)("h3",{children:"Milestones"}),Object(x.jsx)("p",{className:"subtitle",children:"Click to view milestone detail."}),Object(x.jsxs)("table",{children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:"Date"}),Object(x.jsx)("td",{children:"Descrption"}),Object(x.jsx)("td",{children:"Amount"}),Object(x.jsx)("td",{children:"Status"})]})}),Object(x.jsxs)("tbody",{children:[C.milestones.map((function(e){return Object(x.jsxs)("tr",{onClick:function(){return c.push("/account/hold?q=".concat(e._id))},children:[Object(x.jsx)("td",{children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(x.jsx)("td",{children:e.dscr}),Object(x.jsxs)("td",{children:["\u20b9",e.amount]}),Object(x.jsx)("td",{children:e.status})]},e._id)})),0===C.milestones.length&&Object(x.jsx)("tr",{className:"placeholdert",children:Object(x.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(x.jsxs)("div",{className:"delivery",children:[Object(x.jsxs)("h3",{children:["Proof of delivery",("approved"===C.status||"shipped"===C.status)&&Object(x.jsx)("button",{onClick:function(){return B(!0)},children:"Upload proof of delivery"})]}),(null===(W=C.files)||void 0===W?void 0:W.length)>0?Object(x.jsx)("div",{className:"thumbs",children:Object(x.jsx)(d.q,{links:C.files})}):Object(x.jsx)(x.Fragment,{children:"No files added."})]}),Object(x.jsxs)("section",{className:"terms",children:[Object(x.jsx)("h3",{children:"Return Policy Terms"}),Object(x.jsx)("ul",{children:null===(z=C.terms)||void 0===z?void 0:z.map((function(e,t){return Object(x.jsxs)("li",{children:[e," "]},t)}))})]})]}),Object(x.jsx)(u.Modal,{head:!0,label:"Create Milestone",setOpen:Y,className:"milestoneRequest",open:I,children:Object(x.jsx)(f,{action:"request",definedAmount:C.total,client:C.buyer,order:C._id,onSuccess:function(e){Y(!1),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(x.jsx)("h4",{children:"Milestone has been requested"})]}),Object(x.jsx)(h.b,{to:"/account/hold",onClick:function(){return g(null)},children:"Check your Delivery pay Hold"})]})),N((function(t){return Object(s.a)(Object(s.a)({},t),{},{milestones:[].concat(Object(n.a)(t.milestones),[e])})}))}})}),Object(x.jsx)(u.Modal,{head:!0,label:"Upload proof of shipping & delivery",setOpen:B,open:R,className:"fileUpload",children:Object(x.jsx)(v,{order:C,onSuccess:function(e){B(!1),N((function(t){return Object(s.a)(Object(s.a)({},t),{},{files:e.files})}))}})}),Object(x.jsx)(u.Modal,{className:"msg",open:m,children:m})]})}return Object(x.jsx)(x.Fragment,{children:"Loading"})},v=function(e){var t=e.order,c=e.onSuccess,n=Object(o.useState)(!1),s=Object(a.a)(n,2),i=s[0],j=s[1],b=Object(o.useState)([]),h=Object(a.a)(b,2),O=h[0],f=h[1],p=Object(o.useState)(null),m=Object(a.a)(p,2),v=m[0],g=m[1],k=function(){var e=Object(l.a)(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),!O.length){e.next=7;break}return e.next=4,Object(d.F)({files:O,setMsg:g});case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=[];case 8:n=e.t0,fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id,files:n})}).then((function(e){return e.json()})).then((function(e){j(!1),"ok"===e.code?null===c||void 0===c||c(e.order):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upload files. Try again."})]})]}))})).catch((function(e){j(!1),console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upload files. Make sure you're online."})]})]}))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(u.Confirm)({title:"Upload Proof of Shipping & Delivery",question:Object(x.jsxs)(x.Fragment,{children:["You sure want to upload these files?",Object(x.jsx)("span",{className:"note",children:"Keep in mind these files can not be deleted later."})]}),callback:k})},children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Upload Images of the products, shipment reciept etc."}),Object(x.jsx)(d.k,{multiple:!0,accept:"image/*",required:!0,onChange:function(e){return f(e)}})]}),Object(x.jsx)("section",{className:"btns",children:Object(x.jsx)("button",{className:"submit",children:"Submit"})})]}),i&&Object(x.jsx)("div",{className:"spinnerContainer",children:Object(x.jsx)("div",{className:"spinner"})}),Object(x.jsx)(u.Modal,{className:"msg",open:v,children:v})]})},g=function(e){e.categories;var t=Object(o.useState)(0),c=Object(a.a)(t,2),n=c[0],i=c[1],r=Object(o.useState)(1),l=Object(a.a)(r,2),j=l[0],b=l[1],h=Object(o.useState)(20),O=Object(a.a)(h,2),f=O[0],m=O[1],v=Object(o.useState)(""),g=Object(a.a)(v,2),k=g[0],y=g[1],C=Object(o.useState)(""),N=Object(a.a)(C,2),M=N[0],S=N[1],F=Object(o.useState)({column:"createdAt",order:"dsc"}),P=Object(a.a)(F,2),_=P[0],D=(P[1],Object(o.useState)(null)),A=Object(a.a)(D,2),w=A[0],T=A[1],I=Object(o.useState)([]),Y=Object(a.a)(I,2),q=Y[0],E=Y[1],R=Object(o.useState)(!1),B=Object(a.a)(R,2),U=B[0],V=B[1],G=Object(o.useState)([]),H=Object(a.a)(G,2),L=H[0],J=H[1],K=Object(o.useState)(null),W=Object(a.a)(K,2),z=W[0],Z=W[1];return Object(o.useEffect)((function(){var e=Object(d.L)({time:null===w||void 0===w?void 0:w.startDate,format:"YYYY-MM-DD"}),t=Object(d.L)({time:null===w||void 0===w?void 0:w.endDate.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getOrders?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)({user:"seller"},M&&{q:M}),{},{page:j,perPage:f,sort:_.column,order:_.order},w&&{dateFrom:e,dateTo:t}),k&&{status:k})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(E(e.orders),i(e.total))})).catch((function(e){console.log(e),Z(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Z(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[k,M,j,f,w]),Object(o.useEffect)((function(){U||J([])}),[U]),Object(o.useEffect)((function(){0===L.length&&V(!1)}),[L]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"Order Management"})}),Object(x.jsxs)("div",{className:"filters",children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Total:"}),n]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Per Page:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return m(e.value)}})]}),Object(x.jsxs)("section",{className:"search",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(x.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(x.jsx)("input",{value:M,onChange:function(e){return S(e.target.value)},placeholder:"Search for Buyer"}),M&&Object(x.jsx)("button",{onClick:function(){return S("")},children:Object(x.jsx)(d.H,{})})]}),Object(x.jsxs)("section",{className:"category",children:[Object(x.jsx)("label",{children:"Status:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Cancelled",value:"cancelled"},{label:"Hold",value:"Hold"},{label:"Shipped",value:"shipped"},{label:"Delivered",value:"delivered"},{label:"Refunded",value:"refunded"}],onChange:function(e){return y(e.value)}})]}),Object(x.jsx)("section",{className:"date",children:Object(x.jsx)(d.o,{dateRange:w,onChange:function(e){return T(e)}})})]}),L.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table orders",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"date",children:"Date"}),Object(x.jsx)("th",{children:"Buyer"}),Object(x.jsx)("th",{children:"QTY"}),Object(x.jsx)("th",{children:"Refundable"}),Object(x.jsx)("th",{children:"Milestone"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Total Price"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[q.map((function(e,t){return Object(x.jsx)(p,{order:e,setOrders:E,selectAll:U,setBatch:J,batch:L},t)})),0===q.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No product yet."})})]})]}),Object(x.jsx)(d.u,{total:n,btns:5,currentPage:j,perPage:f,setPage:b}),Object(x.jsx)(u.Modal,{className:"msg",open:z,children:z})]})},k=Object(o.lazy)((function(){return Promise.all([c.e(0),c.e(3)]).then(c.bind(null,158)).then((function(e){return{default:e.MilestoneForm}}))})),y=function(e){var t,c=e.refund,s=(e.setRefunds,e.selectAll),i=e.setBatch,r=(e.batch,Object(b.g)()),l=(Object(o.useContext)(j.d).user,Object(o.useState)(s||!1)),h=Object(a.a)(l,2),O=h[0],f=h[1],p=Object(o.useState)(!1),m=Object(a.a)(p,2),v=(m[0],m[1],Object(o.useState)(!1)),g=Object(a.a)(v,2),k=g[0];g[1];return Object(o.useEffect)((function(){f(s)}),[s]),Object(o.useEffect)((function(){i(O?function(e){return[].concat(Object(n.a)(e),[c._id])}:function(e){return e.filter((function(e){return e!==c._id}))})}),[O]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"refund ".concat(O?"selected":""),onClick:function(){return r.push("/account/myShop/refunds/".concat(c._id))},children:[Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:c.createdAt})}),Object(x.jsx)("td",{children:Object(x.jsx)(d.G,{user:c.seller})}),Object(x.jsx)("td",{children:null===(t=c.order)||void 0===t?void 0:t.products.reduce((function(e,t){return e+t.qty}),0)}),Object(x.jsx)("td",{children:c.status}),Object(x.jsxs)("td",{children:["\u20b9",c.order.total]})]}),Object(x.jsx)(u.Modal,{className:"msg",open:k,children:k})]})},C=function(e){var t,c,i,b=e.history,O=e.match,f=Object(o.useContext)(j.d).userType,p=Object(o.useState)(null),m=Object(a.a)(p,2),v=m[0],g=m[1],y=Object(o.useState)(null),C=Object(a.a)(y,2),N=C[0],M=C[1],S=Object(o.useState)(null),F=Object(a.a)(S,2),P=F[0],_=F[1],D=Object(o.useState)(!1),A=Object(a.a)(D,2),w=A[0],T=A[1],I=Object(o.useState)(!1),Y=Object(a.a)(I,2),q=Y[0],E=Y[1],R=(Object(o.useRef)(),function(){var e=Object(l.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/updateRefund",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(s.a)(Object(s.a)({},t),{},{_id:N._id}))}).then((function(e){return e.json()})).then((function(e){if("ok"===e.code)return e.order;g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not update refund. Make sure you're online."})]})]}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),B=function(){var e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/acceptRefund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:N._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"approved"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Refund request has been approved."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not accept refund request. Make sure you're online."})]})]}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/declineRefund",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:N._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"declined"})})),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Refund request has been declined."})]})]}))):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not decline refund request. Make sure you're online."})]})]}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){fetch("/api/singleRefund?_id=".concat(O.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(_(e.refund.order),M(e.refund)):g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get Refund. Make sure you're online."})]})]}))}))}),[]),Object(o.useEffect)((function(){if(null===P||void 0===P?void 0:P.refundable){var e=0;switch(P.refundable){case"Upto 24 Hours After Delivery":e=1;break;case"Upto 7 Days After Delivery":e=7;break;case"Upto 15 Days After Delivery":e=15;break;default:return}var t=new Date((new Date).getTime()+864e5*e);new Date<t?E(t):E(null)}else E(null)}),[N]),N?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"actions",children:[Object(x.jsxs)(h.b,{to:"/account/".concat("seller"===f?"myShop":"myShopping","/refunds"),className:"back",children:[Object(x.jsx)(d.c,{}),"Back"]}),"productSent"===N.status&&Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Refund Resolved",question:"You sure want to mark this refund resolved?",callback:function(){R({status:"productRecieved"}).then((function(e){M((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"productRecieved"})}))}))}})},children:"Mark as Recieved"}),"pending"===N.status&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Refund",question:"Do you accept this refund request?",callback:B})},children:"Accept"}),Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Declining Refund",question:"Do you decline this refund?",callback:U})},children:"Decline"})]})]}),Object(x.jsxs)("div",{className:"singleOrder",children:[Object(x.jsxs)("div",{className:"summery",children:[Object(x.jsx)("h3",{children:"Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Order"}),Object(x.jsx)("span",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Seller"}),Object(x.jsx)(d.G,{user:P.seller})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order ID"}),P._id]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status"}),P.status]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Ordered at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:P.createdAt})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivered at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:P.deliveredAt})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refundable"}),P.refundable||"N/A"]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Proof of delivery"}),(null===(t=P.files)||void 0===t?void 0:t.length)>0?Object(x.jsx)("div",{className:"thumbs",children:Object(x.jsx)(d.q,{links:P.files})}):Object(x.jsx)(x.Fragment,{children:"No files added."})]}),q&&Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refund till"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:q})]}),Object(x.jsx)("li",{}),Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Refund"}),Object(x.jsx)("span",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refund ID"}),N._id]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status"}),N.status]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Submitted at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:N.createdAt})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Issue"}),N.issue]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Descrption"}),N.dscr]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Images"}),Object(x.jsx)("div",{className:"thumbs",children:N.files.length?Object(x.jsx)(d.q,{links:N.files}):Object(x.jsx)(x.Fragment,{children:"No Images has been provided."})})]}),Object(x.jsx)("li",{}),Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Delivery Address"}),Object(x.jsx)("span",{})]}),Object(x.jsx)(x.Fragment,{children:Object.entries(P.deliveryDetail).map((function(e,t){var c=Object(a.a)(e,2),n=c[0],s=c[1];return"deliveryTime"===n?Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivery date"}),P.deliveryDetail.deliveryTime?Object(x.jsx)(d.s,{format:"DD MMM, YYYY hh:mma",children:P.deliveryDetail.deliveryTime}):"N/A"]},t):Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:n}),s]},t)}))})]})]}),Object(x.jsxs)("div",{className:"products",children:[Object(x.jsx)("h3",{children:"Products"}),Object(x.jsx)("ul",{children:P.products.map((function(e,t){var c=e.product,n=e.qty;return Object(x.jsxs)("li",{children:[Object(x.jsx)(d.n,{src:c.images[0]||"/open_box.png"}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsx)("p",{children:c.name}),Object(x.jsxs)("p",{className:"qty",children:["QTY: ",n]})]}),Object(x.jsxs)("div",{className:"price",children:[Object(x.jsxs)("span",{children:[Object(d.K)({product:c,gst:!0})," x ",n]}),"\u20b9",Object(d.K)({product:c,gst:!0})*n]})]},t)}))}),Object(x.jsxs)("div",{className:"total",children:[Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Total"}),"\u20b9",P.products.reduce((function(e,t){return e+Object(d.K)({product:t.product,gst:!0})*t.qty}),0)]}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Shipping"}),P.shipping||"N/A"]}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Grand Total"}),"\u20b9",P.products.reduce((function(e,t){return e+Object(d.K)({product:t.product,gst:!0})*t.qty}),0)+(+P.shipping||0)]})]})]}),Object(x.jsxs)("div",{className:"milestones",children:[Object(x.jsxs)("h3",{children:["Milestones",("approved"===N.status||"productSent"===N.status||"productRecieved"===N.status)&&Object(x.jsx)("button",{onClick:function(){return T(!0)},children:"Create Milestone"})]}),"pending"===N.status&&Object(x.jsx)("p",{children:"You can create milestones once you accept the refund request."}),"declined"===N.status&&Object(x.jsx)("p",{children:"This refund request has been declined."}),!("declined"===N.status||"pending"===N.status)&&Object(x.jsxs)("table",{cellSpacing:0,cellPadding:0,children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:"Date"}),Object(x.jsx)("td",{children:"Descrption"}),Object(x.jsx)("td",{children:"Amount"}),Object(x.jsx)("td",{children:"Status"})]})}),Object(x.jsxs)("tbody",{children:[N.milestones.map((function(e){return Object(x.jsxs)("tr",{onClick:function(){return b.push("/account/hold?q=".concat(e._id))},children:[Object(x.jsx)("td",{children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(x.jsx)("td",{children:e.dscr}),Object(x.jsxs)("td",{children:["\u20b9",e.amount]}),Object(x.jsx)("td",{children:e.status})]},e._id)})),0===N.milestones.length&&Object(x.jsx)("tr",{className:"placeholdert",children:Object(x.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(x.jsxs)("section",{className:"terms",children:[Object(x.jsx)("h3",{children:"Return Policy Terms"}),Object(x.jsxs)("ul",{children:[null===(c=P.terms)||void 0===c?void 0:c.map((function(e,t){return Object(x.jsx)("li",{children:e},t)})),!(null===(i=P.terms)||void 0===i?void 0:i.length)&&Object(x.jsx)("li",{children:"No terms has been set by the seller yet."})]})]})]}),Object(x.jsx)(u.Modal,{head:!0,label:"Create Milestone",setOpen:T,className:"milestoneRequest",open:w,children:Object(x.jsx)(k,{action:"create",definedAmount:P.total,client:N.seller,refund:N._id,onSuccess:function(e){T(!1),g(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(x.jsx)("h4",{children:"Milestone has been created"})]}),Object(x.jsx)(h.b,{to:"/account/hold",onClick:function(){return g(null)},children:"Check your Delivery pay Hold"})]})),M((function(t){return Object(s.a)(Object(s.a)({},t),{},{milestones:[].concat(Object(n.a)(t.milestones),[e])})}))}})}),Object(x.jsx)(u.Modal,{className:"msg",open:v,children:v})]}):Object(x.jsx)(x.Fragment,{children:"Loading"})},N=function(e){e.history,e.location;var t=Object(o.useContext)(j.d).userType,c=Object(o.useState)(0),n=Object(a.a)(c,2),i=n[0],r=n[1],l=Object(o.useState)(1),b=Object(a.a)(l,2),h=b[0],O=b[1],f=Object(o.useState)(20),p=Object(a.a)(f,2),m=p[0],v=p[1],g=Object(o.useState)(""),k=Object(a.a)(g,2),C=k[0],N=k[1],M=Object(o.useState)(""),S=Object(a.a)(M,2),F=S[0],P=S[1],_=Object(o.useState)({column:"createdAt",order:"dsc"}),D=Object(a.a)(_,2),A=D[0],w=(D[1],Object(o.useState)(null)),T=Object(a.a)(w,2),I=T[0],Y=T[1],q=Object(o.useState)([]),E=Object(a.a)(q,2),R=E[0],B=E[1],U=Object(o.useState)(!1),V=Object(a.a)(U,2),G=V[0],H=V[1],L=Object(o.useState)([]),J=Object(a.a)(L,2),K=J[0],W=J[1],z=Object(o.useState)(null),Z=Object(a.a)(z,2),Q=Z[0],$=Z[1];return Object(o.useEffect)((function(){var e,c=Object(d.L)({time:null===I||void 0===I?void 0:I.startDate,format:"YYYY-MM-DD"}),n=Object(d.L)({time:null===(e=new Date(null===I||void 0===I?void 0:I.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getRefunds?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)({user:t},C&&{q:C}),{},{page:h,perPage:m,sort:A.column,order:A.order},I&&{dateFrom:c,dateTo:n}),F&&{status:F})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(B(e.refunds),r(e.total))})).catch((function(e){console.log(e),$(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[C,h,m,I,F]),Object(o.useEffect)((function(){G||W([])}),[G]),Object(o.useEffect)((function(){0===K.length&&H(!1)}),[K]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"My Refunds"})}),Object(x.jsxs)("div",{className:"filters",children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Total:"}),i]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Per Page:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return v(e.value)}})]}),Object(x.jsxs)("section",{className:"search",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(x.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(x.jsx)("input",{value:C,onChange:function(e){return N(e.target.value)},placeholder:"Search for Customer"}),C&&Object(x.jsx)("button",{onClick:function(){return N("")},children:Object(x.jsx)(d.H,{})})]}),Object(x.jsxs)("section",{className:"category",children:[Object(x.jsx)("label",{children:"Status:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Product Sent",value:"productSent"},{label:"Product Recieved",value:"productRecieved"},{label:"Resolved",value:"resolved"}],onChange:function(e){return P(e.value)}})]}),Object(x.jsx)("section",{className:"date",children:Object(x.jsx)(d.o,{dateRange:I,onChange:function(e){return Y(e)}})})]}),K.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table refunds",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"date",children:"Date"}),Object(x.jsx)("th",{children:"Customer"}),Object(x.jsx)("th",{children:"QTY"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Total Price"})]})}),Object(x.jsxs)("tbody",{children:[R.map((function(e){return Object(x.jsx)(y,{refund:e,setRefunds:B,selectAll:G,setBatch:W,batch:K},e._id)})),0===R.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No product yet."})})]})]}),Object(x.jsx)(d.u,{total:i,btns:5,currentPage:h,perPage:m,setPage:O}),Object(x.jsx)(u.Modal,{className:"msg",open:Q,children:Q})]})},M=(c(44),function(e){var t,c,i,r,l,O,f=e.coupon,p=e.setCoupons,m=e.selectAll,v=e.setBatch,g=e.batch,k=Object(o.useRef)(),y=Object(o.useRef)(),C=(Object(b.g)(),Object(o.useContext)(j.d).user,Object(o.useState)(m||!1)),N=Object(a.a)(C,2),M=N[0],S=N[1],F=Object(o.useState)(!1),P=Object(a.a)(F,2),_=(P[0],P[1],Object(o.useState)(!1)),D=Object(a.a)(_,2),A=D[0],w=D[1],T=Object(o.useState)(!1),I=Object(a.a)(T,2),Y=I[0],q=I[1];return Object(o.useEffect)((function(){S(m)}),[m]),Object(o.useEffect)((function(){v(M?function(e){return[].concat(Object(n.a)(e),[f._id])}:function(e){return e.filter((function(e){return e!==f._id}))})}),[M]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"coupon ".concat(M?"selected":""),onClick:function(e){e.nativeEvent.path.includes(k.current)||e.nativeEvent.path.includes(y.current)||g.length>0||q(f)},children:[Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YY",children:f.createdAt})}),Object(x.jsx)("td",{children:f.title}),Object(x.jsx)("td",{children:f.status}),Object(x.jsx)("td",{children:f.code}),Object(x.jsx)("td",{className:"discount",children:"percent"===f.type?Object(x.jsxs)(x.Fragment,{children:[f.amount,"%",Object(x.jsxs)("span",{children:["Up to \u20b9",f.maxDiscount]})]}):Object(x.jsxs)(x.Fragment,{children:["\u20b9",f.amount]})}),Object(x.jsxs)("td",{children:["\u20b9",f.threshold]}),Object(x.jsxs)("td",{children:[Object(x.jsx)(d.s,{format:"DD MMM YY",children:null===(t=f.date)||void 0===t?void 0:t.from}),"-",Object(x.jsx)(d.s,{format:"DD MMM YY",children:null===(c=f.date)||void 0===c?void 0:c.to})]}),Object(x.jsx)("td",{children:f.accept?"Yes":"No"}),Object(x.jsx)("td",{ref:k,children:0===g.length&&Object(x.jsxs)(d.a,{icon:Object(x.jsx)(d.g,{}),children:[Object(x.jsx)("button",{onClick:function(){return q(f)},children:"View Detail"}),f.accept&&Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Coupon code",question:"You sure want to take part in this campaign and accept this coupon code?",callback:function(){return e=f._id,void fetch("/api/declineCoupon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(p((function(t){return t.map((function(t){return t._id===e?Object(s.a)(Object(s.a)({},t),{},{accept:!1}):t}))})),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Coupon code declined. Buyers can no longer apply this coupon code on your shop."})]})]}))):w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not decline Coupon code. please try again."})]})]}))})).catch((function(e){console.log(e),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not decline Coupon code. Make sure you're online."})]})]}))}));var e}})},children:"Decline"}),new Date(null===(i=f.date)||void 0===i?void 0:i.to)>=new Date(Object(d.L)({time:new Date,format:"YYYY-MM-DD"}))&&!f.accept&&Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Coupon code",question:"You sure want to take part in this campaign and accept this coupon code?",callback:function(){return e=f._id,void fetch("/api/acceptCoupon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(p((function(t){return t.map((function(t){return t._id===e?Object(s.a)(Object(s.a)({},t),{},{accept:!0}):t}))})),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Coupon code accepted. Now Buyers can apply this coupon code on your shop."})]})]}))):w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not accept Coupon code. please try again."})]})]}))})).catch((function(e){console.log(e),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not accept Coupon code. Make sure you're online."})]})]}))}));var e}})},children:"Accept"})]})})]}),Object(x.jsx)(u.Modal,{className:"msg",open:A,children:A}),Object(x.jsx)(u.Modal,{open:Y,head:!0,label:"Coupon Detail",setOpen:q,className:"couponDetail",children:Object(x.jsxs)("div",{className:"content",children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Campaign Title"}),Object(x.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.title})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Campaign Description"}),Object(x.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.dscr})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Coupon Code"}),Object(x.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.code})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Coupon code status"}),Object(x.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.status})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Discount"}),Object(x.jsx)("p",{children:"percent"===(null===Y||void 0===Y?void 0:Y.type)?Object(x.jsxs)(x.Fragment,{children:[null===Y||void 0===Y?void 0:Y.amount,"% up to \u20b9",Y.maxDiscount]}):Object(x.jsxs)(x.Fragment,{children:["\u20b9",null===Y||void 0===Y?void 0:Y.amount]})})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Validity"}),Object(x.jsxs)("p",{children:[Object(x.jsx)(d.s,{format:"DD MMM YY",children:null===(r=Y.date)||void 0===r?void 0:r.from}),"-",Object(x.jsx)(d.s,{format:"DD MMM YY",children:null===(l=Y.date)||void 0===l?void 0:l.to})]})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Accept"}),Object(x.jsx)("p",{children:Y.accept?"Yes":"No"})]}),Y.termsUrl&&Object(x.jsxs)("section",{className:"termsUrl",children:[Object(x.jsx)("label",{children:"Terms"}),Object(x.jsx)(h.b,{to:Y.termsUrl,target:"_blank",children:"Terms of the Campaign"})]}),(null===(O=Y.terms)||void 0===O?void 0:O.length)?Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Terms"}),Object(x.jsx)("ul",{children:Y.terms.map((function(e,t){return Object(x.jsx)("li",{children:e},t)}))})]}):null]})})]})}),S=function(e){e.categories;var t=Object(o.useState)(0),c=Object(a.a)(t,2),n=c[0],i=c[1],r=Object(o.useState)(1),l=Object(a.a)(r,2),j=l[0],b=l[1],h=Object(o.useState)(20),O=Object(a.a)(h,2),f=O[0],p=O[1],m=Object(o.useState)(""),v=Object(a.a)(m,2),g=v[0],k=v[1],y=Object(o.useState)(""),C=Object(a.a)(y,2),N=C[0],S=C[1],F=Object(o.useState)({column:"createdAt",coupon:"dsc"}),P=Object(a.a)(F,2),_=P[0],D=(P[1],Object(o.useState)([])),A=Object(a.a)(D,2),w=A[0],T=A[1],I=Object(o.useState)(!1),Y=Object(a.a)(I,2),q=Y[0],E=Y[1],R=Object(o.useState)([]),B=Object(a.a)(R,2),U=B[0],V=B[1],G=Object(o.useState)(null),H=Object(a.a)(G,2),L=H[0],J=H[1];return Object(o.useEffect)((function(){fetch("/api/getCoupons?".concat(new URLSearchParams(Object(s.a)(Object(s.a)({},N&&{q:N}),{},{page:j,perPage:f,sort:_.column,order:_.order},g&&{status:g})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(T(e.coupons),i(e.total))})).catch((function(e){console.log(e),J(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return J(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get coupons."})]})]}))}))}),[g,N,j,f]),Object(o.useEffect)((function(){q||V([])}),[q]),Object(o.useEffect)((function(){0===U.length&&E(!1)}),[U]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"Order Management"})}),Object(x.jsxs)("div",{className:"filters",children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Total:"}),n]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Per Page:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return p(e.value)}})]}),Object(x.jsxs)("section",{className:"search",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(x.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(x.jsx)("input",{value:N,onChange:function(e){return S(e.target.value)},placeholder:"Search for Buyer"}),N&&Object(x.jsx)("button",{onClick:function(){return S("")},children:Object(x.jsx)(d.H,{})})]}),Object(x.jsxs)("section",{className:"category",children:[Object(x.jsx)("label",{children:"Status:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"draft"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],onChange:function(e){return k(e.value)}})]})]}),U.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table coupons",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"date",children:"Date"}),Object(x.jsx)("th",{children:"Title"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Code"}),Object(x.jsx)("th",{children:"Discount"}),Object(x.jsx)("th",{children:"Threshold"}),Object(x.jsx)("th",{children:"Validity"}),Object(x.jsx)("th",{children:"Accept"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[w.map((function(e,t){return Object(x.jsx)(M,{coupon:e,setCoupons:T,selectAll:q,setBatch:V,batch:U},t)})),0===w.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No Campaign yet."})})]})]}),Object(x.jsx)(d.u,{total:n,btns:5,currentPage:j,perPage:f,setPage:b}),Object(x.jsx)(u.Modal,{className:"msg",open:L,children:L})]})},F=c(159);c(250);var P=function(e){var t=e.label,c=e.defaultStatus,n=e.children,s=e.disabled,i=e.className,r=e.data,l=(e.step,Object(o.useState)(r?!r:null)),j=Object(a.a)(l,2),u=j[0],b=j[1];return Object(o.useEffect)((function(){b(c)}),[c]),Object(x.jsxs)("div",{className:"step ".concat(u||c?"open":""," ").concat(s?"disabled":""," ").concat(i||""),children:[Object(x.jsxs)("div",{className:"head",onClick:function(){c||b(!u)},children:[Object(x.jsx)(d.g,{className:"chev"})," ",t,Object(x.jsx)("div",{className:"status",children:r&&Object(x.jsx)(d.A,{})})]}),(u||c)&&Object(x.jsx)("div",{className:"body",children:n})]})},_=function(e){var t,c,n=e.setLoading,i=Object(o.useContext)(j.d),r=i.user,l=i.setUser,u=window.FB,b=Object(o.useState)([]),h=Object(a.a)(b,2),O=h[0],f=h[1],p=Object(o.useState)(null),m=Object(a.a)(p,2),v=m[0],g=m[1];return Object(o.useEffect)((function(){var e,t;(null===(e=r.fbMarket)||void 0===e||null===(t=e.business)||void 0===t?void 0:t.id)||u.api("/me","GET",{fields:"businesses{picture{url},name,id,created_time}",access_token:d.p.get("facebook_user_accessToken")},(function(e){e.businesses&&f(e.businesses.data)}))}),[r]),Object(x.jsx)(x.Fragment,{children:(null===(t=r.fbMarket)||void 0===t||null===(c=t.businessManager)||void 0===c?void 0:c.id)?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"The Business Manager that owns all your Facebook business accounts."}),Object(x.jsx)("ul",{children:Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:r.fbMarket.businessManager.profileImg}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(r.fbMarket.businessManager.id),children:[r.fbMarket.businessManager.name," ",Object(x.jsx)(d.j,{})]}),Object(x.jsxs)("span",{children:["ID: ",r.fbMarket.businessManager.id]}),Object(x.jsxs)("span",{children:["Created at:"," ",Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:r.fbMarket.businessManager.created_time})]})]})]}),Object(x.jsx)("button",{onClick:function(){Object(F.updateProfileInfo)({"fbMarket.businessManager":{},"fbMarket.facebookPage":{},"fbMarket.commerceAccount":{},"fbMarket.userAgreement":!1}).then((function(e){var t=e.user;l((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},className:"btn",children:"Disconnect"})]})})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"Connect the Business Manager you use to manage your business Page, accounts, and product catalog. You can only connect a Business Manager you have admin access to."}),Object(x.jsx)("p",{className:"note",children:"After you connect, you may receive a verification email from Facebook. If so, you\u2019ll need to confirm your business email address before proceeding."}),v&&Object(x.jsx)("div",{className:"err",children:v}),Object(x.jsxs)("ul",{children:[O.map((function(e,t){return Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:e.picture.data.url}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(e.business_id,"&asset_id=").concat(e.asset_id),children:[e.name," ",Object(x.jsx)(d.j,{})]}),Object(x.jsxs)("span",{children:["ID: ",e.id]}),Object(x.jsxs)("span",{children:["Created at:"," ",Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:e.created_time})]})]})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.businessManager.id":e.id,"fbMarket.businessManager.name":e.name,"fbMarket.businessManager.createdAt":e.created_time,"fbMarket.businessManager.profileImg":e.picture.data.url}).then((function(e){var t=e.user;l((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Connect"})]},t)})),Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:"/profile-user.jpg"}),Object(x.jsx)("p",{children:"Create Business Manager"})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){var e,t,c,s;n(!0),console.log("/".concat(null===(e=r.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id,"/businesses")),u.api("/".concat(null===(c=r.fbMarket)||void 0===c||null===(s=c.user)||void 0===s?void 0:s.id,"/businesses"),"POST",{name:"Delivery Pay Business Manager",vertical:"ECOMMERCE"},(function(e){n(!1),console.log(e),e.id&&u.api("/me","GET",{fields:"businesses{picture{url},name,id,created_time}"},(function(e){e.businesses&&f(e.businesses.data)})),e.error&&(1===e.error.code?g(Object(x.jsx)(x.Fragment,{children:"You have reached maximum number of business manager one user can have. Use one of existing business manager instead of creating a new one."})):3947===e.error.code?g(Object(x.jsx)(x.Fragment,{children:'You already have a Business Manager with the same name. Select "Delivery Pay Business Manager" instead of creating a new one. or Choose another.'})):g(Object(x.jsx)(x.Fragment,{children:e.error.error_user_msg||e.error.message})))}))},children:"Create new"})]})]})]})})},D=function(){var e,t,c=window.FB,n=Object(o.useContext)(j.d),i=n.user,r=n.setUser,l=Object(o.useState)([]),b=Object(a.a)(l,2),h=b[0],O=b[1],f=Object(o.useState)(!1),p=Object(a.a)(f,2),m=p[0],v=p[1];return Object(o.useEffect)((function(){var e,t;(null===(e=i.fbMarket)||void 0===e||null===(t=e.business)||void 0===t?void 0:t.id)||c.api("/me/accounts","GET",{fields:"picture{url},access_token,name,category,business",access_token:d.p.get("facebook_user_accessToken")},(function(e){console.log("facebook pages:",e),e.data&&O(e.data)}))}),[i]),Object(x.jsxs)(x.Fragment,{children:[(null===(e=i.fbMarket)||void 0===e||null===(t=e.facebookPage)||void 0===t?void 0:t.id)?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"The Facebook business Page that you use to sell your products or post ads."}),Object(x.jsx)("ul",{children:Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:i.fbMarket.facebookPage.profileImg}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(i.fbMarket.businessManager.id),children:[i.fbMarket.facebookPage.name," ",Object(x.jsx)(d.j,{})]}),Object(x.jsxs)("span",{children:["Category: ",i.fbMarket.facebookPage.category]})]})]}),Object(x.jsx)("button",{onClick:function(){Object(F.updateProfileInfo)({"fbMarket.facebookPage":{},"fbMarket.commerceAccount":{},"fbMarket.userAgreement":!1}).then((function(e){var t=e.user;console.log(t.fbMarket),r((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},className:"btn",children:"Disconnect"})]})})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"Connect the business Page you use to sell products or post ads. You can only connect a Page you have admin access to."}),Object(x.jsxs)("ul",{children:[h.map((function(e,t){return Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:e.picture.data.url}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(e.business_id,"&asset_id=").concat(e.asset_id),children:[e.name," ",Object(x.jsx)(d.j,{})]}),Object(x.jsx)("span",{children:e.category})]})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.facebookPage.id":e.id,"fbMarket.facebookPage.name":e.name,"fbMarket.facebookPage.access_token":e.access_token,"fbMarket.facebookPage.profileImg":e.picture.data.url,"fbMarket.facebookPage.category":e.category}).then((function(e){var t=e.user;r((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Connect"})]},t)})),Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:"/profile-user.jpg"}),Object(x.jsx)("p",{children:"Create Page"})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){return v(!0)},children:"Create new"})]})]})]}),Object(x.jsx)(u.Modal,{head:!0,label:"Create a new Facebook business Page",open:m,setOpen:function(){v(!1),c.api("/me/accounts","GET",{fields:"picture{url},access_token,name,category,business",access_token:d.p.get("facebook_user_accessToken")},(function(e){console.log("facebook pages:",e),e.data&&O(e.data)}))},className:"createNewPage",children:Object(x.jsxs)("div",{className:"content",children:[Object(x.jsx)("p",{children:"You'll be redirected to Facebook where you can create a new business Page. All you need for now are basic details such as:"}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:"Business Page name"}),Object(x.jsx)("li",{children:"Business Page category"}),Object(x.jsx)("li",{children:"Profile Photo"}),Object(x.jsx)("li",{children:"Cover photo"}),Object(x.jsx)("li",{children:"Store description"})]}),Object(x.jsx)("p",{children:"As soon as you add these details, return to Delivery Pay and finish setup. You can always update your Page later."}),Object(x.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/pages/create/?ref_type=hc",children:[Object(x.jsx)(d.j,{})," Go to Facebook"]})]})})]})},A=function(e){var t,c,n,i,r,l,b,h=e.setStep,O=window.FB,f=Object(o.useContext)(j.d),p=f.user,m=f.setUser,v=Object(o.useState)([]),g=Object(a.a)(v,2),k=g[0],y=g[1],C=Object(o.useState)(!1),N=Object(a.a)(C,2),M=N[0],S=N[1],P=function(){var e,t,c;(null===(e=p.fbMarket)||void 0===e||null===(t=e.instagramAccount)||void 0===t?void 0:t.id)||O.api("/".concat(p.fbMarket.facebookPage.id,"/instagram_accounts"),"GET",{fields:"picture{url},access_token,name,category,business",access_token:null===(c=p.fbMarket.facebookPage)||void 0===c?void 0:c.access_token},(function(e){console.log("instagram accounts:",e),e.data&&y(e.data)}))};return Object(o.useEffect)((function(){P()}),[p]),Object(x.jsxs)(x.Fragment,{children:[(null===(t=p.fbMarket)||void 0===t||null===(c=t.instagramAccount)||void 0===c?void 0:c.id)?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"Post on Instagram directly from the product dashboard."}),Object(x.jsx)("ul",{children:Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:null===(n=p.fbMarket.instagramAccount)||void 0===n?void 0:n.profileImg}),Object(x.jsx)("div",{className:"detail",children:p.fbMarket.instagramAccount.name})]}),Object(x.jsx)("button",{onClick:function(){Object(F.updateProfileInfo)({"fbMarket.instagramAccount":{}}).then((function(e){var t=e.user;console.log(t.fbMarket),m((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},className:"btn",children:"Disconnect"})]})})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"note",children:"Connect Instagram account to post about your product directly from Delivery Pay product dashboard."}),Object(x.jsxs)("ul",{children:[k.map((function(e,t){return Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:e.picture.data.url}),Object(x.jsx)("div",{className:"detail",children:e.name})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.instagramAccount.id":e.id,"fbMarket.instagramAccount.name":e.name,"fbMarket.instagramAccount.access_token":e.access_token,"fbMarket.instagramAccount.profileImg":e.picture.data.url,"fbMarket.instagramAccount.category":e.category}).then((function(e){var t=e.user;m((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Connect"})]},t)})),Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:"/profile-user.jpg"}),Object(x.jsx)("p",{children:"Create Page"})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){return S(!0)},children:"Create new"})]})]}),Object(x.jsx)("div",{className:"btns",children:Object(x.jsx)("button",{className:"btn_clear",onClick:function(){h("commerceAccount")},children:"Skip"})})]}),Object(x.jsx)(u.Modal,{head:!0,label:"Create a new Facebook business Page",open:M,setOpen:function(){S(!1),P()},className:"createNewPage",children:Object(x.jsxs)("div",{className:"content",children:[Object(x.jsxs)("p",{children:["You'll be redirected to Facebook where you can connect your Instagram account with ",null===(i=p.fbMarket)||void 0===i||null===(r=i.facebookPage)||void 0===r?void 0:r.name,"."]}),Object(x.jsx)("p",{children:"As soon as you add these details, return to Delivery Pay and finish setup. You can always update your Instagram account later."}),Object(x.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/".concat(null===(l=p.fbMarket)||void 0===l||null===(b=l.facebookPage)||void 0===b?void 0:b.id,"/settings/?tab=instagram_management"),children:[Object(x.jsx)(d.j,{})," Go to Facebook"]})]})})]})},w=function(e){var t,c,n=e.setStep,i=window.FB,u=Object(o.useContext)(j.d),b=u.user,h=u.setUser,O=Object(o.useState)([]),f=Object(a.a)(O,2),p=(f[0],f[1],Object(o.useState)(null===(t=b.fbMarket)||void 0===t||null===(c=t.commerceAccount)||void 0===c?void 0:c.catalog)),m=Object(a.a)(p,2),v=m[0],g=m[1],k=Object(o.useState)(null),y=Object(a.a)(k,2),C=y[0],N=y[1];return Object(o.useEffect)((function(){var e,t;g(null===(e=b.fbMarket)||void 0===e||null===(t=e.commerceAccount)||void 0===t?void 0:t.catalog)}),[b]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{className:"note",children:["Create a Commerce account to start selling on Facebook, Instagram, or both. Once you have an account you\u2019ll be able to customize your Shop and collections in the"," ",Object(x.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/business/help/2371372636254534",children:["Facebook Commerce Manager ",Object(x.jsx)(d.j,{})]}),"."]}),C&&Object(x.jsx)("div",{className:"err",children:C}),Object(x.jsxs)("ul",{children:[v&&Object(x.jsxs)("li",{className:"catalog",children:[Object(x.jsx)("p",{children:"PRODUCTS WILL BE SYNCED TO THIS CATALOG"}),Object(x.jsx)("p",{children:v.name}),Object(x.jsxs)("span",{children:["ID: ",v.id]})]}),!v&&Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(d.n,{src:"/profile-user.jpg"}),Object(x.jsx)("p",{children:"Create a new Commerce Account"})]}),Object(x.jsx)("button",{className:"btn",onClick:function(){i.api("/".concat(b.fbMarket.businessManager.id,"/owned_product_catalogs"),"GET",{access_token:d.p.get("facebook_user_accessToken")},function(){var e=Object(l.a)(r.a.mark((function e(t){var c,a,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.data,a=t.error,console.log(c,a),a&&N(a.message),e.t0=null===c||void 0===c?void 0:c.find((function(e){return"Delivery Pay Product Catalog"===e.name})),e.t0){e.next=8;break}return e.next=7,i.api("/".concat(b.fbMarket.businessManager.id,"/owned_product_catalogs"),"POST",{name:"Delivery Pay Product Catalog",access_token:d.p.get("facebook_user_accessToken")},(function(e){return console.log(e.id),e.id?Object(s.a)(Object(s.a)({},e),{},{name:"Delivery Pay Product Catalog"}):null}));case 7:e.t0=e.sent;case 8:(l=e.t0)&&(g(l),Object(F.updateProfileInfo)({"fbMarket.commerceAccount.catalog":l}).then((function(e){var t=e.user;h((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})})),n("terms")})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Create new"})]})]})]})},T=function(){var e,t,c,n,i,r,l,b,O,f,p,m,v,g,k,y,C,N,M,S,T,I,Y,q,E,R,B,U,V=Object(o.useState)(null),G=Object(a.a)(V,2),H=G[0],L=G[1],J=Object(o.useContext)(j.d),K=J.user,W=J.setUser,z=window.FB,Z=Object(o.useState)(""),Q=Object(a.a)(Z,2),$=Q[0],X=Q[1],ee=Object(o.useState)(!1),te=Object(a.a)(ee,2),ce=(te[0],te[1]);return Object(o.useEffect)((function(){var e,t,c,n,s,a,i,r,l,o,j,d;console.log(K.fbMarket),(null===(e=K.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)?(null===(c=K.fbMarket)||void 0===c||null===(n=c.businessManager)||void 0===n?void 0:n.id)?(null===(s=K.fbMarket)||void 0===s||null===(a=s.facebookPage)||void 0===a?void 0:a.id)?(null===(i=K.fbMarket)||void 0===i||null===(r=i.instagramAccount)||void 0===r?void 0:r.id)?(null===(l=K.fbMarket)||void 0===l||null===(o=l.commerceAccount)||void 0===o||null===(j=o.catalog)||void 0===j?void 0:j.id)?(null===(d=K.fbMarket)||void 0===d?void 0:d.userAgreement)||X("terms"):X("commerceAccount"):X("instagramAccount"):X("fbPage"):X("businessManager"):X("account")}),[K]),Object(x.jsxs)("div",{className:"fbMarket",children:[Object(x.jsx)("h1",{children:"Facebook marketplace"}),Object(x.jsxs)("div",{className:"setup",children:[Object(x.jsxs)(P,{data:(null===(e=K.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)?K.fbMarket.user:null,defaultStatus:"account"===$,step:$,label:"Facebook Account",children:[Object(x.jsx)("p",{className:"note",children:"Delivery Pay uses your personal Facebook account to access your business accounts."}),Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)("div",{className:"user",children:(null===(c=K.fbMarket)||void 0===c||null===(n=c.user)||void 0===n?void 0:n.id)?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.n,{src:K.fbMarket.user.profileImg||"/profile-user.jpg"},"img"),Object(x.jsx)("p",{children:K.fbMarket.user.name})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.n,{src:"/profile-user.jpg"},"placeholder"),Object(x.jsx)("p",{children:"Connect your Facebook account to get started"})]})}),(null===(i=K.fbMarket)||void 0===i||null===(r=i.user)||void 0===r?void 0:r.id)?Object(x.jsx)("button",{className:"btn",onClick:function(){z.logout((function(e){console.log(e)})),d.p.remove("facebook_user_accessToken"),d.p.remove("facebook_page_accessToken"),Object(F.updateProfileInfo)({"fbMarket.user":{},"fbMarket.businessManager":{},"fbMarket.facebookPage":{},"fbMarket.dataSharing":null,"fbMarket.instagramAccount":{},"fbMarket.commerceAccount":{},"fbMarket.userAgreement":!1}).then((function(e){var t=e.user;W((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Disconnect"}):Object(x.jsx)("button",{className:"btn",onClick:function(){z.login((function(e){var t;d.p.set("facebook_user_accessToken",null===(t=e.authResponse)||void 0===t?void 0:t.accessToken);var c=e.authResponse.accessToken;fetch("/api/updateFBMarketUser",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:c})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&console.log("long_lived_token saved")})),z.api("/me","GET",{fields:"name,picture.type(large){url}"},(function(e){console.log(e),e.id&&Object(F.updateProfileInfo)({"fbMarket.user.name":e.name,"fbMarket.user.id":e.id,"fbMarket.user.profileImg":e.picture.data.url}).then((function(e){var t=e.user;W((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))}))}))},children:"Connect Account"})]})]}),Object(x.jsx)(P,{disabled:!(null===(l=K.fbMarket)||void 0===l||null===(b=l.user)||void 0===b?void 0:b.id),data:(null===(O=K.fbMarket)||void 0===O||null===(f=O.businessManager)||void 0===f?void 0:f.id)?K.fbMarket.businessManager:null,defaultStatus:"businessManager"===$,label:"Business Manager",className:"businessManager",children:Object(x.jsx)(_,{setLoading:ce})}),Object(x.jsx)(P,{data:(null===(p=K.fbMarket)||void 0===p||null===(m=p.facebookPage)||void 0===m?void 0:m.id)?K.fbMarket.facebookPage:null,defaultStatus:"fbPage"===$,label:"Facebook Page",className:"page",disabled:!(null===(v=K.fbMarket)||void 0===v||null===(g=v.businessManager)||void 0===g?void 0:g.id),children:Object(x.jsx)(D,{})}),Object(x.jsx)(P,{data:(null===(k=K.fbMarket)||void 0===k||null===(y=k.instagramAccount)||void 0===y?void 0:y.id)?K.fbMarket.instagramAccount:null,disabled:!(null===(C=K.fbMarket)||void 0===C||null===(N=C.facebookPage)||void 0===N?void 0:N.id),label:"Instagram Account",defaultStatus:"instagramAccount"===$,className:"instagramAccount",children:Object(x.jsx)(A,{setStep:X})}),Object(x.jsx)(P,{data:(null===(M=K.fbMarket)||void 0===M||null===(S=M.commerceAccount)||void 0===S||null===(T=S.catalog)||void 0===T?void 0:T.id)?K.fbMarket.commerceAccount:null,disabled:!(null===(I=K.fbMarket)||void 0===I||null===(Y=I.facebookPage)||void 0===Y?void 0:Y.id),label:"Facebook Commerce Account",defaultStatus:"commerceAccount"===$,className:"commerceAccount",children:Object(x.jsx)(w,{setStep:X})}),Object(x.jsxs)(P,{disabled:!(null===(q=K.fbMarket)||void 0===q||null===(E=q.commerceAccount)||void 0===E||null===(R=E.catalog)||void 0===R?void 0:R.id),data:(null===(B=K.fbMarket)||void 0===B?void 0:B.userAgreement)||null,defaultStatus:"terms"===$,label:"Terms and Conditions",children:[Object(x.jsxs)("p",{children:["By proceeding, you accept"," ",Object(x.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/legal/commerce_product_merchant_agreement",children:["Facebook Commerce Terms ",Object(x.jsx)(d.j,{})]}),"."]}),!(null===(U=K.fbMarket)||void 0===U?void 0:U.userAgreement)&&Object(x.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.userAgreement":!0}).then((function(e){var t=e.user;W((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})})),X(""),L(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return L(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Facebook marketplace has been setup successfully. Now you can add products to facebook marketplace directly from Delivery Pay."}),Object(x.jsx)(h.b,{to:"/account/myShop/products",children:"Add your first product"})]})]}))}))},children:"Finish setup"})]})]}),Object(x.jsx)(u.Modal,{open:H,className:"msg",children:H})]})},I=c(251);c(255);var Y=function(e){var t,c,i,b,f,p=e.prefill,m=e.onSuccess,v=e.categories,g=Object(o.useContext)(j.d).user,k=Object(o.useState)(!1),y=Object(a.a)(k,2),C=y[0],N=y[1],M=Object(o.useState)((null===p||void 0===p?void 0:p.type)||"product"),S=Object(a.a)(M,2),F=S[0],P=S[1],_=Object(o.useState)((null===p||void 0===p?void 0:p.category)||""),D=Object(a.a)(_,2),A=D[0],w=D[1],T=Object(o.useState)({type:(null===p||void 0===p||null===(t=p.discount)||void 0===t?void 0:t.type)||null,amount:(null===p||void 0===p||null===(c=p.discount)||void 0===c?void 0:c.amount)||0,dscr:(null===p||void 0===p||null===(i=p.discount)||void 0===i?void 0:i.dscr)||""}),I=Object(a.a)(T,2),Y=I[0],q=I[1],E=Object(o.useState)((null===p||void 0===p?void 0:p.name)||""),R=Object(a.a)(E,2),B=R[0],U=R[1],V=Object(o.useState)((null===p||void 0===p?void 0:p.dscr)||""),G=Object(a.a)(V,2),H=G[0],L=G[1],J=Object(o.useState)((null===p||void 0===p?void 0:p.price)||""),K=Object(a.a)(J,2),W=K[0],z=K[1],Z=Object(o.useState)((null===p||void 0===p?void 0:p.images)||[]),Q=Object(a.a)(Z,2),$=Q[0],X=Q[1],ee=Object(o.useState)((null===p||void 0===p?void 0:p.gst)||(null===(b=g.gst)||void 0===b?void 0:b.verified)?g.gst.amount:0),te=Object(a.a)(ee,2),ce=te[0],ne=te[1],se=Object(o.useState)((null===p||void 0===p?void 0:p.hsn)||""),ae=Object(a.a)(se,2),ie=ae[0],re=ae[1],le=Object(o.useState)(null===p||void 0===p?void 0:p.available),oe=Object(a.a)(le,2),je=oe[0],de=oe[1],ue=Object(o.useState)(null),be=Object(a.a)(ue,2),he=be[0],Oe=be[1],xe=Object(o.useState)((null===p||void 0===p?void 0:p.tags)||[]),fe=Object(a.a)(xe,2),pe=fe[0],me=fe[1],ve=function(){var e=Object(l.a)(r.a.mark((function e(t){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),N(!0),!$.length){e.next=8;break}return e.next=5,Object(d.F)({files:$,setMsg:Oe});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:c=e.t0,fetch("/api/".concat(p?"edit":"add","Product"),{method:p?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(s.a)({type:F,name:B,dscr:H,price:+W,images:c,category:A,tags:pe,available:!0===je||!1===je?je:+je,gst:ce,discount:Y},p&&{_id:p._id}))}).then((function(e){return e.json()})).then((function(e){N(!1),"ok"===e.code?null===m||void 0===m||m(e.product):403===e.code?Oe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"You can't add more that 100 product at a time. Delete a product/service and try again."})]})]})):Oe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add product. please try again."})]})]}))})).catch((function(e){N(!1),console.log(e),Oe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add product. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("form",{onSubmit:ve,className:C?"loading":"",children:[Object(x.jsxs)("section",{className:"type",children:[Object(x.jsx)("label",{children:"Type"}),Object(x.jsx)(d.h,{defaultValue:F,options:[{label:"Product",value:"product"},{label:"Service",value:"service"},{label:"Other",value:"other"}],onChange:function(e){P(e.value)}})]}),Object(x.jsxs)("section",{className:"name",children:[Object(x.jsx)("label",{children:"Name of the product/service"}),Object(x.jsx)("input",{value:B,onChange:function(e){return U(e.target.value)},required:!0})]}),Object(x.jsxs)("section",{className:"category",children:[Object(x.jsxs)("label",{children:["Category"," ",Object(x.jsxs)(d.E,{children:["You can Add/Edit/Delete your categories"," ",Object(x.jsx)(h.b,{to:"/account/myShop/settings",children:"here"})]})]}),Object(x.jsx)(d.h,{required:!0,defaultValue:A,options:v.map((function(e){return{label:e,value:e}})),onChange:function(e){return w(e.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Price \u20b9"}),Object(x.jsx)(d.t,{defaultValue:W,onChange:function(e){return z(e.target.value)},required:!0})]}),Object(x.jsx)("section",{className:"available",children:"product"===F?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Available in stock"}),Object(x.jsx)(d.t,{required:!0,defaultValue:je,onChange:function(e){return de(e.target.value)}})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Availability"}),Object(x.jsx)(d.h,{defaultValue:je,required:!0,options:[{label:"Available",value:!0},{label:"Not available",value:!1}],onChange:function(e){return de(e.value)}})]})}),Object(x.jsxs)("section",{className:"dscr",children:[Object(x.jsx)("label",{children:"Description of the product/service"}),Object(x.jsx)(O.a,{value:H,onChange:function(e){return L(e.target.value)},required:!0})]}),Object(x.jsxs)("section",{className:"tags",children:[Object(x.jsx)("label",{children:"Tags"}),Object(x.jsxs)("ul",{children:[pe.map((function(e){return Object(x.jsxs)("li",{children:[e,Object(x.jsx)("button",{onClick:function(){me((function(t){return t.filter((function(t){return t!==e}))}))},children:Object(x.jsx)(d.H,{})})]},e)})),Object(x.jsxs)("li",{className:"form",children:[Object(x.jsx)("input",{placeholder:"addNewTag",onKeyPress:function(e){var t="".concat(e.target.value.trim());if(13===e.charCode){if(e.preventDefault(),!t)return;me((function(e){return[].concat(Object(n.a)(e.filter((function(e){return e!==t}))),[t])})),e.target.focus(),e.target.value=""}}}),Object(x.jsx)("button",{type:"button",onClick:function(e){var t=e.target.previousElementSibling,c="".concat(e.target.previousElementSibling.value.trim());c&&(me((function(e){return[].concat(Object(n.a)(e.filter((function(e){return e!==c}))),[c])})),t.value="",t.focus())},children:"Add Tag"})]})]})]}),Object(x.jsxs)("section",{className:"images",children:[Object(x.jsx)("label",{children:"Images of the product"}),Object(x.jsx)(d.k,{multiple:!0,prefill:null===p||void 0===p?void 0:p.images,accept:"image/*",onChange:function(e){return X(e)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"HSN Code"}),Object(x.jsx)("input",{value:ie,onChange:function(e){return re(e.target.value)}})]}),(null===(f=g.gst)||void 0===f?void 0:f.verified)&&Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"GST (%)"}),Object(x.jsx)(d.t,{defaultValue:ce,onChange:function(e){return ne(e.target.value)}})]}),Object(x.jsxs)("section",{className:"discountType",children:[Object(x.jsx)("label",{children:"Discount Type"}),Object(x.jsx)(d.h,{defaultValue:Y.type,options:[{label:"None",value:null},{label:"Percent",value:"percent"},{label:"Flat",value:"flat"}],onChange:function(e){return q((function(t){return Object(s.a)(Object(s.a)({},t),{},{type:e.value})}))}})]}),null!==Y.type&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("section",{className:"discountAmount",children:[Object(x.jsxs)("label",{children:["Amount ","percent"===Y.type&&"(%)"]}),Object(x.jsx)(d.t,{defaultValue:Y.amount,onChange:function(e){return q((function(t){return Object(s.a)(Object(s.a)({},t),{},{amount:e.target.value})}))}})]}),Object(x.jsxs)("section",{className:"discountDscr",children:[Object(x.jsx)("label",{children:"Discount description"}),Object(x.jsx)(O.a,{defaultValue:Y.dscr,onChange:function(e){return q((function(t){return Object(s.a)(Object(s.a)({},t),{},{dscr:e.target.value})}))}})]})]}),W&&Object(x.jsxs)("section",{className:"finalPrice",children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{children:"Input price"}),W]}),+ce>0&&Object(x.jsxs)("p",{className:"gst",children:[Object(x.jsxs)("label",{children:["GST ",ce,"%"]}),"+",(+W/100*+ce).fix()]}),Y.amount>0&&"flat"===Y.type&&Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{children:"Discount flat"}),"- \u20b9",(+Y.amount).fix()]}),Y.amount>0&&"percent"===Y.type&&Object(x.jsxs)("p",{children:[Object(x.jsxs)("label",{children:["Discount ",Y.amount,"%"]}),"- \u20b9",(+W/100*Y.amount).fix()]}),Object(x.jsxs)("p",{className:"final",children:[Object(x.jsx)("label",{children:"Listing Price"}),"\u20b9",(+W+ +W/100*+ce-("percent"===Y.type?+W/100*Y.amount:0)-("flat"===Y.type?Y.amount:0)).fix()]})]}),Object(x.jsx)("section",{className:"btns",children:Object(x.jsx)("button",{className:"submit",type:"submit",children:"Submit"})}),Object(x.jsx)("div",{className:"pBtm"})]}),C&&Object(x.jsx)("div",{className:"spinnerContainer",children:Object(x.jsx)("div",{className:"spinner"})}),Object(x.jsx)(u.Modal,{className:"msg",open:he,children:he})]})},q=function(e){var t,c=e.categories,i=e.shopSetupComplete,r=Object(o.useContext)(j.d).user,l=(window.FB,Object(o.useState)(!1)),b=Object(a.a)(l,2),O=b[0],f=b[1],p=Object(o.useState)(0),m=Object(a.a)(p,2),v=m[0],g=m[1],k=Object(o.useState)(1),y=Object(a.a)(k,2),C=y[0],N=y[1],M=Object(o.useState)(20),S=Object(a.a)(M,2),F=S[0],P=S[1],_=Object(o.useState)(""),D=Object(a.a)(_,2),A=D[0],w=D[1],T=Object(o.useState)(""),I=Object(a.a)(T,2),q=I[0],B=I[1],U=Object(o.useState)({column:"createdAt",order:"dsc"}),V=Object(a.a)(U,2),G=V[0],H=(V[1],Object(o.useState)(null)),L=Object(a.a)(H,2),J=L[0],K=L[1],W=Object(o.useState)(""),z=Object(a.a)(W,2),Z=z[0],Q=z[1],$=Object(o.useState)([]),X=Object(a.a)($,2),ee=X[0],te=X[1],ce=Object(o.useState)(!1),ne=Object(a.a)(ce,2),se=ne[0],ae=ne[1],ie=Object(o.useState)([]),re=Object(a.a)(ie,2),le=re[0],oe=re[1],je=Object(o.useState)(!1),de=Object(a.a)(je,2),ue=de[0],be=de[1],he=Object(o.useState)(null),Oe=Object(a.a)(he,2),xe=Oe[0],fe=Oe[1],pe=function(e){e.length&&fetch("/api/deleteProducts",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(oe([]),te((function(t){return t.filter((function(t){return!e.some((function(e){return e===t._id}))}))}))):fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not delete products. Try again."})]})]}))})).catch((function(e){console.log(e),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not delete products. Make sure you're online."})]})]}))}))},me=function(){return pe(le)},ve=function(e){fetch("/api/addToFbMarket",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e,access_token:d.p.get("facebook_user_accessToken")})}).then((function(e){return e.json()})).then((function(e){var t=e.code,c=e.fb_products;if("ok"===t){var n=[],a=[];c.forEach((function(e,t){e.success?n.push(e):a.push(e)})),te((function(e){return e.map((function(e){var t=c.find((function(t){return t._id===e._id}));return t?Object(s.a)(Object(s.a)({},e),{},{fbMarketId:t.fbMarketId}):e}))})),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsx)("div",{children:0===a.length?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.C,{}),Object(x.jsxs)("h4",{children:[n.length," products has been added."]})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.i,{}),Object(x.jsxs)("h4",{children:[a.length," products failed."]})]})})]}))}else fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products to Facebook Marketplace."})]})]}))})).catch((function(e){console.log(e),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products to Facebook Marketplace. Make sure you're online."})]})]}))}))},ge=function(e){fetch("/api/removeFromFbMarket",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e,access_token:d.p.get("facebook_user_accessToken")})}).then((function(e){return e.json()})).then((function(e){var t=e.code,c=e.fb_products;if("ok"===t){var n=[],a=[];c.forEach((function(e,t){e.success?n.push(e):a.push(e)})),te((function(e){return e.map((function(e){var t=c.find((function(t){return t._id===e._id}));return t?Object(s.a)(Object(s.a)({},e),{},{fbMarketId:t.fbMarketId}):e}))})),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsx)("div",{children:0===a.length?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.C,{}),Object(x.jsxs)("h4",{children:[n.length," products has been removed."]})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.i,{}),Object(x.jsxs)("h4",{children:[a.length," products failed to remove."]})]})})]}))}else fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not remove products from Facebook Marketplace."})]})]}))})).catch((function(e){console.log(e),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not remove products from Facebook Marketplace. Make sure you're online."})]})]}))}))};return Object(o.useEffect)((function(){var e,t=Object(d.L)({time:null===J||void 0===J?void 0:J.startDate,format:"YYYY-MM-DD"}),c=Object(d.L)({time:null===(e=new Date(null===J||void 0===J?void 0:J.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/products?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},q&&{q:q}),{},{page:C,perPage:F,sort:G.column,order:G.order},J&&{dateFrom:t,dateTo:c}),A&&{category:A}),Z&&{type:Z})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(te(e.products),g(e.total))})).catch((function(e){console.log(e),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get products."})]})]}))}))}),[A,q,C,F,Z,ue,J]),Object(o.useEffect)((function(){se||oe([])}),[se]),Object(o.useEffect)((function(){0===le.length&&ae(!1)}),[le]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"benner",children:[Object(x.jsx)("p",{children:"Product Management"}),i?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("button",{className:"pill",onClick:function(){return f(!0)},children:[Object(x.jsx)(d.v,{})," Add Product"]}),Object(x.jsxs)("button",{className:"pill batchUpload",onClick:function(){return be(!0)},children:[Object(x.jsx)(d.v,{})," Batch Upload"]})]}):Object(x.jsx)(h.b,{to:"/account/myShop/settings",className:"err",children:Object(x.jsx)("p",{children:"Please complete your shop information to add product."})})]}),Object(x.jsxs)("div",{className:"filters",children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Total:"}),v]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Per Page:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return P(e.value)}})]}),Object(x.jsxs)("section",{className:"search",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(x.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(x.jsx)("input",{value:q,onChange:function(e){return B(e.target.value)},placeholder:"Search for products & services"}),q&&Object(x.jsx)("button",{onClick:function(){return B("")},children:Object(x.jsx)(d.H,{})})]}),Object(x.jsxs)("section",{className:"type",children:[Object(x.jsx)("label",{children:"Type:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Product",value:"product"},{label:"Service",value:"service"},{label:"Other",value:"other"}],onChange:function(e){return Q(e.value)}})]}),Object(x.jsxs)("section",{className:"category",children:[Object(x.jsx)("label",{children:"Category:"}),Object(x.jsx)(d.h,{defaultValue:0,options:[{label:"All",value:""}].concat(Object(n.a)(c.map((function(e){return{label:e,value:e}})))),onChange:function(e){return w(e.value)}})]}),Object(x.jsx)("section",{className:"date",children:Object(x.jsx)(d.o,{dateRange:J,onChange:function(e){return K(e)}})})]}),Object(x.jsxs)("table",{className:"table products",children:[Object(x.jsx)("thead",{children:le.length>0?Object(x.jsxs)("tr",{className:"batchAction",children:[Object(x.jsx)("th",{className:"checkContainer",children:Object(x.jsx)(d.f,{value:se,defaultValue:se,onChange:function(e){return ae(e)}})}),Object(x.jsx)("th",{children:Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Batch delete",question:"You sure you want to delete these ".concat(le.length," items?"),callback:me})},children:"Delete"})}),(null===(t=r.fbMarket)||void 0===t?void 0:t.userAgreement)&&d.p.get("facebook_user_accessToken")&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("th",{children:Object(x.jsx)("button",{onClick:function(){ve(le),oe([])},children:"Add to Facebook"})}),Object(x.jsx)("th",{children:Object(x.jsx)("button",{onClick:function(){ge(le),oe([])},children:"Remove from Facebook"})})]})]}):Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"checkContainer",children:Object(x.jsx)(d.f,{value:se,defaultValue:se,onChange:function(e){return ae(e)}})}),Object(x.jsx)("th",{className:"date",children:"Date"}),Object(x.jsx)("th",{children:"Image"}),Object(x.jsx)("th",{className:"name",children:"Name"}),Object(x.jsx)("th",{children:"Type"}),Object(x.jsx)("th",{children:"Facebook Marketplace"}),Object(x.jsx)("th",{children:"Available"}),Object(x.jsx)("th",{children:"Price"}),Object(x.jsx)("th",{children:"GST"}),Object(x.jsx)("th",{children:"Discount"}),Object(x.jsx)("th",{children:"Listing Price"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[ee.map((function(e){return Object(x.jsx)(E,{categories:c,product:e,setProducts:te,selectAll:se,setBatch:oe,batch:le,deleteItems:pe,addToFbMarket:ve,removeFromFbMarket:ge},e._id)})),0===ee.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No product yet."})})]})]}),Object(x.jsx)(d.u,{total:v,btns:5,currentPage:C,perPage:F,setPage:N}),Object(x.jsx)(u.Modal,{className:"msg",open:xe,children:xe}),Object(x.jsx)(u.Modal,{head:!0,label:"Edit Product/Service",setOpen:f,open:O,className:"productForm",children:Object(x.jsx)(Y,{categories:c,onSuccess:function(e){te((function(t){return[].concat(Object(n.a)(t),[e])})),f(!1),fe(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return fe(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Product added."})]})]}))}})}),Object(x.jsx)(u.Modal,{open:ue,head:!0,label:"Batch product upload",setOpen:be,className:"batchItemPreview",children:Object(x.jsx)(R,{categories:c,onSuccess:function(){be(!1)}})})]})},E=function(e){var t,c,s,i,r=e.product,l=e.setProducts,b=e.categories,O=e.selectAll,f=e.setBatch,p=e.batch,m=e.deleteItems,v=e.addToFbMarket,g=e.removeFromFbMarket,k=Object(o.useContext)(j.d).user,y=Object(o.useState)(O||!1),C=Object(a.a)(y,2),N=C[0],M=C[1],S=Object(o.useState)(!1),F=Object(a.a)(S,2),P=F[0],_=F[1],D=Object(o.useState)(!1),A=Object(a.a)(D,2),w=A[0],T=A[1];return Object(o.useEffect)((function(){M(O)}),[O]),Object(o.useEffect)((function(){f(N?function(e){return[].concat(Object(n.a)(e),[r._id])}:function(e){return e.filter((function(e){return e!==r._id}))})}),[N]),Object(x.jsxs)("tr",{className:"product ".concat(N?"selected":""),children:[Object(x.jsx)("td",{className:"checkContainer",children:Object(x.jsx)(d.f,{defaultValue:N,value:N,onChange:function(e){M(e)}})}),Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD-MM-YY",children:r.createdAt})}),Object(x.jsx)("td",{className:"thumbs",children:Object(x.jsx)(d.q,{links:r.images})}),Object(x.jsx)("td",{className:"name",children:r.name}),Object(x.jsx)("td",{children:r.type}),Object(x.jsx)("td",{children:r.fbMarketId?"Added":"N/A"}),Object(x.jsxs)("td",{children:[r.available," ",!0===r.available&&"Available",!1===r.available&&"Unavailable"]}),Object(x.jsxs)("td",{children:["\u20b9",r.price]}),Object(x.jsx)("td",{children:(null===(t=k.gst)||void 0===t?void 0:t.verified)?(r.gst||(null===(c=k.gst)||void 0===c?void 0:c.amount)||0)+"%":"N/A"}),Object(x.jsxs)("td",{children:["\u20b9",Object(d.J)(r)||0]}),Object(x.jsxs)("td",{children:["\u20b9",Object(d.K)({product:r,gst:k.gst})||0]}),Object(x.jsx)("td",{children:0===p.length&&Object(x.jsxs)(d.a,{icon:Object(x.jsx)(d.g,{}),children:[Object(x.jsx)(h.b,{to:"/marketplace/".concat(r._id),target:"_blank",children:"View"}),(null===(s=k.fbMarket)||void 0===s?void 0:s.userAgreement)&&Object(x.jsx)(x.Fragment,{children:r.fbMarketId?Object(x.jsx)("button",{onClick:function(){return g([r._id])},children:"Remove from Facebook"}):Object(x.jsx)("button",{onClick:function(){return v([r._id])},children:"Add to Facebook"})}),!(null===(i=k.fbMarket)||void 0===i?void 0:i.userAgreement)&&Object(x.jsx)(h.b,{to:"/account/myShop/fbMarketplace",className:"edit",children:"Setup FB Marketplace"}),Object(x.jsx)(h.b,{to:"#",className:"edit",onClick:function(){return _(!0)},children:"Edit"}),Object(x.jsx)(h.b,{to:"#",className:"delete",onClick:function(){return Object(u.Confirm)({label:"Removing Product",question:"You sure want to delete this product?",callback:function(){return m([r._id])}})},children:"Delete"})]})}),Object(x.jsx)(u.Modal,{head:!0,label:"Edit Product/Service",open:P,setOpen:_,className:"productForm",children:Object(x.jsx)(Y,{categories:b,onSuccess:function(e){l((function(t){return t.map((function(t){return t._id===e._id?e:t}))})),_(!1),T(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return T(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.C,{}),Object(x.jsx)("h4",{children:"Product updated."})]})]}))},prefill:r})}),Object(x.jsx)(u.Modal,{className:"msg",open:w,children:w})]})},R=function(e){var t=e.onSuccess,i=e.categories,j=Object(o.useState)(!1),b=Object(a.a)(j,2),h=b[0],O=b[1],f=Object(o.useState)(1),p=Object(a.a)(f,2),m=p[0],v=p[1],g=Object(o.useState)(null),k=Object(a.a)(g,2),y=k[0],C=k[1],N=Object(o.useState)([]),M=Object(a.a)(N,2),S=M[0],F=M[1],_=Object(o.useState)(null),D=Object(a.a)(_,2),A=D[0],w=D[1],T=Object(o.useState)(""),Y=Object(a.a)(T,2),q=Y[0],E=Y[1],R=Object(o.useState)(null),B=Object(a.a)(R,2),U=B[0],V=B[1],G=function(){O(!0),fetch("/api/updateDraft",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:y})}).then((function(e){return e.json()})).then((function(e){var c=e.code,n=e.updated;O(!1),w("ok"===c?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){w(null),null===t||void 0===t||t()},children:"Okay"}),Object(x.jsxs)("div",{children:[n?Object(x.jsx)(d.C,{}):Object(x.jsx)(d.i,{}),Object(x.jsxs)("h4",{children:[n," items has been updated."]})]})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products. Try again."})]})]}))})).catch((function(e){O(!1),console.log(e),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))}))},H=function(){var e=Object(l.a)(r.a.mark((function e(t){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O(!0),e.next=4,Object(d.F)({files:S,setMsg:w});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:if((c=e.t0).length===S.length){e.next=11;break}return w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upload images. Please try again."})]})]})),e.abrupt("return");case 11:fetch("/api/uploadProductImg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:c,category:q})}).then((function(e){return e.json()})).then((function(e){if("ok"===e.code){var t=Object.entries({Images:"images",id:"_id",Name:"name",Description:"dscr",Material:"material","Size [Please specify mm, cm, inch or KG]":"size",Category:"category",Type:"type","Price in INR.":"price","Units Available":"available","HSN Code":"hsn","GST %":"gst"}).map((function(e){var t=Object(a.a)(e,2);return{label:t[0],key:t[1]}}));V({headers:t,data:e.products,filename:"Delivery Pay Product Draft.csv"})}else w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))})).catch((function(e){O(!1),console.log(e),w(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return w(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"content",children:[Object(x.jsx)(P,{label:"Create Draft",className:"createDraft",defaultStatus:1===m,data:U,children:Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("form",{onSubmit:H,children:[Object(x.jsxs)("section",{className:"category",children:[Object(x.jsx)("label",{children:"Choose category"}),Object(x.jsx)(d.h,{options:i.map((function(e){return{label:e,value:e.toLowerCase()}})),required:!0,onChange:function(e){return E(e.value)}})]}),Object(x.jsxs)("p",{children:["Choose images"," ",Object(x.jsx)("span",{children:"Choose 1 image for each product. you can add multiple images later."})]}),Object(x.jsx)(d.k,{onChange:function(e){return F(e)},multiple:!0}),Object(x.jsxs)("section",{className:"btns",children:[Object(x.jsx)("button",{className:"clean",type:"button",onClick:function(){return v(3)},children:"Already have a draft"}),U?Object(x.jsx)(I.CSVLink,Object(s.a)(Object(s.a)({},U),{},{className:"submit",type:"submit",onClick:function(){V(null),v(2)},children:"Download Draft"})):Object(x.jsx)("button",{className:"submit",children:"Create Draft"})]})]})})}),Object(x.jsxs)(P,{label:"Populate With data",defaultStatus:2===m,children:[Object(x.jsx)("p",{children:"Populate the Sheet with real product data. Don't Change the header."}),Object(x.jsx)("button",{className:"submit",onClick:function(){return v(3)},children:"Next"})]}),Object(x.jsxs)(P,{label:"Upload Draft",defaultStatus:3===m,children:[!!(null===y||void 0===y?void 0:y.length)&&Object(x.jsxs)("table",{className:"table",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Type"}),Object(x.jsx)("th",{children:"Images"}),Object(x.jsx)("th",{className:"name",children:"Name"}),Object(x.jsx)("th",{className:"dscr",children:"Description"}),Object(x.jsx)("th",{children:"Available"}),Object(x.jsx)("th",{children:"Price"}),Object(x.jsx)("th",{children:"GST"}),Object(x.jsx)("th",{children:"Action"})]})}),Object(x.jsx)("tbody",{children:null===y||void 0===y?void 0:y.map((function(e,t){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:e.type}),Object(x.jsx)("td",{className:"thumbs",children:Object(x.jsx)(d.q,{links:e.images})}),Object(x.jsx)("td",{className:"name",children:e.name}),Object(x.jsx)("td",{className:"dscr",children:e.dscr}),Object(x.jsxs)("td",{children:[e.available,!0===e.available&&"Available",!1===e.available&&"Unavailable"]}),Object(x.jsx)("td",{children:e.price}),Object(x.jsx)("td",{children:e.gst}),Object(x.jsx)("td",{children:Object(x.jsx)("button",{className:"remove",onClick:function(){return C((function(e){var c=Object(n.a)(e);return c.splice(t,1),c}))},children:Object(x.jsx)(d.H,{})})})]},t)}))})]}),!(null===y||void 0===y?void 0:y.length)&&Object(x.jsxs)("div",{className:"uploadFile",children:[Object(x.jsxs)("p",{children:["Upload xlsx/csv file in. See the example file"," ",Object(x.jsx)("a",{href:"/batch_product_upload_xlsx_file_example.csv",target:"_blank",children:"here"}),"."]}),Object(x.jsx)("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:function(e){e.target.files[0]&&function(e,t){e.name;var n=new FileReader;n.onload=function(){var e=Object(l.a)(r.a.mark((function e(n){var s,a,i,l,o,j,d,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.target.result,e.next=3,Promise.all([c.e(26),c.e(27)]).then(c.t.bind(null,281,7));case 3:a=e.sent,i=a.read(s,{type:"binary"}),l=i.SheetNames[0],o=i.Sheets[l],j=a.utils.sheet_to_json(o,{header:1}),d=[],u=j.shift(),j.forEach((function(e,t){var c={};u.forEach((function(t,n){var s;switch(t){case"Images":s="images";break;case"Name":s="name";break;case"Description":s="dscr";break;case"Material":s="material";break;case"Size [Please specify mm, cm, inch or KG]":s="size";break;case"Category":s="category";break;case"Type":s="type";break;case"Price in INR.":s="price";break;case"Units Available":s="available";break;case"HSN Code":s="hsn";break;case"GST %":s="gst";break;case"id":s="_id"}c[s]=e[n]})),d.push(c)})),t(d);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(e)}(e.target.files[0],(function(e){(null===e||void 0===e?void 0:e.length)&&C(e.filter((function(e){return e.type&&e.category&&e.name&&e.dscr&&void 0!==e.price})).map((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"",images:e.images.split(/,( |\n)/).filter((function(e){return e.trim()}))})})))})),e.target.value=null}})]}),!!(null===y||void 0===y?void 0:y.length)&&Object(x.jsx)("button",{className:"submit",onClick:function(){return Object(u.Confirm)({label:"Adding Batch products",question:"You sure want to add all these items?",callback:G})},children:"Add"})]}),h&&Object(x.jsx)("div",{className:"spinnerContainer",children:Object(x.jsx)("div",{className:"spinner"})}),Object(x.jsx)(u.Modal,{className:"msg",open:A,children:A})]})},B=["Buyer will be responsible for paying for shipping costs & for returning the item.","Shipping costs are nonrefundable.","Orders must be returned with Original Packaging & Securely.","Orders must be Returned Via Trackable / Traceable Courier Services Only.","Proof of Return via Photo of Tracking Number & Dispatch Ticket is Required.","Refund is Only Issued Upon Delivery of Return Package."],U=function(e){var t,c,n,s,i,r,l,b,h,O,f,p,m,v,g,k,y,C,N,M,S,F,P,_,D,A,w,T,I,Y,q,E,R,B,U,J,K,W,z,Z=e.categories,Q=e.setCategories,$=Object(o.useContext)(j.d),X=$.user,ee=($.setUser,Object(o.useState)(!1)),te=Object(a.a)(ee,2),ce=te[0],ne=te[1],se=Object(o.useState)(!1),ae=Object(a.a)(se,2),ie=ae[0],re=ae[1],le=Object(o.useState)(),oe=Object(a.a)(le,2),je=oe[0],de=oe[1],ue=Object(o.useState)(!1),be=Object(a.a)(ue,2),he=be[0],Oe=be[1],xe=Object(o.useState)(null),fe=Object(a.a)(xe,2),pe=fe[0],me=fe[1];return Object(x.jsxs)("div",{className:"settings",children:[Object(x.jsxs)("div",{className:"caution",children:[!(null===Z||void 0===Z?void 0:Z.length)&&Object(x.jsx)("p",{className:"err",children:"Add at least 1 category."}),!(null===(t=X.shopInfo)||void 0===t||null===(c=t.terms)||void 0===c?void 0:c.length)&&Object(x.jsx)("p",{className:"err",children:"Add Return policy terms"}),(void 0===(null===(n=X.shopInfo)||void 0===n?void 0:n.shippingCost)||null===(null===(s=X.shopInfo)||void 0===s?void 0:s.shippingCost)||void 0===(null===(i=X.shopInfo)||void 0===i?void 0:i.deliveryWithin)||null===(null===(r=X.shopInfo)||void 0===r?void 0:r.deliveryWithin)||void 0===(null===(l=X.shopInfo)||void 0===l?void 0:l.refundable))&&Object(x.jsx)("p",{className:"err",children:"Add Shipping & Delivery detail"}),Object.values((null===(b=X.shopInfo)||void 0===b?void 0:b.paymentMethod)||{}).length<6&&Object(x.jsx)("p",{className:"err",children:"Add valid payment method"})]}),Object(x.jsxs)("div",{className:"cat",children:[Object(x.jsx)("h2",{className:"head",children:"Categories"}),Object(x.jsxs)("ul",{className:"categories",children:[Z.map((function(e,t){return Object(x.jsxs)("li",{children:[e," ",Object(x.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Remove Category",question:"You sure want to remove this category?",callback:function(){fetch("/api/categories",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?Q((function(t){return t.filter((function(t){return t!==e}))})):me(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not delete category. Try again."})]})]}))})).catch((function(e){console.log(e),me(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not delete category. Make sure you're online."})]})]}))}))}})},children:Object(x.jsx)(d.H,{})})]},t)})),0===Z.length&&Object(x.jsx)("li",{className:"placeholder",children:"No category found."})]}),Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.querySelector("input");fetch("/api/addCategory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:t.value})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(Q(e.categories),t.value=""):me(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add category. Try again."})]})]}))})).catch((function(e){console.log(e),me(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not add category. Make sure you're online."})]})]}))}))},children:[Object(x.jsx)("input",{type:"text",required:!0,placeholder:"New Category. ie Mobile"}),Object(x.jsx)("button",{children:"Add category"})]})]}),Object(x.jsxs)("div",{className:"gst",children:[Object(x.jsxs)("h2",{className:"head",children:["GST"," ",!ce&&Object(x.jsx)("button",{onClick:function(){return ne(!0)},children:"Edit"})]}),Object(x.jsxs)("p",{className:"status",children:["Status:"," ",Object(x.jsx)("strong",{children:(null===(h=X.gst)||void 0===h?void 0:h.verified)?"Verified":"Unverified"})]}),ce?Object(x.jsx)(V,{setOpen:ne,setMsg:me}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:["GST Registration number: ",(null===(O=X.gst)||void 0===O||null===(f=O.detail)||void 0===f?void 0:f.reg)||"N/A"]}),Object(x.jsxs)("p",{children:["GST amount: ",(null===(p=X.gst)||void 0===p?void 0:p.amount)?X.gst.amount+"%":"N/A"]}),Object(x.jsxs)("p",{children:["Files for verification:"," ",!(null===(m=X.gst)||void 0===m||null===(v=m.detail)||void 0===v||null===(g=v.files)||void 0===g?void 0:g.length)&&"N/A"]}),(null===(k=X.gst)||void 0===k||null===(y=k.detail)||void 0===y||null===(C=y.files)||void 0===C?void 0:C.length)&&Object(x.jsx)("ul",{className:"thumbs",children:Object(x.jsx)(d.q,{links:null===(N=X.gst)||void 0===N||null===(M=N.detail)||void 0===M?void 0:M.files})})]}),!(null===(S=X.gst)||void 0===S?void 0:S.verified)&&Object(x.jsx)("p",{className:"note",children:"*GST will apply once we review and verify your GST registraion."})]}),Object(x.jsxs)("div",{className:"payment",children:[Object(x.jsxs)("h2",{className:"head",children:["Payment Method"," ",!he&&Object(x.jsx)("button",{onClick:function(){return Oe(!0)},children:"Edit"})]}),he?Object(x.jsx)(L,{prefill:null===(F=X.shopInfo)||void 0===F?void 0:F.paymentMethod,setOpen:Oe,setMsg:me}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:["Name: ",(null===(P=X.shopInfo)||void 0===P||null===(_=P.paymentMethod)||void 0===_?void 0:_.name)||"--"]}),Object(x.jsxs)("p",{children:["Bank: ",(null===(D=X.shopInfo)||void 0===D||null===(A=D.paymentMethod)||void 0===A?void 0:A.bank)||"--"]}),Object(x.jsxs)("p",{children:["City: ",(null===(w=X.shopInfo)||void 0===w||null===(T=w.paymentMethod)||void 0===T?void 0:T.city)||"--"]}),Object(x.jsxs)("p",{children:["Account type: ",(null===(I=X.shopInfo)||void 0===I||null===(Y=I.paymentMethod)||void 0===Y?void 0:Y.accountType)||"--"]}),Object(x.jsxs)("p",{children:["Account Number:"," ",(null===(q=X.shopInfo)||void 0===q||null===(E=q.paymentMethod)||void 0===E?void 0:E.accountNumber)||"--"]}),Object(x.jsxs)("p",{children:["ifsc: ",(null===(R=X.shopInfo)||void 0===R||null===(B=R.paymentMethod)||void 0===B?void 0:B.ifsc)||"--"]})]})]}),Object(x.jsxs)("div",{className:"terms shipping",children:[Object(x.jsxs)("h2",{className:"head",children:["Shipping & Delivery"," ",!ie&&Object(x.jsx)("button",{onClick:function(){return re(!0)},children:"Edit"})]}),ie?Object(x.jsx)(G,{setOpen:re,setMsg:me}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:["Shipping cost:"," ",(null===(U=X.shopInfo)||void 0===U?void 0:U.shippingCost)?"\u20b9"+(null===(J=X.shopInfo)||void 0===J?void 0:J.shippingCost):"N/A"]}),Object(x.jsxs)("p",{children:["Delivery within (days): ",(null===(K=X.shopInfo)||void 0===K?void 0:K.deliveryWithin)||"N/A"]}),Object(x.jsxs)("p",{children:["Refundable: ",(null===(W=X.shopInfo)||void 0===W||null===(z=W.refundable)||void 0===z?void 0:z.toString())||"N/A"]})]})]}),Object(x.jsxs)("div",{className:"terms return",children:[Object(x.jsxs)("h2",{className:"head",children:["Return Policy Terms"," ",!je&&Object(x.jsx)("button",{onClick:function(){return de(!0)},children:"Edit"})]}),Object(x.jsx)(H,{setOpen:de,termsEdit:je,setMsg:me})]}),Object(x.jsx)(u.Modal,{className:"msg",open:pe,children:pe})]})},V=function(e){var t,c,n,i,u,b,h,O=e.setOpen,f=e.setMsg,p=Object(o.useContext)(j.d),m=p.user,v=p.setUser,g=Object(o.useState)(!1),k=Object(a.a)(g,2),y=(k[0],k[1]),C=Object(o.useState)([]),N=Object(a.a)(C,2),M=N[0],S=N[1],P=Object(o.useState)(null===(t=m.gst)||void 0===t||null===(c=t.detail)||void 0===c?void 0:c.reg),_=Object(a.a)(P,2),D=_[0],A=_[1],w=Object(o.useState)(null===(n=m.gst)||void 0===n?void 0:n.amount),T=Object(a.a)(w,2),I=T[0],Y=T[1],q=function(){var e=Object(l.a)(r.a.mark((function e(t){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),y(!0),e.next=4,Object(d.F)({files:M,setMsg:f});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:c=e.t0,Object(F.updateProfileInfo)({"gst.detail.files":c,"gst.detail.reg":D,"gst.amount":I}).then((function(e){var t=e.user;y(!1),t&&(v((function(e){return Object(s.a)(Object(s.a)({},e),{},{gst:t.gst})})),O(!1))})).catch((function(e){y(!1),console.log(e),f(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return f(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upadte GST Information. Make sure you're online"})]})]}))}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("form",{onSubmit:q,children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"GST Registration Nubmer"}),Object(x.jsx)("input",{required:!0,type:"text",defaultValue:null===(i=m.gst)||void 0===i?void 0:i.detail.reg,name:"gst.detail.reg",onChange:function(e){return A(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"GST percentage (%)"}),Object(x.jsx)(d.t,{required:!0,defaultValue:null===(u=m.gst)||void 0===u?void 0:u.amount,name:"gst.detail.reg",onChange:function(e){return Y(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Upload files for verification"}),Object(x.jsx)(d.k,{multiple:!0,prefill:null===(b=m.gst)||void 0===b||null===(h=b.detail)||void 0===h?void 0:h.files,name:"gst.detail.files",onChange:function(e){return S(e)}})]}),Object(x.jsxs)("section",{className:"btns",children:[Object(x.jsx)("button",{children:"Save Changes"}),Object(x.jsx)("button",{type:"button",onClick:function(){return O(!1)},children:"Cancel"})]})]})},G=function(e){var t,c,n,i=e.setOpen,r=e.setMsg,l=Object(o.useContext)(j.d),u=l.user,b=l.setUser,h=Object(o.useState)((null===(t=u.shopInfo)||void 0===t?void 0:t.shippingCost)||0),O=Object(a.a)(h,2),f=O[0],p=O[1],m=Object(o.useState)(null===(c=u.shopInfo)||void 0===c?void 0:c.deliveryWithin),v=Object(a.a)(m,2),g=v[0],k=v[1],y=Object(o.useState)((null===(n=u.shopInfo)||void 0===n?void 0:n.refundable)||null),C=Object(a.a)(y,2),N=C[0],M=C[1];return Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.shippingCost":f,"shopInfo.deliveryWithin":g,"shopInfo.refundable":N}).then((function(e){var t=e.user;t&&(b((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:t.shopInfo})})),i(!1))})).catch((function(e){console.log(e),r(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return r(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upadte Terms. Make sure you're online"})]})]}))}))},children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Shipping Cost \u20b9"}),Object(x.jsx)(d.t,{required:!0,defaultValue:f,name:"shippingCost",onChange:function(e){return p(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Delivery Within (days)"}),Object(x.jsx)(d.t,{required:!0,defaultValue:g,name:"deliveryWithin",min:1,step:"0",placeholder:"ie. 4 Days",onChange:function(e){return k(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Refundable"}),Object(x.jsx)(d.h,{required:!0,defaultValue:0,onChange:function(e){return M(e.value)},options:[{label:"No",value:null},{label:"Upto 24 Hours After Delivery",value:"Upto 24 Hours After Delivery"},{label:"Upto 7 Days After Delivery",value:"Upto 7 Days After Delivery"},{label:"Upto 15 Days After Delivery",value:"Upto 15 Days After Delivery"}]})]}),Object(x.jsxs)("section",{className:"btns",children:[Object(x.jsx)("button",{children:"Save Changes"}),Object(x.jsx)("button",{type:"button",onClick:function(){return i(!1)},children:"Cancel"})]})]})},H=function(e){var t,c=e.setOpen,i=e.termsEdit,r=e.setMsg,l=Object(o.useContext)(j.d),u=l.user,b=l.setUser,h=Object(o.useState)((null===(t=u.shopInfo)||void 0===t?void 0:t.terms)||[]),f=Object(a.a)(h,2),p=f[0],m=f[1],v=Object(o.useState)(""),g=Object(a.a)(v,2),k=g[0],y=g[1];return Object(o.useEffect)((function(){var e;i?0===p.length&&m(B):m((null===(e=u.shopInfo)||void 0===e?void 0:e.terms)||[])}),[i]),Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.terms":p}).then((function(e){var t,n=e.user;n&&(b((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:n.shopInfo})})),c(!1),m(null===(t=n.shopInfo)||void 0===t?void 0:t.terms))})).catch((function(e){console.log(e),r(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return r(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not upadte Terms. Make sure you're online"})]})]}))}))},children:[Object(x.jsxs)("ul",{children:[p.map((function(e,t){return Object(x.jsxs)("li",{children:[e," ",i&&Object(x.jsx)("button",{type:"button",onClick:function(){return m((function(t){return t.filter((function(t){return t!==e}))}))},children:Object(x.jsx)(d.H,{})})]},t)})),0===p.length&&Object(x.jsx)("li",{children:"No terms has been added."})]}),i&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("section",{className:"addTerm",children:[Object(x.jsx)(O.a,{value:k,placeholder:"Add auditional term",onChange:function(e){return y(e.target.value)}}),Object(x.jsx)("button",{type:"button",onClick:function(){m((function(e){return k?[].concat(Object(n.a)(e.filter((function(e){return e!==k}))),[k]):e})),y("")},children:"Add Term"})]}),Object(x.jsxs)("section",{className:"btns",children:[Object(x.jsx)("button",{children:"Save Changes"}),Object(x.jsx)("button",{type:"button",onClick:function(){var e,t;c(!1),m((null===(e=u.shopInfo)||void 0===e||null===(t=e.terms)||void 0===t?void 0:t.length)?u.shopInfo.terms:B)},children:"Cancel"})]})]})]})},L=function(e){var t=e.prefill,c=(e.onSuccess,e.setMsg),n=e.setOpen,i=Object(o.useContext)(j.d).setUser,r=Object(o.useState)((null===t||void 0===t?void 0:t.bank)||""),l=Object(a.a)(r,2),u=l[0],b=l[1],h=Object(o.useState)((null===t||void 0===t?void 0:t.name)||""),O=Object(a.a)(h,2),f=O[0],p=O[1],m=Object(o.useState)((null===t||void 0===t?void 0:t.ifsc)||""),v=Object(a.a)(m,2),g=v[0],k=v[1],y=Object(o.useState)((null===t||void 0===t?void 0:t.city)||""),C=Object(a.a)(y,2),N=C[0],M=C[1],S=Object(o.useState)((null===t||void 0===t?void 0:t.accountType)||""),P=Object(a.a)(S,2),_=P[0],D=P[1],A=Object(o.useState)((null===t||void 0===t?void 0:t.accountNumber)||""),w=Object(a.a)(A,2),T=w[0],I=w[1];return Object(x.jsxs)("form",{className:"paymentMethodForm netBanking",onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.paymentMethod":{name:f,bank:u,city:N,accountType:_,ifsc:g,accountNumber:T}}).then((function(e){var t=e.user;t?(i((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:t.shopInfo})})),n(!1)):c(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return c(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not update payment method. Please try again."})]})]}))})).catch((function(e){console.log(e),c(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return c(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not updated payment method. Make sure you're online."})]})]}))}))},children:[Object(x.jsxs)("section",{className:"inputs",children:[Object(x.jsx)("input",{type:"text",name:"name",placeholder:"Full name",value:f,onChange:function(e){return p(e.target.value)},required:!0}),Object(x.jsx)("input",{type:"text",name:"bank",placeholder:"Bank",value:u,onChange:function(e){return b(e.target.value)},required:!0}),Object(x.jsx)("input",{type:"text",name:"city",placeholder:"City",value:N,onChange:function(e){return M(e.target.value)},required:!0}),Object(x.jsx)("input",{type:"text",name:"type",placeholder:"Account type ie. Savings / Current",value:_,onChange:function(e){return D(e.target.value)},required:!0}),Object(x.jsx)("input",{type:"text",name:"accountNumber",placeholder:"Account Number",value:T,onChange:function(e){return I(e.target.value)},required:!0}),Object(x.jsx)("input",{type:"text",name:"ifsc",placeholder:"IFSC",value:g,onChange:function(e){return k(e.target.value)},required:!0})]}),Object(x.jsxs)("section",{className:"btns",children:[Object(x.jsx)("button",{type:"submit",children:"Save Changes"}),Object(x.jsx)("button",{type:"button",onClick:function(){return n(!1)},children:"Cancel"})]})]})};t.default=function(e){e.history,e.location,e.match;var t=Object(o.useContext)(j.d),c=t.user,n=t.userType,s=window.FB,i=Object(o.useState)(null),r=Object(a.a)(i,2),l=r[0],h=(r[1],Object(o.useState)([])),O=Object(a.a)(h,2),f=O[0],p=O[1],v=Object(o.useState)(!1),k=Object(a.a)(v,2),y=k[0],M=k[1];return Object(o.useEffect)((function(){fetch("/api/categories").then((function(e){return e.json()})).then((function(e){p(e.categories)}))}),[]),Object(o.useEffect)((function(){var e,t,n,s,a,i,r,l;!(null===f||void 0===f?void 0:f.length)||!(null===(e=c.shopInfo)||void 0===e||null===(t=e.terms)||void 0===t?void 0:t.length)||void 0===(null===(n=c.shopInfo)||void 0===n?void 0:n.shippingCost)||null===(null===(s=c.shopInfo)||void 0===s?void 0:s.shippingCost)||void 0===(null===(a=c.shopInfo)||void 0===a?void 0:a.deliveryWithin)||null===(null===(i=c.shopInfo)||void 0===i?void 0:i.deliveryWithin)||void 0===(null===(r=c.shopInfo)||void 0===r?void 0:r.refundable)||Object.values((null===(l=c.shopInfo)||void 0===l?void 0:l.paymentMethod)||{}).length<6?M(!1):M(!0)}),[f,c]),Object(o.useEffect)((function(){var e,t;s.getLoginStatus((function(e){if(console.log(e),"connected"===e.status){var t=e.authResponse.accessToken;d.p.set("facebook_user_accessToken",t)}})),(null===(e=c.fbMarket)||void 0===e||null===(t=e.facebookPage)||void 0===t?void 0:t.access_token)&&d.p.set("facebook_page_accessToken",c.fbMarket.facebookPage.access_token)}),[c]),Object(x.jsxs)(x.Fragment,{children:["buyer"===n&&Object(x.jsx)(b.a,{to:"/account/orders/current"}),Object(x.jsxs)("div",{className:"myShop",children:[Object(x.jsx)("div",{style:{display:"none"},children:Object(x.jsx)(d.H,{})}),Object(x.jsx)(d.D,{basepath:"/account/myShop/",tabs:[{label:"Products & Services",path:"products"},{label:"Orders",path:"orders"},{label:"Refunds",path:"refunds"},{label:"Campaigns",path:"campaigns"},{label:"FB Marketplace",path:"fbMarketplace"},{label:"Settings",path:"settings"}]}),Object(x.jsxs)(b.d,{children:[Object(x.jsx)(b.b,{path:"/account/myShop/products",children:Object(x.jsx)(q,{categories:f,shopSetupComplete:y})}),Object(x.jsx)(b.b,{path:"/account/myShop/orders/:_id",component:m}),Object(x.jsx)(b.b,{path:"/account/myShop/orders",children:Object(x.jsx)(g,{categories:f})}),Object(x.jsx)(b.b,{path:"/account/myShop/refunds/:_id",component:C}),Object(x.jsx)(b.b,{path:"/account/myShop/refunds",component:N}),Object(x.jsx)(b.b,{path:"/account/myShop/campaigns",component:S}),Object(x.jsx)(b.b,{path:"/account/myShop/fbMarketplace",component:T}),Object(x.jsx)(b.b,{path:"/account/myShop/settings",children:Object(x.jsx)(U,{categories:f,setCategories:p})})]}),Object(x.jsx)(u.Modal,{className:"msg",open:l,children:l})]})]})}},197:function(e,t,c){},250:function(e,t,c){},255:function(e,t,c){}}]);
//# sourceMappingURL=14.56eb7eeb.chunk.js.map