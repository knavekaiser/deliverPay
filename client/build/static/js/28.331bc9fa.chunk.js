(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[28],{175:function(e,t,c){"use strict";c.r(t),c.d(t,"Orders",(function(){return f})),c.d(t,"FullOrder",(function(){return g})),c.d(t,"Disputes",(function(){return y})),c.d(t,"FullDispute",(function(){return D}));var n=c(14),s=c.n(n),i=c(16),l=c(13),r=c(4),j=c(3),a=c(1),d=c(2),o=c(6),b=c(5),u=c(8),O=c(7),h=c(25),x=c(0),m=Object(a.lazy)((function(){return Promise.resolve().then(c.bind(null,29)).then((function(e){return{default:e.MilestoneForm}}))})),f=function(e){var t=e.status,c=e.onClick,n=Object(a.useContext)(u.d),s=n.cart,i=n.userType,l=Object(a.useState)(0),b=Object(j.a)(l,2),h=b[0],m=b[1],f=Object(a.useState)(1),g=Object(j.a)(f,2),N=g[0],y=g[1],k=Object(a.useState)(20),D=Object(j.a)(k,2),C=D[0],S=(D[1],Object(a.useState)("")),M=Object(j.a)(S,2),Y=M[0],_=(M[1],Object(a.useState)("")),F=Object(j.a)(_,2),A=F[0],P=(F[1],Object(a.useState)(null)),w=Object(j.a)(P,2),T=w[0],R=(w[1],Object(a.useState)({column:"createdAt",order:"dsc"})),E=Object(j.a)(R,2),q=E[0],I=(E[1],Object(a.useState)([])),H=Object(j.a)(I,2),J=H[0],U=H[1],B=Object(a.useState)(!1),V=Object(j.a)(B,2),L=V[0],W=V[1],z=Object(a.useState)([]),G=Object(j.a)(z,2),Q=G[0],K=G[1],X=Object(a.useState)(null),Z=Object(j.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)([]),ce=Object(j.a)(te,2),ne=ce[0],se=ce[1];return Object(a.useEffect)((function(){var e,c=Object(d.N)({time:null===T||void 0===T?void 0:T.startDate,format:"YYYY-MM-DD"}),n=Object(d.N)({time:null===(e=new Date(null===T||void 0===T?void 0:T.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getOrders?".concat(new URLSearchParams(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({user:"buyer"},A&&{q:A}),{},{page:N,perPage:C,sort:q.column,order:q.order},T&&{dateFrom:c,dateTo:n}),Y&&{type:Y}),t&&{status:t})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(U(e.orders),m(e.total))})).catch((function(e){console.log(e),ee(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return ee(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[Y,A,N,C,T,t]),Object(a.useEffect)((function(){fetch("/api/getCartDetail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:s})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&se(e.carts)})).catch((function(e){console.log(e),ee(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return ee(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get cart detail. Make sure you're online."})]})]}))}))}),[s]),Object(a.useEffect)((function(){L||K([])}),[L]),Object(a.useEffect)((function(){0===Q.length&&W(!1)}),[Q]),Object(x.jsxs)(x.Fragment,{children:["seller"===i&&Object(x.jsx)(o.a,{to:"/account/myShop/orders"}),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"My Orders"})}),Q.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table orders",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Order"}),Object(x.jsx)("th",{className:"date",children:"Purchase Date"}),Object(x.jsx)("th",{children:"Total"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[J.map((function(e){return Object(x.jsx)(v,{onClick:c,order:e,setOrders:U,selectAll:L,setBatch:K,batch:Q},e._id)})),(null===t||void 0===t?void 0:t.includes("pending"))&&ne.map((function(e){return Object(x.jsx)(p,{order:e},e.seller._id)})),0===J.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No order yet."})})]})]}),Object(x.jsx)(d.u,{total:h,btns:5,currentPage:N,perPage:C,setPage:y}),Object(x.jsx)(O.Modal,{className:"msg",open:$,children:$})]})]})},p=function(e){var t,c=e.order,n=(e.setOrder,Object(a.useRef)()),s=Object(a.useRef)(),i=Object(o.g)(),l=+(c.products.reduce((function(e,t){return(e+Object(d.M)({product:t.product,gst:c.seller.gst})*t.qty).fix()}),0)+((null===(t=c.seller.shopInfo)||void 0===t?void 0:t.shippingCost)||0)).fix();return Object(x.jsxs)("tr",{className:"order",onClick:function(e){e.nativeEvent.path.includes(n.current)||e.nativeEvent.path.includes(s.current)||i.push("/account/cart")},children:[Object(x.jsx)("td",{children:"-"}),Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:new Date})}),Object(x.jsxs)("td",{children:["\u20b9",l]}),Object(x.jsx)("td",{children:"Draft"}),Object(x.jsx)("td",{ref:n,children:Object(x.jsx)(d.a,{icon:Object(x.jsx)(d.g,{}),children:Object(x.jsx)(b.b,{to:"/account/cart",children:"View Detail"})})})]})},v=function(e){var t=e.order,c=e.setOrders,n=e.selectAll,s=e.setBatch,i=e.batch,h=e.onClick,m=Object(a.useRef)(),f=Object(a.useRef)(),p=Object(o.g)(),v=(Object(a.useContext)(u.d).user,Object(a.useState)(n||!1)),g=Object(j.a)(v,2),N=g[0],y=g[1],k=Object(a.useState)(!1),D=Object(j.a)(k,2),C=(D[0],D[1],Object(a.useState)(!1)),S=Object(j.a)(C,2),M=S[0],Y=S[1],_=function(){fetch("/api/cancelOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(r.a)(Object(r.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))},F=function(){fetch("/api/requestCancellation",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?c((function(c){return c.map((function(c){var n;return c._id===t._id?Object(r.a)(Object(r.a)({},c),{},{status:null===(n=e.order)||void 0===n?void 0:n.status}):c}))})):Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),Y(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return Y(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))};return Object(a.useEffect)((function(){y(n)}),[n]),Object(a.useEffect)((function(){s(N?function(e){return[].concat(Object(l.a)(e),[t._id])}:function(e){return e.filter((function(e){return e!==t._id}))})}),[N]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"order ".concat(N?"selected":""),onClick:function(e){e.nativeEvent.path.includes(m.current)||e.nativeEvent.path.includes(f.current)||i.length>0||null===h||void 0===h||h(t._id)},children:[Object(x.jsx)("td",{children:t._id}),Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:t.createdAt})}),Object(x.jsxs)("td",{children:["\u20b9",t.total]}),Object(x.jsx)("td",{children:t.status}),Object(x.jsx)("td",{ref:m,children:0===i.length&&Object(x.jsxs)(d.a,{icon:Object(x.jsx)(d.g,{}),children:[Object(x.jsx)(b.b,{to:"".concat(p.location.pathname,"/").concat(t._id),children:"View Detail"}),"pending"===t.status&&Object(x.jsx)(b.b,{to:"#",onClick:function(e){Object(O.Confirm)({label:"Order Cancellation",question:"You sure want to cancel this order?",callback:_})},children:"Cancel order"}),"approved"===t.status&&Object(x.jsx)(b.b,{to:"#",onClick:function(e){Object(O.Confirm)({label:"Order Cancellation",question:"You sure want to request cancellation for this order?",callback:F})},children:"Request Cancellation"})]})})]}),Object(x.jsx)(O.Modal,{className:"msg",open:M,children:M})]})},g=function(e){var t=e.history,c=e.match,n=Object(a.useContext)(u.d).userType,s=Object(a.useState)(null),i=Object(j.a)(s,2),o=i[0],h=i[1],f=Object(a.useState)(null),p=Object(j.a)(f,2),v=p[0],g=p[1],y=Object(a.useState)(!1),k=Object(j.a)(y,2),D=k[0],C=k[1],S=Object(a.useState)(!1),M=Object(j.a)(S,2),Y=M[0],_=M[1],F=Object(a.useState)(!1),A=Object(j.a)(F,2),P=A[0],w=A[1];Object(a.useRef)();if(Object(a.useEffect)((function(){fetch("/api/singleOrder?_id=".concat(c.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?g(e.order):h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get order. Make sure you're online."})]})]}))}))}),[]),Object(a.useEffect)((function(){if("delivered"===(null===v||void 0===v?void 0:v.status)&&(null===v||void 0===v?void 0:v.refundable)){var e=0;switch(v.refundable){case"Upto 24 Hours After Delivery":e=1;break;case"Upto 7 Days After Delivery":e=7;break;case"Upto 15 Days After Delivery":e=15;break;default:return}var t=new Date((new Date).getTime()+864e5*e);new Date<t?_(t):_(null)}else _(null)}),[v]),v){var T,R,E,q,I,H,J=v.products.reduce((function(e,t){return(e+Object(d.M)({product:t.product,gst:!0})*t.qty).fix()}),0),U="percent"===(null===(T=v.coupon)||void 0===T?void 0:T.type)&&Math.min(J/100*v.coupon.amount,v.coupon.maxDiscount)||"flat"===(null===(R=v.coupon)||void 0===R?void 0:R.type)&&(null===(E=v.coupon)||void 0===E?void 0:E.amount)||0,B=((J-U+v.shippingCost)/100*v.fee).fix();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"actions",children:[Object(x.jsxs)(b.b,{to:"".concat(t.location.pathname.replace("/"+c.params._id,"")?t.location.pathname.replace("/"+c.params._id,""):"seller"===n?"/account/orders":"/account/orders/current"),className:"back",children:[Object(x.jsx)(d.c,{}),"Back"]}),Y&&Object(x.jsx)("button",{onClick:function(){return w(!0)},children:"Issue refund"})]}),Object(x.jsxs)("div",{className:"singleOrder",children:[Object(x.jsxs)("div",{className:"summery",children:[Object(x.jsx)("h3",{children:"Order Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Seller"}),Object(x.jsx)(d.I,{user:v.seller})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order ID"}),v._id]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status"}),v.status]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Order placed"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:v.createdAt})]}),"delivered"===v.status&&Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivered at"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:v.deliveredAt})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refundable"}),v.refundable||"N/A"]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Note"}),v.note]}),Y&&Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Refund till"}),Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mm a",children:Y})]}),Object(x.jsx)("li",{}),Object(x.jsxs)("li",{className:"devide",children:[Object(x.jsx)("label",{children:"Delivery Address"}),Object(x.jsx)("span",{})]}),Object(x.jsx)(x.Fragment,{children:Object.entries(v.deliveryDetail).map((function(e,t){var c=Object(j.a)(e,2),n=c[0],s=c[1];return"deliveryTime"===n?Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Delivery date"}),v.deliveryDetail.deliveryTime?Object(x.jsx)(d.s,{format:"DD MMM, YYYY hh:mma",children:v.deliveryDetail.deliveryTime}):"N/A"]},t):Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:n}),s]},t)}))})]})]}),Object(x.jsxs)("div",{className:"products",children:[Object(x.jsx)("h3",{children:"Products"}),Object(x.jsx)("ul",{children:v.products.map((function(e,t){var c=e.product,n=e.qty;return Object(x.jsxs)("li",{children:[Object(x.jsx)(d.n,{src:c.images[0]||"/open_box.png"}),Object(x.jsxs)("div",{className:"detail",children:[Object(x.jsx)("p",{children:c.name}),Object(x.jsxs)("p",{className:"qty",children:["QTY: ",n]})]}),Object(x.jsxs)("div",{className:"price",children:[Object(x.jsxs)("span",{children:[Object(d.M)({product:c,gst:!0})," x ",n]}),"\u20b9",Object(d.M)({product:c,gst:!0})*n]})]},t)}))}),Object(x.jsxs)("div",{className:"total",children:[Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Total"}),"\u20b9",J]}),v.coupon&&Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Coupon Code ",v.coupon.code,Object(x.jsx)("br",{}),"Discount"," ","percent"===v.coupon.type?Object(x.jsxs)(x.Fragment,{children:[v.coupon.amount,"% (Upto \u20b9",v.coupon.maxDiscount,")"]}):Object(x.jsx)(x.Fragment,{children:"flat"})]}),Object(x.jsxs)("span",{children:["\u20b9",U]})]})}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Shipping"}),"\u20b9",v.shippingCost||"N/A"]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsxs)("label",{children:["Delivery Pay fee ",v.fee,"%"]}),"\u20b9",B]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"data",children:[Object(x.jsx)("label",{children:"Grand Total"}),"\u20b9",v.total]})]})]}),Object(x.jsxs)("div",{className:"milestones",children:[Object(x.jsx)("h3",{children:"Milestones"}),Object(x.jsx)("p",{className:"subtitle",children:"Click to view milestone detail."}),Object(x.jsxs)("table",{cellSpacing:0,cellPadding:0,children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:"Date"}),Object(x.jsx)("td",{children:"Descrption"}),Object(x.jsx)("td",{children:"Amount"}),Object(x.jsx)("td",{children:"Status"})]})}),Object(x.jsxs)("tbody",{children:[v.milestones.map((function(e){return Object(x.jsxs)("tr",{onClick:function(){return t.push("/account/hold?q=".concat(e._id))},children:[Object(x.jsx)("td",{children:Object(x.jsx)(d.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(x.jsx)("td",{children:e.dscr}),Object(x.jsxs)("td",{children:["\u20b9",e.amount]}),Object(x.jsx)("td",{children:e.status})]},e._id)})),0===v.milestones.length&&Object(x.jsx)("tr",{className:"placeholdert",children:Object(x.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(x.jsxs)("div",{className:"delivery",children:[Object(x.jsx)("h3",{children:"Proof of delivery"}),(null===(q=v.files)||void 0===q?void 0:q.length)>0?Object(x.jsx)("div",{className:"thumbs",children:Object(x.jsx)(d.q,{links:v.files})}):Object(x.jsx)(x.Fragment,{children:"No files added."})]}),Object(x.jsxs)("section",{className:"terms",children:[Object(x.jsx)("h3",{children:"Return Policy Terms"}),Object(x.jsxs)("ul",{children:[null===(I=v.terms)||void 0===I?void 0:I.map((function(e,t){return Object(x.jsx)("li",{children:e},t)})),!(null===(H=v.terms)||void 0===H?void 0:H.length)&&Object(x.jsx)("li",{children:"No terms has been set by the seller yet."})]})]})]}),Object(x.jsx)(O.Modal,{head:!0,label:"Create Milestone",setOpen:C,className:"milestoneRequest",open:D,children:Object(x.jsx)(m,{action:"create",definedAmount:v.total,client:v.seller,order:v._id,onSuccess:function(e){C(!1),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.E,{}),Object(x.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(x.jsx)("h4",{children:"Milestone has been created"})]}),Object(x.jsx)(b.b,{to:"/account/hold",onClick:function(){return h(null)},children:"Check your Delivery pay Hold"})]})),g((function(t){return Object(r.a)(Object(r.a)({},t),{},{milestones:[].concat(Object(l.a)(t.milestones),[e])})}))}})}),Object(x.jsx)(O.Modal,{open:P,head:!0,label:"Issue Refund",setOpen:w,className:"issueRefund",children:Object(x.jsx)(N,{order:v,onSuccess:function(e){w(!1),g((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:"refundPending"})})),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.E,{}),Object(x.jsx)("h4",{children:"Refund has been issued."})]})]}))}})}),Object(x.jsx)(O.Modal,{className:"msg",open:o,children:o})]})}return Object(x.jsx)(x.Fragment,{children:"Loading"})},N=function(e){var t=e.order,c=e.onSuccess,n=Object(a.useState)(null),l=Object(j.a)(n,2),r=l[0],o=l[1],b=Object(a.useState)(!1),u=Object(j.a)(b,2),m=u[0],f=u[1],p=Object(a.useState)(""),v=Object(j.a)(p,2),g=v[0],N=v[1],y=Object(a.useState)(""),k=Object(j.a)(y,2),D=k[0],C=k[1],S=Object(a.useState)([]),M=Object(j.a)(S,2),Y=M[0],_=M[1],F=function(){var e=Object(i.a)(s.a.mark((function e(n){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),f(!0),!Y.length){e.next=8;break}return e.next=5,Object(d.H)({files:Y,setMsg:o});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:i=e.t0,fetch("/api/issueRefund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t._id,issue:g,dscr:D,files:i})}).then((function(e){return e.json()})).then((function(e){f(!1),"ok"===e.code?null===c||void 0===c||c(e.refund):o(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return o(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund could not be issued. Try again."})]})]}))})).catch((function(e){f(!1),console.log(e),o(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return o(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Refund could not be issued. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("form",{onSubmit:F,children:[Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Issue"}),Object(x.jsx)("input",{type:"text",required:!0,value:g,onChange:function(e){return N(e.target.value)}})]}),Object(x.jsxs)("section",{children:[Object(x.jsx)("label",{children:"Descrption"}),Object(x.jsx)(h.a,{required:!0,value:D,onChange:function(e){return C(e.target.value)}})]}),Object(x.jsxs)("section",{className:"images",children:[Object(x.jsx)("label",{children:"Upload relevant files"}),Object(x.jsx)(d.k,{accept:"image/*, video/*, audio/*",multiple:!0,onChange:function(e){return _(e)}})]}),Object(x.jsx)("section",{className:"btns",children:Object(x.jsx)("button",{className:"submit",children:"Submit"})})]}),m&&Object(x.jsx)("div",{className:"spinnerContainer",children:Object(x.jsx)("div",{className:"spinner"})}),Object(x.jsx)(O.Modal,{className:"msg",open:r,children:r})]})},y=function(e){var t=e.status,c=Object(a.useState)(0),n=Object(j.a)(c,2),s=n[0],i=n[1],l=Object(a.useState)(1),o=Object(j.a)(l,2),b=o[0],u=o[1],h=Object(a.useState)(20),m=Object(j.a)(h,2),f=m[0],p=(m[1],Object(a.useState)("")),v=Object(j.a)(p,2),g=v[0],N=(v[1],Object(a.useState)({column:"createdAt",order:"dsc"})),y=Object(j.a)(N,2),D=y[0],C=(y[1],Object(a.useState)([])),S=Object(j.a)(C,2),M=S[0],Y=S[1],_=Object(a.useState)(!1),F=Object(j.a)(_,2),A=F[0],P=F[1],w=Object(a.useState)([]),T=Object(j.a)(w,2),R=T[0],E=T[1],q=Object(a.useState)(null),I=Object(j.a)(q,2),H=I[0],J=I[1];return Object(a.useEffect)((function(){fetch("/api/getDisputes?".concat(new URLSearchParams(Object(r.a)(Object(r.a)({},g&&{q:g}),{},{page:b,perPage:f,sort:D.column,order:D.order},t&&{status:t})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(Y(e.disputes),i(e.total))})).catch((function(e){console.log(e),J(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return J(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[g,b,f,t]),Object(a.useEffect)((function(){A||E([])}),[A]),Object(a.useEffect)((function(){0===R.length&&P(!1)}),[R]),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{className:"benner",children:Object(x.jsx)("p",{children:"My Disputes"})}),R.length>0&&Object(x.jsx)("div",{className:"batchAction",children:Object(x.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(x.jsxs)("table",{className:"table disuptes",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{className:"date",children:"Raised at"}),Object(x.jsx)("th",{children:"User"}),Object(x.jsx)("th",{children:"Issue"}),Object(x.jsx)("th",{children:"Status"}),Object(x.jsx)("th",{children:"Actions"})]})}),Object(x.jsxs)("tbody",{children:[M.map((function(e){return Object(x.jsx)(k,{dispute:e,setDisputes:Y},e._id)})),0===M.length&&Object(x.jsx)("tr",{className:"placeholder",children:Object(x.jsx)("td",{children:"No Dispute yet."})})]})]}),Object(x.jsx)(d.u,{total:s,btns:5,currentPage:b,perPage:f,setPage:u}),Object(x.jsx)(O.Modal,{className:"msg",open:H,children:H})]})},k=function(e){var t=e.dispute,c=(e.setDisputes,Object(a.useRef)()),n=Object(a.useRef)(),s=Object(o.g)(),i=Object(a.useContext)(u.d).user,l=Object(a.useState)(!1),r=Object(j.a)(l,2),h=(r[0],r[1],Object(a.useState)(!1)),m=Object(j.a)(h,2),f=m[0],p=(m[1],t.plaintiff._id===i._id?"defendant":"plaintiff");return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("tr",{className:"dispute",onClick:function(e){e.nativeEvent.path.includes(c.current)||e.nativeEvent.path.includes(n.current)||s.push("".concat(s.location.pathname,"/").concat(t._id))},children:[Object(x.jsx)("td",{className:"date",children:Object(x.jsx)(d.s,{format:"DD MMM YYYY",children:t.createdAt})}),Object(x.jsx)("td",{children:Object(x.jsx)(d.I,{user:t[p]})}),Object(x.jsx)("td",{children:t.issue}),Object(x.jsx)("td",{children:t.status}),Object(x.jsx)("td",{ref:c,children:Object(x.jsx)(d.a,{icon:Object(x.jsx)(d.g,{}),children:Object(x.jsx)(b.b,{to:"".concat(s.location.pathname,"/").concat(t._id),children:"View Detail"})})})]}),Object(x.jsx)(O.Modal,{className:"msg",open:f,children:f})]})},D=function(e){e.history,e.location;var t,c,n=e.match,s=Object(a.useState)(null),i=Object(j.a)(s,2),l=i[0],r=i[1],o=Object(a.useState)(null),b=Object(j.a)(o,2),u=b[0],h=b[1];return Object(a.useEffect)((function(){fetch("/api/singleDispute?_id=".concat(n.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&r(e.dispute)})).catch((function(e){console.log(e),h(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return h(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Could not get Dispute. Make sure you're online."})]})]}))}))}),[]),l?Object(x.jsxs)("div",{className:"singleDispute ".concat(l.status),children:[Object(x.jsxs)("div",{className:"disputeSummery",children:[Object(x.jsx)("div",{className:"benner",children:"Dispute Summery"}),Object(x.jsxs)("ul",{className:"disputeDetail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Dispute ID:"}),Object(x.jsx)("div",{className:"data",children:l._id})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Status:"}),Object(x.jsx)("div",{className:"data",children:l.status})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Issue:"}),Object(x.jsx)("div",{className:"data",children:l.issue})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Issued by:"}),Object(x.jsx)("div",{className:"data",children:l.plaintiff.role})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Dispute filed:"}),Object(x.jsx)("div",{className:"data",children:Object(x.jsx)(d.s,{format:"hh:mm a, DD MMM, YYYY",children:l.createdAt})})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone amount:"}),Object(x.jsxs)("div",{className:"data",children:["\u20b9 ",l.milestone.amount]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone description:"}),Object(x.jsx)("div",{className:"data",children:l.milestone.dscr})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone products:"}),Object(x.jsxs)("div",{className:"data",children:[null===(t=l.milestone.products)||void 0===t?void 0:t.map((function(e,t){return Object(x.jsx)("li",{children:e.name},t)})),(null===(c=l.milestone.products)||void 0===c?void 0:c.length)?null:"No product selected"]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Milestone created:"}),Object(x.jsx)("div",{className:"data",children:Object(x.jsx)(d.s,{format:"hh:mm a, DD MMM, YYYY",children:l.milestone.createdAt})})]})]})]}),Object(x.jsx)(C,{role:"plaintiff",dispute:l,setData:r}),Object(x.jsx)(C,{role:"defendant",dispute:l,setData:r}),Object(x.jsx)(O.Modal,{open:u,className:"msg",children:u})]}):Object(x.jsxs)("div",{className:"singleDispute loading",children:[Object(x.jsxs)("div",{className:"disputeSummery",children:[Object(x.jsx)("div",{className:"benner",children:"Dispute Summery"}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]}),Object(x.jsxs)("div",{className:"plaintiff",children:[Object(x.jsx)("div",{className:"benner",children:"Plaintiff"}),Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)("div",{className:"img"}),Object(x.jsx)("div",{className:"name"})]}),Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]}),Object(x.jsxs)("div",{className:"defendant",children:[Object(x.jsx)("div",{className:"benner",children:"Defendant"}),Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)("div",{className:"img"}),Object(x.jsx)("div",{className:"name"})]}),Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})]})]})]})},C=function(e){var t,c,n,s,i,l,o,b=e.role,u=e.dispute,h=e.setData,m=Object(a.useState)(null),f=Object(j.a)(m,2),p=f[0],v=f[1];return Object(x.jsxs)("div",{className:"".concat(b," ").concat(u[b].role," ").concat(u.winner===u[b]._id?"winner":""),children:[Object(x.jsxs)("div",{className:"benner",children:[b,"pendingVerdict"===u.status&&(null===(t=u.defendant.case)||void 0===t?void 0:t.dscr)&&Object(x.jsx)("button",{onClick:function(){return Object(O.Confirm)({className:"disputeResolveConfirm",label:"Dispute resolve",question:Object(x.jsxs)(x.Fragment,{children:["Are you sure"," ",Object(x.jsx)("span",{className:"name",children:u[b].firstName+" "+u[b].lastName})," ",Object(x.jsxs)("span",{className:"role",children:["(",b,")"]})," is the winner of this dispute?"]}),callback:function(){return e=u[b]._id,void fetch("/api/resolveDispute",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:u._id,winner:e})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.E,{}),Object(x.jsx)("h4",{children:"Dispute Successfully resolved."})]})]})),h((function(t){return Object(r.a)(Object(r.a)({},t),{},{winner:e.dispute.winner,status:e.dispute.status})}))):v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:e.message})]})]}))})).catch((function(e){console.log(e),v(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(d.i,{}),Object(x.jsx)("h4",{children:"Dispute Could not be resolved. Make sure you' a're online."})]})]}))}));var e}})},children:"Winner"}),u.winner===u[b]._id&&Object(x.jsx)("p",{className:"winnerTag",children:"Winner"})]}),Object(x.jsxs)("div",{className:"content",children:[Object(x.jsxs)("div",{className:"user",children:[Object(x.jsx)(d.n,{src:u[b].profileImg||"/profile-user.jpg"}),Object(x.jsxs)("p",{className:"name",children:[u[b].firstName+" "+u[b].lastName,Object(x.jsx)("span",{className:"phone",children:u[b].phone})]})]}),(null===(c=u[b].case)||void 0===c?void 0:c.dscr)?Object(x.jsxs)("ul",{className:"detail",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Role:"})," ",Object(x.jsx)("div",{children:u[b].role})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Current Balance:"})," ",Object(x.jsxs)("div",{children:["\u20b9 ",null===(n=u[b].balance)||void 0===n?void 0:n.fix()]})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Case:"})," ",Object(x.jsx)("div",{children:(null===(s=u[b].case)||void 0===s?void 0:s.dscr)||"N/A"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("label",{children:"Evidence:"})," ",Object(x.jsx)("div",{className:"thumbs",children:(null===(i=u[b].case)||void 0===i||null===(l=i.files)||void 0===l?void 0:l.length)?Object(x.jsx)(d.q,{links:null===(o=u[b].case)||void 0===o?void 0:o.files}):"N/A"})]})]}):Object(x.jsx)("p",{className:"noRes",children:"Has not responded yet."})]}),Object(x.jsx)(O.Modal,{open:p,className:"msg",children:p})]})};t.default=function(){var e=Object(o.g)(),t=Object(a.useContext)(u.d).userType,c=Object(a.useState)(null),n=Object(j.a)(c,2),s=n[0],i=(n[1],Object(a.useState)([])),l=Object(j.a)(i,2),r=(l[0],l[1]);return Object(a.useEffect)((function(){fetch("/api/categories").then((function(e){return e.json()})).then((function(e){r(e.categories)}))}),[]),Object(x.jsxs)(x.Fragment,{children:["seller"===t&&Object(x.jsx)(o.a,{to:"/account/myShop/orders"}),Object(x.jsxs)("div",{className:"productContainer",children:[Object(x.jsx)("div",{style:{display:"none"},children:Object(x.jsx)(d.J,{})}),Object(x.jsxs)(o.d,{children:[Object(x.jsx)(o.b,{path:"/account/orders/current/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/current",children:Object(x.jsx)(f,{status:"approved|shipped|refundPending",onClick:function(t){return e.push("/account/orders/current/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/pending/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/pending",children:Object(x.jsx)(f,{status:"pending",onClick:function(t){return e.push("/account/orders/pending/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/history/:_id",component:g}),Object(x.jsx)(o.b,{path:"/account/orders/history",children:Object(x.jsx)(f,{status:"delivered|cancelled|declined|refunded",onClick:function(t){return e.push("/account/orders/history/".concat(t))}})}),Object(x.jsx)(o.b,{path:"/account/orders/dispute/:_id",component:D}),Object(x.jsx)(o.b,{path:"/account/orders/dispute",component:y})]}),Object(x.jsx)(O.Modal,{className:"msg",open:s,children:s})]})]})}}}]);
//# sourceMappingURL=28.331bc9fa.chunk.js.map