(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[21],{257:function(e,t,n){"use strict";n.r(t);var a=n(13),r=n(10),s=n(3),c=n(1),u=n(12),o=n(8),l=n(4),i=n(2),j=n(0);n(258);var d=function(){var e=Object(c.useContext)(u.d),t=e.user,n=e.setUser,d=Object(c.useState)(!1),b=Object(s.a)(d,2),p=b[0],O=b[1],h=Object(l.g)(),f=new URLSearchParams(Object(l.h)().search),m=Object(c.useState)(""),g=Object(s.a)(m,2),v=g[0],x=g[1],y=Object(c.useState)(1),C=Object(s.a)(y,2),S=C[0],w=C[1],N=Object(c.useState)(""),P=Object(s.a)(N,2),T=P[0],q=P[1],R=Object(c.useState)(""),k=Object(s.a)(R,2),E=(k[0],k[1],Object(c.useState)("+91")),U=Object(s.a)(E,2),D=U[0],_=U[1],L=Object(c.useState)(""),$=Object(s.a)(L,2),J=$[0],A=$[1],W=Object(c.useState)(""),F=Object(s.a)(W,2),M=F[0],z=F[1],I=Object(c.useState)(null),Z=Object(s.a)(I,2),B=Z[0],H=Z[1],V=Object(c.useRef)(null),G=Object(c.useRef)(null),K=Object(c.useRef)(null),Q=Object(c.useRef)(null),X=Object(c.useRef)(null),Y=Object(c.useRef)(null),ee=Object(c.useState)(0),te=Object(s.a)(ee,2),ne=te[0],ae=te[1],re=Object(c.useState)(["","","","","",""]),se=Object(s.a)(re,2),ce=se[0],ue=se[1],oe=function(e){O(!0),ae(0),fetch("/api/sendPhoneVerificationCode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:e})}).then((function(e){return e.json()})).then((function(e){O(!1),"ok"===e.code?w(2):424===e.code?H("Could not send verification SMS. Make sure number is correct."):409===e.code?H("Phone already exists. Please log in."):H("Could not complete request. Please try again.")}))};Object(c.useEffect)((function(){O(!1)}),[ce]);var le=function(e){var a;null===(a=e.preventDefault)||void 0===a||a.call(e),J===M?D.match(/^\+91\d{10}$/)?B||(1===S?oe(D):2===S&&(O(!0),fetch("/api/registerUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(r.a)({code:ce.join(""),firstName:v,lastName:T,phone:D,password:J},f.get("referer")&&{referer:f.get("referer")}))}).then((function(e){return e.json()})).then((function(e){O(!1),e.user?(h.replace("/account/home"),n(t)):11e3===e.code?H("Phone already exists."):400===e.code?(H("Wrong Code."),ae(e.attempt),ue(["","","","","",""])):429===e.code?(w(1),ue(["","","","","",""]),H("Too many attempts. Start again."),setTimeout((function(){return H(null)}),1500),ae(0)):403!==e.code&&404!==e.code||(ae(0),w(1),ue(["","","","","",""]),H("Timeout. Start again"),setTimeout((function(){return H(null)}),1500))})))):H("Enter valid phone number"):H("Password did not match.")};return Object(c.useEffect)((function(){H(null)}),[M]),Object(j.jsxs)("div",{className:"formWrapper ".concat(1===S?"register":"resetPass"),children:[Object(j.jsx)(o.n,{className:"logo",onClick:function(){return h.push("/")},src:"/logo_benner.jpg",alt:"Delivery pay logo"}),Object(j.jsx)("p",{className:"title",children:"Create your Delivery pay account"}),1===S&&Object(j.jsxs)("form",{onSubmit:le,children:[Object(j.jsx)("input",{type:"text",name:"firstName",required:!0,placeholder:"First name",value:v,onChange:function(e){return x(e.target.value)}}),Object(j.jsx)("input",{type:"text",name:"lastName",required:!0,placeholder:"Last name",value:T,onChange:function(e){return q(e.target.value)}}),Object(j.jsx)("input",{type:"text",name:"phone",required:!0,placeholder:"Phone number",value:D,onChange:function(e){H(null),e.target.value.match(/^\+91\d{0,10}$/)&&_(e.target.value)}}),Object(j.jsx)("section",{className:"pass",children:Object(j.jsx)("input",{type:"password",name:"password",required:!0,placeholder:"Password","aria-autocomplete":"list",autoComplete:"new-password",onChange:function(e){return A(e.target.value)}})}),Object(j.jsx)("section",{className:"repeatPass",children:Object(j.jsx)("input",{type:"password",name:"confirm_password",id:"confirm_password",required:!0,placeholder:"Confirm Password","aria-autocomplete":"list",autoComplete:"new-password",onChange:function(e){return z(e.target.value)}})}),Object(j.jsxs)("section",{className:"checkbox",children:[Object(j.jsx)(o.f,{required:!0}),Object(j.jsxs)("label",{children:["I Accept"," ",Object(j.jsx)(i.b,{to:"/terms",target:"_blank",children:"Terms & Conditions"}),", User Agreement,"," ",Object(j.jsx)(i.b,{to:"/codeOfConduct",target:"_blank",children:"Code of Conduct"}),","," ",Object(j.jsx)(i.b,{to:"/fees&Charges",target:"_blank",children:"Charges & Fee"})," ","& Consent to receiving Communications via Text, Email or Phone."]})]}),Object(j.jsx)("button",{disabled:B||p,type:"submit",children:"Next"})]}),2===S&&Object(j.jsxs)("form",{onSubmit:le,children:[Object(j.jsxs)("label",{children:["A 6 digit code has been sent to ",D,". Enter the code below."," ",Object(j.jsxs)("span",{className:"attempts",children:[3-ne," attempts left."]}),Object(j.jsxs)("span",{className:"resend",children:["Did not get the code?"," ",p?Object(j.jsx)("a",{children:"Sending"}):Object(j.jsx)("a",{onClick:function(){oe("+91"+D.replace(/^(\+91|91|1|)(?=\d{10}$)/g,""))},children:"Resend"})]})]}),Object(j.jsxs)("section",{className:"code",children:[Object(j.jsx)("input",{ref:V,type:"number",value:ce[0],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[0]=e.target.value[0]||"",n})),H(null),1===e.target.value.length?G.current.focus():V.current.focus()}}),Object(j.jsx)("input",{ref:G,type:"number",value:ce[1],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[1]=e.target.value[0]||"",n})),H(null),1===e.target.value.length?K.current.focus():V.current.focus()}}),Object(j.jsx)("input",{ref:K,type:"number",value:ce[2],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[2]=e.target.value[0]||"",n})),H(null),1===e.target.value.length?Q.current.focus():G.current.focus()}}),Object(j.jsx)("input",{ref:Q,type:"number",value:ce[3],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[3]=e.target.value[0]||"",n})),H(null),1===e.target.value.length?X.current.focus():K.current.focus()}}),Object(j.jsx)("input",{ref:X,type:"number",value:ce[4],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[4]=e.target.value[0]||"",n})),H(null),1===e.target.value.length?Y.current.focus():Q.current.focus()}}),Object(j.jsx)("input",{ref:Y,type:"number",value:ce[5],required:!0,onChange:function(e){ue((function(t){var n=Object(a.a)(t);return n[5]=e.target.value[0]||"",n})),H(null),0===e.target.value.length&&X.current.focus()}})]}),Object(j.jsx)("button",{disabled:B||p,type:"submit",children:"Register"})]}),B&&Object(j.jsx)("p",{className:"errMsg",children:B})]})},b=function(){var e=Object(c.useContext)(u.d),t=(e.user,e.setUser),n=Object(l.g)(),a=Object(c.useState)(""),r=Object(s.a)(a,2),d=r[0],b=r[1],p=Object(c.useState)(""),O=Object(s.a)(p,2),h=O[0],f=O[1],m=Object(c.useState)(!1),g=Object(s.a)(m,2),v=g[0],x=g[1];return Object(j.jsxs)("div",{className:"formWrapper login",children:[Object(j.jsx)(o.n,{className:"logo",onClick:function(){return n.push("/")},src:"/logo_benner.jpg",alt:"Delivery pay logo"}),Object(j.jsx)("p",{className:"title",children:"Login to your Delivery Pay account"}),Object(j.jsxs)("form",{onSubmit:function(e){var a;(e.preventDefault(),v)||(e.preventDefault(),new RegExp(/((\+*)((0[ -]+)*|(91 )*)(\d{12}|\d{10}))|\d{5}([- ]*)\d{6}/).test(d.toLowerCase())?(a="+91"+d.replace(/^(\+91|91|1|)(?=\d{10}$)/g,""),fetch("/api/userLogin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:h})}).then((function(e){return e.json()})).then((function(e){var a;e.user?(t(e.user),n.replace((null===(a=n.location.state)||void 0===a?void 0:a.from)||"/account/home")):401===e.code&&x("Invalid credential!")}))):x("Enter valid Phone number"))},children:[Object(j.jsx)("input",{type:"text",name:"username",required:!0,placeholder:"Phone Number",value:d,pattern:"^(\\+91|91|1|)\\d{10}$",onChange:function(e){x(!1),b(e.target.value)}}),Object(j.jsxs)("section",{className:"pass",children:[Object(j.jsx)("input",{type:"password",name:"password",required:!0,placeholder:"Password",value:h,onChange:function(e){x(!1),f(e.target.value)}}),Object(j.jsx)(i.b,{className:"passReset",to:"/u/resetPassword",children:"Forgot password?"})]}),Object(j.jsx)("button",{disabled:v,type:"submit",children:"Login"})]}),v&&Object(j.jsx)("p",{className:"errMsg",children:v})]})},p=function(){var e=Object(c.useContext)(u.d),t=e.user,n=e.setUser,r=Object(c.useState)(!1),i=Object(s.a)(r,2),d=i[0],b=i[1],p=Object(l.g)(),O=Object(c.useState)(1),h=Object(s.a)(O,2),f=h[0],m=h[1],g=Object(c.useState)("+91"),v=Object(s.a)(g,2),x=v[0],y=v[1],C=Object(c.useState)(!1),S=Object(s.a)(C,2),w=(S[0],S[1],Object(c.useState)(["","","","","",""])),N=Object(s.a)(w,2),P=N[0],T=N[1],q=Object(c.useState)(""),R=Object(s.a)(q,2),k=R[0],E=R[1],U=Object(c.useState)(""),D=Object(s.a)(U,2),_=D[0],L=D[1],$=Object(c.useState)(!1),J=Object(s.a)($,2),A=J[0],W=J[1],F=Object(c.useState)(0),M=Object(s.a)(F,2),z=M[0],I=M[1],Z=Object(c.useRef)(null),B=Object(c.useRef)(null),H=Object(c.useRef)(null),V=Object(c.useRef)(null),G=Object(c.useRef)(null),K=Object(c.useRef)(null),Q=Object(c.useCallback)((function(e){b(!0),fetch("/api/sendUserForgotPassOTP",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:e})}).then((function(e){b(!1),200===e.status?m(2):424===e.status?(W("Could not send OTP. Please contact support."),setTimeout((function(){return W(null)}),2e3)):W("User does does not exists.")}))}),[]),X=function(e){e.preventDefault();var a=null,r=new RegExp(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),s=new RegExp(/((\+*)((0[ -]+)*|(91 )*)(\d{12}|\d{10}))|\d{5}([- ]*)\d{6}/);if(r.test(x.toLowerCase())?x.toLowerCase():s.test(x.toLowerCase())&&(a="+91"+x.replace(/^(\+91|91|1|)(?=\d{10}$)/g,"")),1===f){if(A)return;a?Q(a):W("Enter a valid phone number.")}else if(2===f)b(!0),fetch("/api/submitUserForgotPassOTP",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,code:P.join("")})}).then((function(e){b(!1),200===e.status?m(3):400===e.status?(T(["","","","","",""]),W("Wrong code!"),e.json().then((function(e){I(e.attempt)}))):429===e.status?(m(1),T(["","","","","",""]),W("Too many attempts. Start again."),setTimeout((function(){return W(null)}),1500),I(0)):404===e.status&&(I(0),m(1),T(["","","","","",""]),W("Timeout. Start again"),setTimeout((function(){return W(null)}),1500))}));else if(3===f){if(k!==_)return void W("Password did not match");b(!0),fetch("/api/userResetPass",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,code:P.join(""),newPass:k})}).then((function(e){return e.json()})).then((function(e){b(!1),e.user&&(n(t),p.replace("/account/home"))})).catch((function(e){console.log(e),b(!1)}))}};return Object(c.useEffect)((function(){P.join("")&&W(null)}),[P]),Object(j.jsxs)("div",{className:"formWrapper resetPass",children:[Object(j.jsx)(o.n,{className:"logo",src:"/logo_benner.jpg",alt:"Delivery pay logo"}),Object(j.jsx)("p",{className:"title",children:"Password reset"}),2===f&&Object(j.jsxs)("a",{className:"back",onClick:function(){return m(1)},children:[Object(j.jsx)(o.c,{})," Back"]}),1===f&&Object(j.jsxs)("form",{onSubmit:X,children:[Object(j.jsx)("input",{type:"text",name:"phone",required:!0,placeholder:"Phone number",value:x,onChange:function(e){W(null),e.target.value.match(/^\+91\d{0,10}$/)&&y(e.target.value)}}),Object(j.jsx)("button",{disabled:A||d,type:"submit",children:"Next"})]}),2===f&&Object(j.jsxs)("form",{onSubmit:X,children:[Object(j.jsxs)("label",{children:["A 6 digit code has been sent to ",x,". Enter the code below."," ",Object(j.jsxs)("span",{className:"attempts",children:[3-z," attempts left."]}),Object(j.jsxs)("span",{className:"resend",children:["Did not get the code?"," ",d?Object(j.jsx)("a",{children:"Sending"}):Object(j.jsx)("a",{onClick:function(){Q("+91"+x.replace(/^(\+91|91|1|)(?=\d{10}$)/g,""))},children:"Resend"})]})]}),Object(j.jsxs)("section",{className:"code",children:[Object(j.jsx)("input",{ref:Z,type:"number",value:P[0],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[0]=e.target.value[0]||"",n})),1===e.target.value.length&&B.current.focus()}}),Object(j.jsx)("input",{ref:B,type:"number",value:P[1],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[1]=e.target.value[0]||"",n})),1===e.target.value.length&&H.current.focus()}}),Object(j.jsx)("input",{ref:H,type:"number",value:P[2],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[2]=e.target.value[0]||"",n})),1===e.target.value.length&&V.current.focus()}}),Object(j.jsx)("input",{ref:V,type:"number",value:P[3],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[3]=e.target.value[0]||"",n})),1===e.target.value.length&&G.current.focus()}}),Object(j.jsx)("input",{ref:G,type:"number",value:P[4],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[4]=e.target.value[0]||"",n})),1===e.target.value.length&&K.current.focus()}}),Object(j.jsx)("input",{ref:K,type:"number",value:P[5],required:!0,onChange:function(e){T((function(t){var n=Object(a.a)(t);return n[5]=e.target.value[0]||"",n}))}})]}),Object(j.jsx)("button",{disabled:A||d,type:"submit",children:"Next"})]}),3===f&&Object(j.jsxs)("form",{onSubmit:X,children:[Object(j.jsx)("input",{type:"password",name:"password",required:!0,placeholder:"Password","aria-autocomplete":"list",autoComplete:"new-password",onChange:function(e){W(null),E(e.target.value)}}),Object(j.jsx)("section",{className:"pass",children:Object(j.jsx)("input",{type:"password",name:"confirm_password",id:"confirm_password",required:!0,placeholder:"Confirm Password","aria-autocomplete":"list",autoComplete:"new-password",onChange:function(e){W(null),L(e.target.value)}})}),Object(j.jsx)("button",{disabled:A||d,type:"submit",children:3===f?"Submit":"Next"})]}),A&&Object(j.jsx)("p",{className:"errMsg",children:A})]})};t.default=function(){var e=Object(c.useContext)(u.d),t=e.setUser,n=(e.user,Object(l.g)());return Object(c.useEffect)((function(){fetch("/api/authUser").then((function(e){return e.json()})).then((function(e){var a,r;(null===(a=document.querySelector(".splash-screen"))||void 0===a||a.remove(),e.user)&&(t(e.user),n.replace((null===(r=n.location.state)||void 0===r?void 0:r.from)||"/account/home"))})).catch((function(e){var t;null===(t=document.querySelector(".splash-screen"))||void 0===t||t.remove(),console.log(e)}))}),[]),Object(j.jsxs)("div",{className:"generic",children:[Object(j.jsx)(o.m,{}),Object(j.jsxs)("div",{className:"userStart",children:[Object(j.jsxs)("div",{className:"banner",children:[Object(j.jsxs)("div",{className:"header",children:[Object(j.jsx)("h3",{children:"Experience the best and secure Transactions"}),Object(j.jsx)("p",{children:"We ensure buyer and seller happiness"})]}),Object(j.jsx)(o.n,{className:"illustration",src:"/landingPage_illustration.png",alt:"illustration"})]}),Object(j.jsx)("div",{className:"forms",children:Object(j.jsxs)(l.d,{children:[Object(j.jsx)(l.b,{path:"/u/join",children:Object(j.jsx)(d,{})}),Object(j.jsx)(l.b,{path:"/u/login",children:Object(j.jsx)(b,{})}),Object(j.jsx)(l.b,{path:"/u/resetPassword",children:Object(j.jsx)(p,{})})]})})]}),Object(j.jsx)(o.l,{})]})}},258:function(e,t,n){}}]);
//# sourceMappingURL=21.8baf0dac.chunk.js.map