(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[3],{158:function(e,t,c){"use strict";c.r(t),c.d(t,"MilestoneForm",(function(){return x})),c.d(t,"MilestoneReleaseForm",(function(){return m})),c.d(t,"AddressForm",(function(){return v})),c.d(t,"DisputeForm",(function(){return p})),c.d(t,"TicketForm",(function(){return f})),c.d(t,"TicketReplyForm",(function(){return g}));var n=c(23),s=c.n(n),i=c(28),l=c(10),a=c(3),r=c(1),o=c(12),j=c(9),d=c(2),u=c(17),b=c(174),O=c(175),h=(c(176),c(0)),x=function(e){var t,c,n,s,i=e.action,b=e.client,x=e.onSuccess,m=e.definedAmount,v=e.order,p=e.refund,f=e.strict,g=Object(r.useContext)(o.d),y=g.user,N=(g.setUser,g.config),C=Object(r.useState)(!1),k=Object(a.a)(C,2),S=k[0],F=k[1],M=Object(r.useState)(""),w=Object(a.a)(M,2),P=(w[0],w[1],Object(r.useState)(!1)),_=Object(a.a)(P,2),T=(_[0],_[1],Object(r.useState)(Object(l.a)({},y))),D=Object(a.a)(T,2),q=D[0],I=(D[1],Object(r.useState)(Object(l.a)({},b))),A=Object(a.a)(I,2),R=A[0],B=(A[1],Object(r.useState)("")),E=Object(a.a)(B,2),U=E[0],J=E[1],K=Object(r.useState)(m||""),z=Object(a.a)(K,2),L=z[0],Y=z[1],H=Object(r.useState)(0),V=Object(a.a)(H,2),G=V[0],W=V[1],X=Object(r.useState)(null),Z=Object(a.a)(X,2),Q=Z[0],$=Z[1],ee=Object(r.useRef)(),te=Object(r.useCallback)((function(){fetch("/api/requestMilestone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({buyer_id:b._id,amount:L,dscr:U,order:v,refund:p})}).then((function(e){return e.json()})).then((function(e){F(!1),"ok"===e.code?null===x||void 0===x||x(e.milestone):$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not request milestone. Try again."})]})]}))})).catch((function(e){F(!1),console.log(e),$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not request milestone. Make sure you're online."})]})]}))}))}),[R,q,L,U]),ce=Object(r.useCallback)((function(){fetch("/api/createMilestone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seller:Object(l.a)({},R),amount:L,dscr:U,order:v,refund:p})}).then((function(e){return e.json()})).then((function(e){F(!1),"ok"===e.code?null===x||void 0===x||x(Object(l.a)({},e)):403===e.code?$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Insufficient fund"}),Object(h.jsx)(d.b,{to:"/account/profile/wallet",children:"Add Money to your wallet now."})]})]})):$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not create milestone. Try again"})]})]}))})).catch((function(e){F(!1),console.log(e),$(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not create milestone. Make sure you're online."})]})]}))}))}),[R,q,L,U]);return Object(r.useEffect)((function(){W((function(){return(+L/100*N.fee).fix()}))}),[L]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"milestonesForm",onSubmit:function(e){F(!0),e.preventDefault(),Object(O.b)(Object(h.jsxs)("div",{className:"toast",children:["Milestone is being"," ","create"===i?"created.":"requested."," ",Object(h.jsx)("button",{className:"undo",onClick:function(){ee.current=null},children:"Undo"})]}),{position:"bottom-center",autoClose:8e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,onClose:function(){var e;null===(e=ee.current)||void 0===e||e.call(ee),F(!1)},draggable:!0,progress:void 0}),ee.current="create"===i?ce:te},children:[Object(h.jsxs)("section",{className:"transactionDetail",children:[Object(h.jsxs)("section",{className:"amount",children:[Object(h.jsx)("label",{children:"Amount"}),Object(h.jsx)(j.t,{readOnly:f,min:10,defaultValue:m||0,required:!0,onChange:function(e){return Y((+e.target.value).toString())}})]}),L&&Object(h.jsxs)(h.Fragment,{children:["create"===i&&Object(h.jsxs)("label",{className:"receivable",children:[b.firstName," ",b.lastName," will recieve \u20b9",(L-G).fix()]}),"request"===i&&Object(h.jsxs)("label",{className:"receivable",children:["You will recieve \u20b9",(L-G).fix()]})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Detail"}),Object(h.jsx)("input",{value:U,required:!0,onChange:function(e){return J(e.target.value)}})]}),Object(h.jsx)("button",{type:"submit",children:"create"===i?"Create Milestone":"Request Milestone"})]}),Object(h.jsxs)("section",{className:"clientDetail",children:["request"===i&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.n,{src:(null===b||void 0===b?void 0:b.profileImg)||"/profile-user.jpg"}),Object(h.jsx)("label",{children:"Buyer Information"}),Object(h.jsxs)("div",{className:"detail",children:[Object(h.jsxs)("section",{className:"profileDetail",children:[Object(h.jsx)("p",{className:"name",children:(null===b||void 0===b?void 0:b.firstName)+" "+(null===b||void 0===b?void 0:b.lastName)}),Object(h.jsx)("p",{className:"phone",children:null===b||void 0===b?void 0:b.phone}),Object(h.jsx)("p",{className:"email",children:null===b||void 0===b?void 0:b.email})]}),(null===b||void 0===b||null===(t=b.address)||void 0===t?void 0:t.street)&&Object(h.jsx)("section",{className:"address",children:Object(h.jsxs)("p",{className:"street",children:[null===(c=b.address)||void 0===c?void 0:c.street,", ",null===(n=b.address)||void 0===n?void 0:n.city,","," ",null===(s=b.address)||void 0===s?void 0:s.zip]})})]})]}),"request"===i?null:Object(h.jsxs)("div",{className:"sellerInfo",children:[Object(h.jsx)(j.n,{src:(null===R||void 0===R?void 0:R.profileImg)||"/profile-user.jpg"}),Object(h.jsx)("label",{children:"Seller Information"}),Object(h.jsx)("div",{className:"detail",children:Object(h.jsxs)("section",{className:"profileDetail",children:[Object(h.jsxs)("p",{className:"name",children:[null===R||void 0===R?void 0:R.firstName," ",null===R||void 0===R?void 0:R.lastName]}),Object(h.jsx)("p",{className:"phone",children:null===R||void 0===R?void 0:R.phone}),Object(h.jsx)("p",{className:"email",children:null===R||void 0===R?void 0:R.email})]})})]})]})]}),S&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(u.Modal,{className:"msg",open:Q,children:Q})]})},m=function(e){var t=e.milestone,c=e.setReleaseForm,n=e.onSuccess,s=Object(r.useState)(t.amount),i=Object(a.a)(s,2),l=i[0],o=(i[1],Object(r.useState)(null)),d=Object(a.a)(o,2),b=d[0],O=d[1];return Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/releaseMilestone",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id,amount:l})}).then((function(e){return e.json()})).then((function(e){var t=e.code,c=e.milestone;c?null===n||void 0===n||n(c):O(403===t?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return O(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not release Milestone due to low balance."})]})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return O(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not release Milestone."})]})]}))})).catch((function(e){console.log(e),h.Fragment,j.i}))},children:["You sure want to release this Milestone?",Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{type:"submit",children:"Confirm"}),Object(h.jsx)("button",{className:"cancel",type:"button",onClick:function(){return c(!1)},children:"Cancel"})]}),Object(h.jsx)(u.Modal,{open:b,className:"msg",children:b})]})},v=function(e){var t,c,n,s,i,l,o,j=e.client,d=e.onSuccess,u=e.onCancel,b=Object(r.useState)(j?j.name||j.firstName+" "+j.lastName:""),O=Object(a.a)(b,2),x=O[0],m=O[1],v=Object(r.useState)((null===j||void 0===j?void 0:j.phone)||""),p=Object(a.a)(v,2),f=p[0],g=p[1],y=Object(r.useState)((null===j||void 0===j||null===(t=j.address)||void 0===t?void 0:t.zip)||""),N=Object(a.a)(y,2),C=N[0],k=N[1],S=Object(r.useState)((null===j||void 0===j||null===(c=j.address)||void 0===c?void 0:c.locality)||""),F=Object(a.a)(S,2),M=F[0],w=F[1],P=Object(r.useState)((null===j||void 0===j||null===(n=j.address)||void 0===n?void 0:n.street)||""),_=Object(a.a)(P,2),T=_[0],D=_[1],q=Object(r.useState)((null===j||void 0===j||null===(s=j.address)||void 0===s?void 0:s.city)||""),I=Object(a.a)(q,2),A=I[0],R=I[1],B=Object(r.useState)((null===j||void 0===j||null===(i=j.address)||void 0===i?void 0:i.state)||""),E=Object(a.a)(B,2),U=E[0],J=E[1],K=Object(r.useState)((null===j||void 0===j||null===(l=j.address)||void 0===l?void 0:l.landmark)||""),z=Object(a.a)(K,2),L=z[0],Y=z[1],H=Object(r.useState)((null===j||void 0===j||null===(o=j.address)||void 0===o?void 0:o.altPhone)||""),V=Object(a.a)(H,2),G=V[0],W=V[1];return Object(h.jsxs)("form",{className:"addressForm",onSubmit:function(e){e.preventDefault(),null===d||void 0===d||d({address:{name:x,phone:f,street:T,city:A,state:U,zip:C,locality:M,landmark:L,altPhone:G}})},children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"name",children:"Full Name"}),Object(h.jsx)("input",{value:x,onChange:function(e){return m(e.target.value)},type:"text",name:"name",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"phone",children:"Phone Number"}),Object(h.jsx)("input",{value:f,onChange:function(e){return g(e.target.value)},type:"tel",name:"phone",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"zip",children:"PIN Code"}),Object(h.jsx)("input",{value:C,onChange:function(e){return k(e.target.value)},type:"number",name:"zip",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"locality",children:"Locality"}),Object(h.jsx)("input",{value:M,onChange:function(e){return w(e.target.value)},type:"text",name:"locality",required:!0})]}),Object(h.jsxs)("section",{className:"street",children:[Object(h.jsx)("label",{htmlFor:"address",children:"Address"}),Object(h.jsx)("textarea",{value:T,onChange:function(e){return D(e.target.value)},resiz:"off",type:"text",name:"address",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"city",children:"City"}),Object(h.jsx)("input",{value:A,onChange:function(e){return R(e.target.value)},type:"text",name:"city",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"state",children:"State"}),Object(h.jsx)("input",{value:U,onChange:function(e){return J(e.target.value)},type:"text",name:"state",required:!0})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"landmark",children:"Landmark (Optional)"}),Object(h.jsx)("input",{value:L,onChange:function(e){return Y(e.target.value)},type:"text",name:"landmark"})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"altPhone",children:"Alternate Phone (Optional)"}),Object(h.jsx)("input",{value:G,onChange:function(e){return W(e.target.value)},type:"tel",name:"altPhone"})]}),Object(h.jsx)("button",{className:"save",children:"Save"}),Object(h.jsx)("button",{className:"cancel",type:"button",onClick:function(){return null===u||void 0===u?void 0:u()},children:"Cancel"}),Object(h.jsx)("section",{className:"pBtm"})]})},p=function(e){var t=e.milestone,c=(e.setDisputeForm,e.onSuccess),n=Object(r.useState)(""),l=Object(a.a)(n,2),o=l[0],d=l[1],O=Object(r.useState)(!1),x=Object(a.a)(O,2),m=x[0],v=x[1],p=Object(r.useState)(""),f=Object(a.a)(p,2),g=f[0],y=f[1],N=Object(r.useState)([]),C=Object(a.a)(N,2),k=C[0],S=C[1],F=Object(r.useState)(null),M=Object(a.a)(F,2),w=M[0],P=M[1],_=function(){var e=Object(i.a)(s.a.mark((function e(n){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),v(!0),!k.length){e.next=8;break}return e.next=5,Object(j.F)({files:k,setMsg:P});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:i=e.t0,fetch("/api/fileDispute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issue:o,milestoneId:t._id,defendantId:t.client._id,_case:{dscr:g,files:i}})}).then((function(e){return e.json()})).then((function(e){v(!1),"ok"===e.code?null===c||void 0===c||c(e.milestone):403===e.code?P(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return P(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Insufficient fund! you have to have \u20b9500 in your wallet to file a dispute."})]})]})):P(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return P(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not file dispute."})]})]}))})).catch((function(e){v(!0),console.log(e),P(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return P(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Could not file dispute. make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"disputeForm",onSubmit:_,children:[Object(h.jsx)("h4",{children:"You feel like you are getting scammed?"}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"issue",children:"Issue"}),Object(h.jsx)(j.h,{name:"issue",options:"buyer"===t.role?[{label:"Buyer Not Releasing Payments",value:"Buyer Not Releasing Payments"}]:[{label:"Goods Not Received",value:"Goods Not Received"},{label:"Services Not Received",value:"Services Not Received"},{label:"Damaged",value:"Damaged"},{label:"Not As Agreed",value:"Not As Agreed"},{label:"Not As Displayed",value:"Not As Displayed"}],onChange:function(e){d(e.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"description",children:"Description"}),Object(h.jsx)(b.a,{name:"description",value:g,required:!0,onChange:function(e){return y(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload images to prove your case. ie: Product of image, proof of delivery."}),Object(h.jsx)(j.k,{multiple:!0,accept:"audio/*,video/*,image/*",onChange:function(e){return S(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),m&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(u.Modal,{open:w,className:"msg",children:w})]})},f=function(e){var t=e.onSuccess,c=Object(r.useState)(!1),n=Object(a.a)(c,2),l=n[0],o=n[1],d=Object(r.useState)(!1),O=Object(a.a)(d,2),x=O[0],m=O[1],v=Object(r.useState)(""),p=Object(a.a)(v,2),f=p[0],g=p[1],y=Object(r.useState)(""),N=Object(a.a)(y,2),C=N[0],k=N[1],S=Object(r.useState)(""),F=Object(a.a)(S,2),M=F[0],w=F[1],P=Object(r.useState)(""),_=Object(a.a)(P,2),T=_[0],D=_[1],q=Object(r.useState)(""),I=Object(a.a)(q,2),A=I[0],R=I[1],B=function(){var e=Object(i.a)(s.a.mark((function e(c){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),o(!0),!T.length){e.next=8;break}return e.next=5,Object(j.F)({files:T,setMsg:m});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:n=e.t0,fetch("/api/openTicket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issue:f,milestone:C,transaction:M,message:{body:A,files:n}})}).then((function(e){return e.json()})).then((function(e){o(!1),"ok"===e.code?null===t||void 0===t||t(e.ticket):"milestone ID is invalid"===e.message?m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Milestone Id is invalid."})]})]})):m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Ticket could not be submitted."})]})]}))})).catch((function(e){o(!1),console.log(e),m(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return m(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Ticket could not be submitted. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"ticketForm",onSubmit:B,children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Issue"}),Object(h.jsx)("input",{value:f,required:!0,onChange:function(e){return g(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Milestone ID (optional)"}),Object(h.jsx)("input",{value:C,onChange:function(e){return k(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Transaction ID (optional)"}),Object(h.jsx)("input",{value:M,onChange:function(e){return w(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Detail"}),Object(h.jsx)(b.a,{required:!0,value:A,onChange:function(e){return R(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload relevant files (optional)"}),Object(h.jsx)(j.k,{onChange:function(e){return D(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),l&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(u.Modal,{open:x,className:"msg",children:x})]})},g=function(e){var t=e._id,c=e.onSuccess,n=Object(r.useState)(!1),l=Object(a.a)(n,2),o=l[0],d=l[1],O=Object(r.useState)(!1),x=Object(a.a)(O,2),m=x[0],v=x[1],p=Object(r.useState)([]),f=Object(a.a)(p,2),g=f[0],y=f[1],N=Object(r.useState)(""),C=Object(a.a)(N,2),k=C[0],S=C[1],F=function(){var e=Object(i.a)(s.a.mark((function e(n){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),d(!0),!g.length){e.next=8;break}return e.next=5,Object(j.F)({files:g,setMsg:v});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:i=e.t0,fetch("/api/addTicketReply",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t,message:{body:k,files:i}})}).then((function(e){return e.json()})).then((function(e){d(!1),"ok"===e.code?null===c||void 0===c||c(e.ticket):v(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Reply could not be submitted."})]})]}))})).catch((function(e){d(!1),console.log(e),v(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(j.i,{}),Object(h.jsx)("h4",{children:"Reply could not be submitted. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("form",{className:"ticketReplyForm",onSubmit:F,children:[Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Message"}),Object(h.jsx)(b.a,{required:!0,value:k,onChange:function(e){return S(e.target.value)}})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{htmlFor:"for",children:"Upload relevant files (optional)"}),Object(h.jsx)(j.k,{accept:"audio/*,video/*,image/*",multiple:!0,onChange:function(e){return y(e)}})]}),Object(h.jsxs)("section",{className:"btns",children:[Object(h.jsx)("button",{className:"submit",type:"submit",children:"Submit"}),Object(h.jsx)("button",{className:"cancel",type:"button",children:"Cancel"})]}),Object(h.jsx)("div",{className:"pBtm"})]}),o&&Object(h.jsx)("div",{className:"spinnerContainer",children:Object(h.jsx)("div",{className:"spinner"})}),Object(h.jsx)(u.Modal,{open:m,className:"msg",children:m})]})}},241:function(e,t,c){},70:function(e,t,c){"use strict";c.r(t),c.d(t,"SingleProduct",(function(){return C})),c.d(t,"Cart",(function(){return F})),c.d(t,"CartItem",(function(){return w}));var n=c(23),s=c.n(n),i=c(28),l=c(10),a=c(13),r=c(3),o=c(1),j=c(9),d=c(158),u=c(12),b=c(4),O=c(2),h=c(17),x=c(161),m=c(214),v=c.n(m),p=c(0),f=Object(o.lazy)((function(){return c.e(24).then(c.bind(null,274))})),g=Object(o.lazy)((function(){return Promise.resolve().then(c.bind(null,158)).then((function(e){return{default:e.MilestoneForm}}))}));c(241);var y=function(e){var t=e.client,c=e.onToggle,n=Object(o.useContext)(u.d).user,s=Object(o.useContext)(u.a),i=s.contacts,d=s.setContacts,b=Object(o.useState)(!1),h=Object(r.a)(b,2),m=h[0],v=h[1],f=Object(o.useState)(null),g=Object(r.a)(f,2),y=g[0],N=g[1],C=Object(o.useState)(null),k=Object(r.a)(C,2),S=k[0],F=k[1];return Object(o.useEffect)((function(){if(n){var e=i.find((function(e){return e.client._id===t._id}));e&&(N(Object(l.a)(Object(l.a)({},e.client),{},{status:e.userBlock?"blocked":""})),F(e.messages),u.e.emit("initiateChat",Object(l.a)({client_id:t._id},void 0===e.messages&&{newChat:!0})))}}),[t,i]),Object(o.useEffect)((function(){null===c||void 0===c||c(m)}),[m]),m?n?Object(p.jsxs)("div",{className:"chatWrapper",children:[Object(p.jsx)("button",{className:"closeChat",onClick:function(){return v(!1)},children:Object(p.jsx)(j.c,{})}),Object(p.jsx)(x.Chat,{chat:S,setContacts:d,userCard:y,setUserCard:N,user:n,setChat:F})]}):Object(p.jsxs)("div",{className:"chatWrapper",children:[Object(p.jsx)("button",{className:"closeChat",onClick:function(){return v(!1)},children:Object(p.jsx)(j.c,{})}),Object(p.jsx)("div",{className:"chat",children:Object(p.jsx)("div",{className:"startChat",children:Object(p.jsx)(O.b,{to:"/u/login",children:Object(p.jsx)("p",{children:"Login to start chat with this seller."})})})})]}):Object(p.jsx)("button",{className:"chatBtn",onClick:function(){if(n&&!y){var e=i.find((function(e){return e.client._id===t._id}));console.log(e),e?(N(Object(l.a)(Object(l.a)({},e.client),{},{status:e.userBlock?"blocked":""})),F(e.messages),u.e.emit("initiateChat",Object(l.a)({client_id:t._id},void 0===e.messages&&{newChat:!0}))):(d((function(e){return[].concat(Object(a.a)(e),[{client:t,messages:[],status:""}])})),u.e.emit("initiateChat",{client_id:t._id,newChat:!0}))}v(!0)},children:Object(p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26.55",height:"25.219",viewBox:"0 0 26.55 25.219",children:Object(p.jsx)("path",{id:"Path_1","data-name":"Path 1",d:"M-242.2-184.285h-13l26.55-10.786-4.252,25.219-5.531-10.637-2.127,4.68v-6.382l7.659-9.148h2.34",transform:"translate(255.198 195.071)",fill:"#fff"})})})},N=function(e){var t,c,n=e.data,s=Object(o.useContext)(u.d),i=s.user,l=s.userType,a=s.setCart,r=Object(j.K)({product:n,gst:null===(t=n.user)||void 0===t?void 0:t.gst});return Object(p.jsxs)("div",{className:"product",children:[Object(p.jsx)(O.b,{to:"/marketplace/".concat(n._id),children:Object(p.jsx)("div",{className:"thumb ".concat(n.images[0]?"":"noThumb"),children:Object(p.jsx)(j.n,{src:n.images[0]||"/open_box.png"})})}),Object(p.jsxs)("div",{className:"detail",children:[Object(p.jsx)("h3",{children:n.name}),Object(p.jsx)("p",{className:"dscr",children:n.dscr}),Object(p.jsxs)("div",{className:"price",children:[Object(p.jsx)("span",{className:"symbol",children:"\u20b9 "}),r," ",r!==Object(j.K)({product:n,gst:n.user.gst,discount:!1})&&Object(p.jsx)("span",{className:"originalPrice",children:Object(j.K)({product:n,gst:null===(c=n.user)||void 0===c?void 0:c.gst,discount:!1})})]})]}),Object(p.jsxs)("div",{className:"actions",children:["buyer"===l&&(null===n||void 0===n?void 0:n.user._id)===(null===i||void 0===i?void 0:i._id)&&Object(p.jsx)("p",{className:"note",children:"Can't buy product from self."}),Object(p.jsx)("button",{disabled:!n.available||(null===n||void 0===n?void 0:n.user._id)===(null===i||void 0===i?void 0:i._id),onClick:function(){a((function(e){return Object(j.I)(e,n)}))},children:"Add to Cart"})]})]})},C=function(e){var t,c,n,l,a,d,b,x,m,v,g,N,C=e.match,S=Object(o.useContext)(u.d),F=S.user,M=S.setCart,w=S.userType,P=Object(o.useState)(!1),_=Object(r.a)(P,2),T=_[0],D=_[1],q=Object(o.useState)(null),I=Object(r.a)(q,2),A=I[0],R=I[1],B=Object(o.useState)(null),E=Object(r.a)(B,2),U=E[0],J=E[1],K=Object(o.useState)(!1),z=Object(r.a)(K,2),L=z[0],Y=z[1];return Object(o.useEffect)((function(){fetch("/api/singleProduct?_id=".concat(C.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?R(e.product):J(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return J(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Product does not exists."})]})]}))})).catch((function(e){console.log(e),J(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return J(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get product. Make sure you're online."})]})]}))})),navigator.share&&D(!0)}),[]),A?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(f,{children:[Object(p.jsxs)("title",{children:[A.name," | Delivery Pay"]}),Object(p.jsx)("meta",{name:"description",content:A.dscr}),Object(p.jsx)("meta",{property:"og:url",content:"https://deliverypay.in/marketplace/".concat(A._id)}),Object(p.jsx)("meta",{property:"og:type",content:"product"}),Object(p.jsx)("meta",{property:"og:title",content:"".concat(A.name," | Delivery Pay")}),Object(p.jsx)("meta",{property:"og:description",content:A.dscr}),Object(p.jsx)("meta",{property:"og:image",content:A.images[0]})]}),Object(p.jsxs)("div",{className:"generic singleProduct ".concat(L?"chatOpen":""),children:[Object(p.jsx)(j.m,{}),Object(p.jsxs)("div",{className:"content",children:[Object(p.jsx)(k,{images:A.images}),Object(p.jsxs)("div",{className:"detail",children:[Object(p.jsx)("h1",{children:A.name}),Object(p.jsx)("p",{children:A.dscr}),Object(p.jsxs)("p",{className:"price",children:[Object(p.jsx)("label",{children:"Price: "})," ",Object(p.jsx)("span",{className:"symbol",children:"\u20b9"}),Object(j.K)({product:A,gst:null===(t=A.user)||void 0===t?void 0:t.gst})," ",Object(j.K)({product:A,gst:null===(c=A.user)||void 0===c?void 0:c.gst})!==Object(j.K)({product:A,gst:null===(n=A.user)||void 0===n?void 0:n.gst,discount:!1})&&Object(p.jsx)("span",{className:"originalPrice",children:Object(j.K)({product:A,gst:null===(l=A.user)||void 0===l?void 0:l.gst,discount:!1})})]}),Object(p.jsxs)("p",{children:["product"===A.type&&Object(p.jsxs)(p.Fragment,{children:["Available: ",A.available&&A.available," ",0===A.available&&Object(p.jsx)(p.Fragment,{children:"Out of stock"}),A.available<7&&A.available>0&&Object(p.jsx)(p.Fragment,{children:"Low stock"})]}),"product"!==A.type&&Object(p.jsxs)(p.Fragment,{children:["Availability:"," ",A.available?"Available":"Unavailable"]})]}),Object(p.jsxs)("div",{className:"actions",children:[Object(p.jsx)("button",{disabled:!A.available||"seller"===w||(null===(a=A.user)||void 0===a?void 0:a._id)===(null===F||void 0===F?void 0:F._id),onClick:function(){M((function(e){return Object(j.I)(e,A)}))},children:"Add to Cart"}),T&&Object(p.jsx)("button",{onClick:Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.share({title:"".concat(A.name," | Delivery Pay"),url:window.location.href});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])}))),children:"Share this Product"}),"seller"===w&&(null===A||void 0===A||null===(d=A.user)||void 0===d?void 0:d._id)!==(null===F||void 0===F?void 0:F._id)&&Object(p.jsx)("p",{className:"note",children:"Switch to buyer profile to buy this product."}),"buyer"===w&&(null===A||void 0===A||null===(b=A.user)||void 0===b?void 0:b._id)===(null===F||void 0===F?void 0:F._id)&&Object(p.jsx)("p",{className:"note",children:"Can't buy product from self."})]}),A.user&&Object(p.jsxs)("div",{className:"seller",children:[Object(p.jsx)("label",{children:"Being sold by:"}),Object(p.jsx)(O.b,{to:"/marketplace?seller=".concat(null===(x=A.user)||void 0===x?void 0:x._id),children:Object(p.jsxs)("div",{className:"profile",children:[Object(p.jsx)(j.n,{src:(null===(m=A.user)||void 0===m?void 0:m.profileImg)||"/profile-user.jpg"}),Object(p.jsxs)("p",{className:"name",children:[null===(v=A.user)||void 0===v?void 0:v.firstName," ",null===(g=A.user)||void 0===g?void 0:g.lastName," ",Object(p.jsx)("span",{className:"contact",children:null===(N=A.user)||void 0===N?void 0:N.phone})]})]})})]})]}),Object(p.jsx)(h.Modal,{className:"msg",open:U,children:U})]}),A&&Object(p.jsx)(y,{client:A.user,onToggle:Y}),Object(p.jsx)(j.l,{})]})]}):Object(p.jsxs)("div",{className:"generic singleProduct ".concat(L?"chatOpen":""),children:[Object(p.jsx)(j.m,{}),"loading",Object(p.jsx)(h.Modal,{className:"msg",open:U,children:U}),Object(p.jsx)(j.l,{})]})},k=function(e){var t=e.images,c=Object(o.useState)(t[0]),n=Object(r.a)(c,2),s=n[0],i=n[1];return Object(p.jsxs)("div",{className:"gallery",children:[Object(p.jsx)(S,{img:s}),Object(p.jsxs)("div",{className:"thumbs",children:[t.map((function(e,t){return Object(p.jsx)(j.n,{src:e,onClick:function(){return i(e)}},t)})),0===t.length&&Object(p.jsx)("p",{children:"No image was provided by the seller."})]})]})},S=function(e){var t=e.img,c=Object(o.useState)(t||"/open_box.png"),n=Object(r.a)(c,2),s=n[0],i=n[1],l=Object(o.useState)(null),a=Object(r.a)(l,2),j=a[0],d=a[1],u=Object(o.useState)(!1),b=Object(r.a)(u,2),O=b[0],h=b[1],x=Object(o.useState)({}),m=Object(r.a)(x,2),v=m[0],f=m[1],g=Object(o.useRef)();return Object(o.useEffect)((function(){i(t||"/open_box.png")}),[t]),Object(p.jsx)("div",{ref:g,className:"mainView ".concat(t?"":"noImg"),onMouseMove:function(e){if(t){var c=.65*Math.abs(Math.round((e.clientX-(null===j||void 0===j?void 0:j.x))/((null===j||void 0===j?void 0:j.width)/100))),n=.65*Math.round((e.clientY-(null===j||void 0===j?void 0:j.y))/((null===j||void 0===j?void 0:j.height)/100));f({transform:"scale(2) translateY(".concat(Math.max(30-n,-30),"%) translateX(").concat(Math.max(30-c,-30),"%)")})}},onTouchStart:function(e){var t;document.querySelector("body").style.overflow="hidden",d(null===(t=g.current)||void 0===t?void 0:t.getBoundingClientRect()),h(!0)},onTouchEnd:function(e){document.querySelector("body").style.overflow="auto",h(!1)},onTouchMove:function(e){if(t){var c=.65*Math.abs(Math.round((e.touches[0].clientX-j.x)/(j.width/100))),n=.65*Math.round((e.touches[0].clientY-j.y)/(j.height/100));f({transform:"scale(2) translateY(".concat(Math.max(30-n,-30),"%) translateX(").concat(Math.max(30-c,-30),"%)"),transition:"none"})}},onMouseEnter:function(){var e;h(!0),d(null===(e=g.current)||void 0===e?void 0:e.getBoundingClientRect())},onMouseLeave:function(){return h(!1)},children:Object(p.jsx)("img",{className:O?"scale":"",style:O?v:{},src:s,onError:function(){return i("/img_err.png")}})})},F=function(){var e=Object(o.useContext)(u.d),t=(e.setCart,e.cart),c=Object(o.useState)(!0),n=Object(r.a)(c,2),s=n[0],i=n[1],l=Object(o.useState)(null),a=Object(r.a)(l,2),d=a[0],b=a[1],O=Object(o.useState)(null),x=Object(r.a)(O,2),m=x[0],v=x[1];return Object(o.useEffect)((function(){i(!0),fetch("/api/getCartDetail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:t})}).then((function(e){return e.json()})).then((function(e){i(!1),"ok"===e.code&&b(e.carts)})).catch((function(e){console.log(e),i(!1),v(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return v(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get cart detail. Make sure you're online."})]})]}))}))}),[t]),d?Object(p.jsxs)("div",{className:"fullCart",children:[Object(p.jsx)("div",{className:"head",children:Object(p.jsx)("h1",{children:"Cart"})}),Object(p.jsxs)("div",{className:"allCarts",children:[d.map((function(e){var t=e.seller,c=e.products;return(null===c||void 0===c?void 0:c.length)?Object(p.jsx)(M,{seller:t,products:c,loading:s},t._id):null})),0===(null===d||void 0===d?void 0:d.length)&&Object(p.jsx)("p",{children:"Cart is empty"})]}),Object(p.jsx)(h.Modal,{open:m,className:"msg",children:m})]}):Object(p.jsxs)("div",{className:"fullCart",children:[Object(p.jsx)("div",{className:"head",children:Object(p.jsx)("h1",{children:"Cart"})}),Object(p.jsx)("div",{className:"allCarts",children:"Cart is empty."}),Object(p.jsx)(h.Modal,{open:m,className:"msg",children:m})]})},M=function(e){var t,c,n,s,i,a,b=e.seller,x=e.products,m=e.loading,v=Object(o.useContext)(u.d),f=v.user,y=v.setCart,N=v.config,C=Object(o.useState)(null),k=Object(r.a)(C,2),S=k[0],F=k[1],M=Object(o.useState)({name:f.firstName+" "+f.lastName,phone:f.phone}),P=Object(r.a)(M,2),_=P[0],T=P[1],D=Object(o.useState)(!1),q=Object(r.a)(D,2),I=q[0],A=q[1],R=Object(o.useState)(!1),B=Object(r.a)(R,2),E=B[0],U=B[1],J=Object(o.useState)(!1),K=Object(r.a)(J,2),z=K[0],L=K[1],Y=Object(o.useState)(""),H=Object(r.a)(Y,2),V=H[0],G=H[1],W=Object(o.useState)(!1),X=Object(r.a)(W,2),Z=X[0],Q=X[1],$=Object(o.useState)(!1),ee=Object(r.a)($,2),te=ee[0],ce=ee[1],ne=x.reduce((function(e,t){return(e+Object(j.K)({product:t.product,gst:b.gst})*t.qty).fix()}),0),se="percent"===(null===Z||void 0===Z?void 0:Z.type)&&Math.min(ne/100*Z.amount,Z.maxDiscount)||"flat"===(null===Z||void 0===Z?void 0:Z.type)&&(null===Z||void 0===Z?void 0:Z.amount)||0,ie=+(ne-se)+((null===(t=b.shopInfo)||void 0===t?void 0:t.shippingCost)||0).fix(),le=(ie*((100+N.fee)/100)-ie).fix();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"shop",children:[Object(p.jsx)("div",{className:"seller",children:Object(p.jsxs)("div",{className:"profile",children:[Object(p.jsx)(j.n,{src:b.profileImg||"/profile-user.jpg"}),Object(p.jsxs)("p",{className:"name",children:[b.firstName," ",b.lastName," \u2022"," ",Object(p.jsx)("span",{className:"role",children:"Seller"}),Object(p.jsx)("span",{className:"contact",children:b.phone})]})]})}),Object(p.jsxs)("div",{className:"cart",children:[Object(p.jsxs)("ul",{className:"items",children:[x.map((function(e,t){var c=e.product,n=e.qty;return Object(p.jsx)(w,{gst:b.gst,product:c,qty:n},t)})),Object(p.jsxs)("div",{className:"total",children:[Object(p.jsxs)("p",{children:[Object(p.jsx)("label",{children:"Total"}),"\u20b9",ne]}),Object(p.jsx)("hr",{}),Object(p.jsxs)("div",{className:"coupon",children:[Z?Object(p.jsxs)("label",{children:["Coupon Code ",Z.code,Object(p.jsx)("br",{}),"Discount"," ","percent"===Z.type?Object(p.jsxs)(p.Fragment,{children:[Z.amount,"% (Upto \u20b9",Z.maxDiscount,")"]}):Object(p.jsx)(p.Fragment,{children:"flat"})]}):Object(p.jsx)("label",{children:"Coupon"}),!te&&!Z&&Object(p.jsx)("button",{onClick:function(){return ce(!0)},children:"Add Coupon"}),Z&&Object(p.jsxs)("span",{children:["\u20b9",se]}),te&&Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/getCoupon/".concat(V)).then((function(e){return e.json()})).then((function(e){var t,c=e.code,n=e.coupon;"ok"===c?n.sellers&&0!==(null===(t=n.sellers)||void 0===t?void 0:t.filter((function(e){return e===b._id})).length)?ie<n.threshold?F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsxs)("h4",{children:["Coupon code ",V," can only be applied on order more that \u20b9",n.threshold,"."]})]})]})):n.usage>=n.validPerUser?F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsxs)("h4",{children:["Each user can use this Coupon"," ",n.validPerUser," times."]})]})]})):(Q(n),ce(!1),F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.C,{}),Object(p.jsxs)("h4",{children:["Coupon code ",V," has been applied."]})]})]}))):F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"This seller does not accept this coupon code."})]})]})):F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Invalid Coupon code."})]})]}))})).catch((function(e){console.log(e),F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not apply Coupon code. Make sure you're online."})]})]}))}))},children:[Object(p.jsx)("input",{required:!0,value:V,onBlur:function(e){V||ce(!1)},onChange:function(e){return G(e.target.value.toUpperCase())}}),Object(p.jsx)("button",{children:"Apply"})]})]}),Object(p.jsx)("hr",{}),Object(p.jsxs)("p",{children:[Object(p.jsx)("label",{children:"Shipping"}),"\u20b9",null===(c=b.shopInfo)||void 0===c?void 0:c.shippingCost]}),Object(p.jsxs)("p",{children:[Object(p.jsxs)("label",{children:["Delivery Pay Fee ",N.fee,"%"]}),"\u20b9",le]}),Object(p.jsx)("hr",{}),Object(p.jsxs)("p",{children:[Object(p.jsx)("label",{children:"Grand total"}),"\u20b9",ie+le]})]}),Object(p.jsxs)("div",{className:"terms",children:[Object(p.jsxs)("p",{children:[Object(p.jsx)("label",{children:"Refundable: "}),(null===(n=b.shopInfo)||void 0===n?void 0:n.refundable)||"N/A"]}),Object(p.jsxs)("p",{children:["By proceeding, I agree to seller's all"," ",Object(p.jsx)("span",{className:"btn",onClick:function(){return L(!0)},children:"Terms"})]})]})]}),Object(p.jsx)("span",{className:"devider"}),Object(p.jsxs)("div",{className:"deliveryDetail",children:[Object(p.jsxs)("div",{className:"head",children:[Object(p.jsx)("h3",{children:"Delivery Information"}),Object(p.jsx)("button",{onClick:function(){return A(!0)},children:"Edit"})]}),Object(p.jsx)("ul",{children:Object.entries(_).map((function(e,t){var c=Object(r.a)(e,2),n=c[0],s=c[1];return Object(p.jsxs)("li",{children:[Object(p.jsx)("label",{children:n}),s]},t)}))})]})]}),Object(p.jsx)("div",{className:"actions",children:Object(p.jsx)("button",{onClick:function(){return U(!0)},children:"Place order"})}),Object(p.jsx)(h.Modal,{open:I,head:!0,label:"Delivery Address",setOpen:A,className:"addAddress",children:Object(p.jsx)(d.AddressForm,{client:{name:_.name,phone:_.phone,address:_},onSuccess:function(e){T((function(t){return Object(l.a)(Object(l.a)({},t),e.address)})),A(!1)},onCancel:function(){return A(!1)}})}),Object(p.jsx)(h.Modal,{className:"milestoneRequest",head:!0,label:"Checkout",open:E,setOpen:U,children:Object(p.jsx)(g,{action:"create",client:b,definedAmount:ie+le,order:Object(l.a)({products:x,deliveryDetail:Object(l.a)(Object(l.a)({},_),{},{deliveryWithin:null===(s=b.shopInfo)||void 0===s?void 0:s.deliveryWithin})},Z&&{couponCode:null===Z||void 0===Z?void 0:Z.code}),onSuccess:function(e){e.milestone;var t=e.order;y((function(e){return e.filter((function(e){var c=e.product;return!t.products.some((function(e){return e.product._id===c._id}))}))})),U(!1),F(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.C,{}),Object(p.jsx)("h4",{children:"Order successfully submitted."}),Object(p.jsx)(O.b,{to:"/account/myShopping/orders",children:"View All orders"})]})]}))}})}),Object(p.jsx)(h.Modal,{open:z,setOpen:L,head:!0,label:"Seller's Terms",className:"shopTerms",children:Object(p.jsx)("ul",{children:null===(i=b.shopInfo)||void 0===i||null===(a=i.terms)||void 0===a?void 0:a.map((function(e,t){return Object(p.jsx)("li",{children:e},t)}))})}),Object(p.jsx)(h.Modal,{className:"msg",open:S,children:S})]}),m&&Object(p.jsx)("div",{className:"spinnerContainer",children:Object(p.jsx)("div",{className:"spinner"})})]})},w=function(e){var t,c=e.product,n=e.gst,s=e.qty,i=Object(o.useContext)(u.d).setCart,a=Object(j.K)({product:c,gst:n||(null===(t=c.user)||void 0===t?void 0:t.gst)});return Object(p.jsxs)("li",{className:"item ".concat(!c.images.length&&"noImg"),children:[Object(p.jsx)(j.n,{src:c.images[0]||"/open_box.png"}),Object(p.jsxs)("div",{className:"detail",children:[Object(p.jsx)("p",{className:"name",children:c.name}),Object(p.jsxs)("div",{className:"qty",children:["QTY:"," ",Object(p.jsxs)("div",{className:"addRemove",children:[Object(p.jsx)("button",{onClick:function(){i((function(e){return e.map((function(e){return e.product._id===c._id?Object(l.a)(Object(l.a)({},e),{},{qty:e.qty-1}):e})).filter((function(e){return e.qty>0}))}))},children:Object(p.jsx)(j.r,{})}),s,Object(p.jsx)("button",{onClick:function(){i((function(e){return e.map((function(e){return e.product._id===c._id?Object(l.a)(Object(l.a)({},e),{},{qty:e.qty+1}):e}))}))},children:Object(p.jsx)(j.v,{})})]})]})]}),Object(p.jsxs)("div",{className:"price",children:[Object(p.jsxs)("span",{className:"qty",children:[a," x ",s]}),"\u20b9",(a*s).fix()]}),(null===n||void 0===n?void 0:n.verified)&&Object(p.jsxs)(j.E,{children:["Including ",c.gst,"% GST."]})]})};t.default=function(e){var t,c=e.history,n=e.location,d=(e.match,Object(o.useContext)(u.d).userType),O=Object(o.useState)(!1),x=Object(r.a)(O,2),m=x[0],f=x[1],g=Object(j.M)({rootMargin:"100px"}),C=Object(r.a)(g,2),k=C[0],S=C[1],F=Object(o.useRef)([{label:"Newest first",value:{column:"createdAt",order:"dsc"}},{label:"Oldest first",value:{column:"createdAt",order:"asc"}},{label:"Price high-low",value:{column:"price",order:"dsc"}},{label:"Price low-high",value:{column:"price",order:"asc"}}]),M=Object(o.useState)([]),w=Object(r.a)(M,2),P=w[0],_=w[1],T=Object(o.useState)(0),D=Object(r.a)(T,2),q=D[0],I=D[1],A=Object(o.useState)(!1),R=Object(r.a)(A,2),B=(R[0],R[1],Object(o.useState)(v.a.parse(n.search).type||"")),E=Object(r.a)(B,2),U=E[0],J=(E[1],Object(o.useState)(v.a.parse(n.search).perPage||20)),K=Object(r.a)(J,2),z=K[0],L=(K[1],Object(o.useState)(1)),Y=Object(r.a)(L,2),H=Y[0],V=Y[1],G=Object(o.useState)(v.a.parse(n.search).q||""),W=Object(r.a)(G,2),X=W[0],Z=W[1],Q=Object(o.useState)({column:v.a.parse(n.search).sort||"createdAt",order:v.a.parse(n.search).order||"dsc"}),$=Object(r.a)(Q,2),ee=$[0],te=$[1],ce=Object(o.useState)([]),ne=Object(r.a)(ce,2),se=ne[0],ie=ne[1],le=Object(o.useState)(null),ae=Object(r.a)(le,2),re=ae[0],oe=ae[1],je=Object(o.useState)(""),de=Object(r.a)(je,2),ue=de[0],be=de[1],Oe=Object(o.useState)(v.a.parse(n.search).seller),he=Object(r.a)(Oe,2),xe=he[0],me=(he[1],Object(o.useState)(null)),ve=Object(r.a)(me,2),pe=ve[0],fe=ve[1],ge=Object(o.useState)(!1),ye=Object(r.a)(ge,2),Ne=(ye[0],ye[1]),Ce=Object(o.useState)(!1),ke=Object(r.a)(Ce,2),Se=ke[0],Fe=ke[1];return Object(o.useEffect)((function(){fetch("/api/getProducts?".concat(n.search.replace("?",""),"&page=",1)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(I(e.total),ie(e.products),e.seller?(fe(e.seller),e.categories&&_(e.categories)):fe(null)):oe(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return oe(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get products. Please try again."})]})]}))})).catch((function(e){console.log(e,156),oe(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return oe(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get products. Make sure you're online."})]})]}))}))}),[n.search]),Object(o.useEffect)((function(){c.replace({pathname:c.location.pathname,search:"?"+new URLSearchParams(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({},xe&&{seller:xe}),X.length>=4&&{q:X}),{},{perPage:z,sort:ee.column,order:ee.order},U&&{type:U}),ue&&{category:ue})).toString()})}),[H,X,ee,xe,U,ue]),Object(o.useEffect)((function(){S&&q>se.length&&(Ne(!0),fetch("/api/getProducts".concat(n.search,"&page=").concat(H+1)).then((function(e){return e.json()})).then((function(e){Ne(!1),"ok"===e.code?e.products.length&&(ie((function(t){return[].concat(Object(a.a)(t),Object(a.a)(e.products))})),V((function(e){return e+1}))):oe(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return oe(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get products. Please try again."})]})]}))})).catch((function(e){Ne(!1),console.log(e),oe(Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return oe(null)},children:"Okay"}),Object(p.jsxs)("div",{children:[Object(p.jsx)(j.i,{}),Object(p.jsx)("h4",{children:"Could not get products. Make sure you're online."})]})]}))})))}),[S]),Object(o.useEffect)((function(){navigator.share&&f(!0)}),[]),Object(p.jsxs)("div",{className:"generic marketplace ".concat(Se?"chatOpen":""),children:[Object(p.jsx)(j.m,{}),"seller"===d&&Object(p.jsx)(b.a,{to:"/account/myShop/products"}),Object(p.jsx)("div",{style:{display:"none"},children:Object(p.jsx)(j.H,{})}),Object(p.jsx)("div",{className:"benner",children:Object(p.jsx)("h1",{children:"Delivery Pay Marketplace"})}),Object(p.jsxs)("div",{className:"content",children:[Object(p.jsxs)("div",{className:"mainContent",children:[pe&&Object(p.jsxs)("div",{className:"sellerDetail",children:[(null===pe||void 0===pe?void 0:pe.profileImg)&&Object(p.jsx)(j.n,{className:"logo",src:"/profile-user.jpg"}),Object(p.jsx)("p",{children:(null===(t=xe.shopInfo)||void 0===t?void 0:t.shopName)||pe.firstName+" "+pe.lastName})]}),Object(p.jsxs)("div",{className:"filters",children:[Object(p.jsxs)("section",{className:"categories",children:[Object(p.jsx)("label",{children:"Category"}),Object(p.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""}].concat(Object(a.a)(P.map((function(e){return{label:e,value:e}})))),onChange:function(e){be(e.value)}})]}),Object(p.jsxs)("section",{className:"search",children:[Object(p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(p.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(p.jsx)("input",{value:X,onChange:function(e){Z(e.target.value)},placeholder:"Search for products or services"}),X&&Object(p.jsx)("button",{onClick:function(){return Z("")},children:Object(p.jsx)(j.H,{})})]}),Object(p.jsxs)("section",{className:"sort",children:[Object(p.jsx)("label",{children:"Sort by:"}),Object(p.jsx)(j.h,{defaultValue:F.current.find((function(e){return e.value.column===ee.column&&e.value.order===ee.order})),options:F.current,onChange:function(e){return te(e.value)}})]}),m&&Object(p.jsx)("section",{className:"share",children:Object(p.jsx)("button",{onClick:Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.share({title:"Delivery Pay | ".concat(pe?"".concat(pe.firstName+" "+pe.lastName):"Marketplace"),url:window.location.href});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])}))),children:"Share this page"})})]}),Object(p.jsxs)("div",{className:"products ".concat(0===se.length?"empty":""),children:[se.map((function(e){return Object(p.jsx)(N,{data:e},e._id)})),q>se.length&&Object(p.jsx)("div",{className:"placeholder",children:"Loading"}),0===se.length&&Object(p.jsxs)("div",{className:"placeholder",children:[Object(p.jsx)(j.n,{src:"/open_box.png"}),Object(p.jsx)("p",{children:"No Product Found"})]})]})]}),Object(p.jsx)(h.Modal,{className:"msg",open:re,children:re})]}),Object(p.jsx)("div",{ref:k}),pe&&Object(p.jsx)(y,{client:pe,onToggle:Fe}),Object(p.jsx)(j.l,{})]})}}}]);
//# sourceMappingURL=3.a09317aa.chunk.js.map