(this["webpackJsonpdeliveryPay-react"]=this["webpackJsonpdeliveryPay-react"]||[]).push([[12,20,39],{160:function(e,t,n){"use strict";n.r(t),n.d(t,"updateProfileInfo",(function(){return O}));var c=n(23),s=n.n(c),r=n(10),a=n(47),i=n(3),l=n(28),o=n(1),d=n(12),j=n(161),u=n(17),b=n(8),h=n(0);function O(e){return f.apply(this,arguments)}function f(){return(f=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(r.a)({},t))}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(197);var x=function(e){var t=e.method,n=e.setMsg,c=Object(o.useContext)(d.d).setUser,s=Object(o.useState)(!1),a=Object(i.a)(s,2),l=a[0],O=a[1],f=Object(o.useCallback)((function(e){fetch("/api/deletePaymentMethod",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e._id})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?c((function(t){return Object(r.a)(Object(r.a)({},t),{},{paymentMethods:t.paymentMethods.filter((function(t){return t._id!==e._id}))})})):n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Payment method could not be deleted."})]})]}))}))}),[]);return Object(h.jsxs)("li",{children:[Object(h.jsxs)("div",{className:"actions",children:[Object(h.jsx)("button",{className:"edit",onClick:function(){return O(t.__t)},children:"Edit"}),Object(h.jsx)("button",{className:"delete",onClick:function(){return Object(u.Confirm)({label:"Payment method delete",question:"Do you want to delete this payment method?",callback:function(){return f(t)}})},children:"Delete"})]}),"BankCard"===t.__t&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.BankCard,{card:t}),l===t.__t&&Object(h.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:O,className:"editPaymentMethod",children:Object(h.jsx)(j.BankCardForm,{prefill:t,onSuccess:function(e){e&&(O(!1),n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.D,{}),Object(h.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]}),"BankAccount"===t.__t&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.BankAccount,{account:t}),l===t.__t&&Object(h.jsx)(u.Modal,{open:l,head:!0,label:"Edit Payment Method",setOpen:O,className:"editPaymentMethod",children:Object(h.jsx)(j.NetBankingForm,{prefill:t,onSuccess:function(e){e&&(O(!1),n(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.D,{}),Object(h.jsx)("h4",{children:"Payment method updated."})]})]})))}})})]})]})},p=function(e){var t=e.label,n=e.fields,c=e.value,r=e.onError,j=e.setMsg,u=e.formData,O=Object(o.useContext)(d.d).setUser,f=Object(o.useState)(!1),x=Object(i.a)(f,2),p=x[0],m=x[1],v=Object(o.useRef)(null),g=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c,l,o,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n={},c=Object(a.a)(new FormData(t.target).entries());try{for(c.s();!(l=c.n()).done;)o=Object(i.a)(l.value,2),d=o[0],h=o[1],n[d]=h}catch(s){c.e(s)}finally{c.f()}if(!n.password||n.password===n.confirm_password){e.next=7;break}return null===r||void 0===r||r(),e.abrupt("return");case 7:if(n["address.city"]&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,c=e.coords.longitude;n["address.location"]={type:"Point",coordinates:[c,t]}})),!n["kyc.files"]){e.next=15;break}return e.next=11,Object(b.G)({files:u,setMsg:j});case 11:if(e.t0=e.sent,e.t0){e.next=14;break}e.t0=[];case 14:n["kyc.files"]=e.t0;case 15:if(!n["gst.detail.files"]){e.next=22;break}return e.next=18,Object(b.G)({files:u,setMsg:j});case 18:if(e.t1=e.sent,e.t1){e.next=21;break}e.t1=[];case 21:n["gst.detail.files"]=e.t1;case 22:fetch("/api/editUserProfile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){var t=e.user;t?(O(t),m(!1)):alert("someting went wrong")})).catch((function(e){console.log(e),alert("someting went wrong")}));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("li",{children:[Object(h.jsx)("p",{className:"label",children:t}),Object(h.jsxs)("form",{ref:v,onSubmit:g,children:[p?Object(h.jsx)("div",{className:"inputs",children:n}):Object(h.jsx)("div",{className:"currentValue",children:c}),Object(h.jsx)("div",{className:"btns",children:p?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{type:"submit",children:"Save changes"},"submit"),Object(h.jsx)("button",{type:"button",onClick:function(){return m(!1)},children:"Cancel"},"cancel")]}):Object(h.jsx)("button",{type:"button",onClick:function(){return m(!0)},children:"Edit"},"edit")})]})]})};t.default=function(e){e.history,e.match,e.location;var t,n,c,s,l,j,f,m,v=Object(o.useContext)(d.d),g=v.user,y=v.setUser,k=Object(o.useState)(!1),C=Object(i.a)(k,2),M=C[0],N=C[1],S=Object(o.useState)(null),F=Object(i.a)(S,2),_=F[0],P=F[1],D=Object(o.useState)([]),w=Object(i.a)(D,2),A=w[0],T=w[1],I=Object(o.useState)([]),Y=Object(i.a)(I,2);Y[0],Y[1];return Object(h.jsxs)("div",{className:"profileContainer",children:[Object(h.jsxs)("div",{className:"benner",children:[Object(h.jsxs)("div",{className:"profileImg",children:[Object(h.jsx)(b.n,{src:g.profileImg||"/profile-user.jpg"}),Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"91.832",height:"25.468",viewBox:"0 0 91.832 25.468",children:Object(h.jsxs)("g",{id:"Path_1937","data-name":"Path 1937",transform:"translate(15.429 -9.647)",fill:"#fff",children:[Object(h.jsx)("path",{d:"M 29.79687690734863 34.6146240234375 C 22.21588897705078 34.6146240234375 13.43720626831055 32.0111198425293 5.0779709815979 27.28368377685547 C -2.8753981590271 22.78578186035156 -9.78753662109375 16.7585563659668 -14.48426628112793 10.24203777313232 C -13.95890235900879 10.24473857879639 -13.30369663238525 10.25548648834229 -12.80753517150879 10.26361274719238 C -12.44524097442627 10.26955413818359 -12.15906429290771 10.27424812316895 -12.02891159057617 10.27424812316895 C -11.93940830230713 10.27424812316895 -11.86373233795166 10.26253128051758 -11.79978466033936 10.24241733551025 C -11.48864650726318 10.21196746826172 -10.04010391235352 10.17821311950684 -5.149840831756592 10.17821311950684 C -1.226676225662231 10.17821311950684 4.093100070953369 10.19837760925293 9.725229263305664 10.21973037719727 C 16.20444107055664 10.24428367614746 23.54814720153809 10.27211856842041 29.79687690734863 10.27211856842041 C 31.89767646789551 10.27211856842041 43.68988800048828 10.22107124328613 56.17448806762695 10.16702461242676 L 59.24650192260742 10.15374183654785 C 60.32665252685547 10.14907169342041 61.61424255371094 10.14680099487305 63.18285369873047 10.14680099487305 C 64.99295043945313 10.14680099487305 66.92156219482422 10.14978885650635 68.78666687011719 10.15269470214844 C 70.55825042724609 10.1554479598999 72.23158264160156 10.15804767608643 73.72422027587891 10.15804767608643 C 74.4501953125 10.15804767608643 75.08247375488281 10.1574182510376 75.63590240478516 10.15613842010498 C 74.24596405029297 13.15391826629639 71.95748138427734 16.1362361907959 68.82386779785156 19.03109550476074 C 65.67525482177734 21.9398250579834 61.6738166809082 24.71903610229492 57.25215911865234 27.06828308105469 C 52.91740798950195 29.37135314941406 48.15610122680664 31.27616500854492 43.48295974731445 32.57678985595703 C 38.69290161132813 33.90995407104492 33.96032333374023 34.6146240234375 29.79687690734863 34.6146240234375 Z",stroke:"none"}),Object(h.jsx)("path",{d:"M 63.18235397338867 10.64679336547852 C 61.61428070068359 10.64679336547852 60.32755279541016 10.64906692504883 59.24865341186523 10.65373229980469 L 56.18099212646484 10.6670036315918 C 43.69374084472656 10.72105407714844 31.89901733398438 10.77211761474609 29.79687881469727 10.77211761474609 C 23.54719161987305 10.77211761474609 16.2029914855957 10.74428176879883 9.723331451416016 10.71971893310547 C 4.091693878173828 10.69837951660156 -1.227619171142578 10.67821884155273 -5.149848937988281 10.67821884155273 C -9.844169616699219 10.67821884155273 -11.33226013183594 10.70873641967773 -11.7083740234375 10.73677062988281 C -11.80277252197266 10.76053237915039 -11.90915679931641 10.77424240112305 -12.0289306640625 10.77424240112305 C -12.16323089599609 10.77424240112305 -12.45131683349609 10.7695198059082 -12.81605529785156 10.76354217529297 C -13.01943206787109 10.76021194458008 -13.24966430664063 10.75643920898438 -13.48653411865234 10.75296401977539 C -8.851593017578125 16.903076171875 -2.239547729492188 22.57095718383789 5.324104309082031 26.84845542907715 C 13.60947799682617 31.53411865234375 22.30074310302734 34.11461639404297 29.79687881469727 34.11461639404297 C 33.91565704345703 34.11461639404297 38.60186767578125 33.41628265380859 43.34890747070313 32.0950927734375 C 47.98773193359375 30.80401802062988 52.71426773071289 28.91309356689453 57.0175666809082 26.62672996520996 C 61.40182876586914 24.29735565185547 65.3670654296875 21.5438175201416 68.48458099365234 18.6638298034668 C 71.32099151611328 16.04351997375488 73.45128631591797 13.35661125183105 74.83492279052734 10.65748596191406 C 74.4908447265625 10.65786743164063 74.12125396728516 10.65805435180664 73.72370147705078 10.65805435180664 C 72.23068237304688 10.65805435180664 70.55716705322266 10.65545654296875 68.78539276123047 10.65269470214844 C 66.92047119140625 10.6497917175293 64.9920654296875 10.64679336547852 63.18235397338867 10.64679336547852 M 63.18235778808594 9.646797180175781 C 66.69034576416016 9.646797180175781 70.639892578125 9.658050537109375 73.72370910644531 9.658050537109375 C 74.72272491455078 9.658050537109375 75.63052368164063 9.656867980957031 76.4033203125 9.653743743896484 C 70.7041015625 23.3221435546875 47.19384002685547 35.11461639404297 29.79687881469727 35.11461639404297 C 13.80905532836914 35.11461639404297 -5.7138671875 23.84020614624023 -15.427734375 9.772117614746094 C -15.45098876953125 9.749141693115234 -15.14891815185547 9.741405487060547 -14.71451568603516 9.741401672363281 C -13.8193359375 9.741401672363281 -12.36181640625 9.774246215820313 -12.02893829345703 9.774246215820313 C -11.98212432861328 9.774246215820313 -11.95759582519531 9.773597717285156 -11.9599609375 9.772117614746094 C -12.07225799560547 9.701694488525391 -9.402595520019531 9.678211212158203 -5.14984130859375 9.678211212158203 C 3.356430053710938 9.678211212158203 18.19854354858398 9.772117614746094 29.79687881469727 9.772117614746094 C 32.07231903076172 9.772117614746094 46.01445388793945 9.710941314697266 59.24433135986328 9.653743743896484 C 60.42824935913086 9.648624420166016 61.76977157592773 9.646797180175781 63.18235778808594 9.646797180175781 Z",stroke:"none",fill:"#336cf9"})]})}),Object(h.jsx)("input",{type:"file",accept:".jpg, .png, .jpeg",onChange:function(e){var t=e.target.files[0],n="https://cdn.deliverypay.in";if(t){var c,s=new FormData,i=Object(a.a)(e.target.files);try{for(i.s();!(c=i.n()).done;){var l=c.value;s.append("file",l)}}catch(o){i.e(o)}finally{i.f()}fetch("".concat(n,"/upload"),{method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?O({profileImg:n+"/"+e.files[0]}).then((function(e){e.user&&y((function(t){return Object(r.a)(Object(r.a)({},t),{},{profileImg:e.user.profileImg})}))})):P(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return P(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Image upload failed"})]})]}))})).catch((function(e){P(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return P(null)},children:"Okay"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(b.i,{}),Object(h.jsx)("h4",{children:"Image upload failed. Make sure you're online."})]})]}))}))}}}),Object(h.jsx)("label",{children:"Edit"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{className:"name",children:g.firstName+" "+g.lastName}),Object(h.jsxs)("p",{className:"id",children:["Delivery pay ID: ",g.userId||g._id]})]})]}),Object(h.jsxs)("div",{className:"settings",children:[Object(h.jsx)("div",{className:"head",children:"Account Settings"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)(p,{label:"Name",fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"First name",defaultValue:g.firstName,name:"firstName",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"last name",defaultValue:g.lastName,name:"lastName",required:!0})})]}),value:g.firstName+" "+g.lastName}),Object(h.jsx)(p,{label:"Phone Number",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Phone Number",defaultValue:g.phone,name:"phone",required:!0,pattern:"^(\\+91|91|1|)\\d{10}$"})})}),value:g.phone}),Object(h.jsx)(p,{label:"Email",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"email",placeholder:"Phone Number",defaultValue:g.email,name:"email",required:!0})})}),value:g.email}),Object(h.jsx)(p,{label:"Password",onError:function(){return N(!0)},fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Password",name:"password",required:!0,type:"password",onChange:function(e){return N(!1)}})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Confirm password",name:"confirm_password",required:!0,type:"password",onChange:function(e){return N(!1)}})}),M&&Object(h.jsx)("p",{className:"errMsg",children:"Password did not match."})]}),value:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),Object(h.jsx)(p,{label:"Gender",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{placeholder:"Gender",defaultValue:g.gender,name:"gender",required:!0})})}),value:g.gender}),Object(h.jsx)(p,{label:"Age",fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"number",placeholder:"Age",defaultValue:g.age,name:"age",required:!0})})}),value:g.age}),Object(h.jsx)(p,{label:"Address",fields:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"Address",defaultValue:g.address.street,name:"address.street",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"City",defaultValue:g.address.city,name:"address.city",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"text",placeholder:"State",defaultValue:g.address.state,name:"address.state",required:!0})}),Object(h.jsx)("section",{children:Object(h.jsx)("input",{type:"number",placeholder:"PIN Code",defaultValue:g.address.zip,name:"address.zip",required:!0})})]}),value:"".concat((null===(t=g.address)||void 0===t?void 0:t.street)||""," ").concat((null===(n=g.address)||void 0===n?void 0:n.city)||""," ").concat((null===(c=g.address)||void 0===c?void 0:c.state)||""," ").concat((null===(s=g.address)||void 0===s?void 0:s.zip)||"")})]})]}),Object(h.jsxs)("div",{className:"kyc",children:[Object(h.jsx)("div",{className:"head",children:"KYC"}),Object(h.jsx)("ul",{children:Object(h.jsx)(p,{label:"KYC",setMsg:P,formData:A,fields:Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("section",{children:[Object(h.jsx)("label",{children:"Upload files for verification."}),Object(h.jsx)(b.k,{multiple:!0,prefill:null===(l=g.kyc)||void 0===l?void 0:l.files,name:"kyc.files",onChange:function(e){return T(e)}})]})}),value:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("p",{children:["Status: ",(null===(j=g.kyc)||void 0===j?void 0:j.verified)?"Verified":"Unverified"]}),Object(h.jsx)("label",{children:"Files for verification:"}),Object(h.jsx)("ul",{className:"thumbs",children:Object(h.jsx)(b.q,{links:null===(f=g.kyc)||void 0===f?void 0:f.files})})]})})})]}),Object(h.jsxs)("div",{className:"paymentMethods",children:[Object(h.jsx)("div",{className:"head",children:"Payment Methods"}),Object(h.jsxs)("ul",{className:"methods",children:[g.paymentMethods.map((function(e,t){return Object(h.jsx)(x,{setMsg:P,method:e},t)})),0===(null===(m=g.paymentMethods)||void 0===m?void 0:m.length)&&Object(h.jsx)("p",{children:"No payment method added."})]})]}),Object(h.jsx)(u.Modal,{className:"msg",open:_,children:_})]})}},171:function(e,t,n){"use strict";n.r(t);var c=n(13),s=n(10),r=n(3),a=n(23),i=n.n(a),l=n(28),o=n(1),d=n(12),j=n(8),u=n(17),b=n(4),h=n(2),O=n(174),f=n(0),x=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,159)).then((function(e){return{default:e.MilestoneForm}}))})),p=function(e){var t=e.order,n=e.setOrders,a=e.selectAll,i=e.setBatch,l=e.batch,O=Object(o.useRef)(),x=Object(o.useRef)(),p=Object(b.g)(),m=(Object(o.useContext)(d.d).user,Object(o.useState)(a||!1)),v=Object(r.a)(m,2),g=v[0],y=v[1],k=Object(o.useState)(!1),C=Object(r.a)(k,2),M=(C[0],C[1],Object(o.useState)(!1)),N=Object(r.a)(M,2),S=N[0],F=N[1],_=function(){fetch("/api/declineOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?n((function(n){return n.map((function(n){var c;return n._id===t._id?Object(s.a)(Object(s.a)({},n),{},{status:null===(c=e.order)||void 0===c?void 0:c.status}):n}))})):F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))},P=function(){fetch("/api/acceptOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?n((function(n){return n.map((function(n){var c;return n._id===t._id?Object(s.a)(Object(s.a)({},n),{},{status:null===(c=e.order)||void 0===c?void 0:c.status}):n}))})):F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not accept order. Make sure you're online."})]})]}))}))},D=function(){fetch("/api/requestCancellation",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?n((function(n){return n.map((function(n){var c;return n._id===t._id?Object(s.a)(Object(s.a)({},n),{},{status:null===(c=e.order)||void 0===c?void 0:c.status}):n}))})):F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not cancel order. Please try again."})]})]}))})).catch((function(e){console.log(e),F(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return F(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not cancel order. Make sure you're online"})]})]}))}))};return Object(o.useEffect)((function(){y(a)}),[a]),Object(o.useEffect)((function(){i(g?function(e){return[].concat(Object(c.a)(e),[t._id])}:function(e){return e.filter((function(e){return e!==t._id}))})}),[g]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("tr",{className:"order ".concat(g?"selected":""),onClick:function(e){e.nativeEvent.path.includes(O.current)||e.nativeEvent.path.includes(x.current)||l.length>0||p.push("/account/myShop/orders/".concat(t._id))},children:[Object(f.jsx)("td",{children:t._id}),Object(f.jsx)("td",{className:"date",children:Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:t.createdAt})}),Object(f.jsxs)("td",{children:["\u20b9",t.total]}),Object(f.jsx)("td",{children:t.status}),Object(f.jsx)("td",{ref:O,children:0===l.length&&Object(f.jsxs)(j.a,{icon:Object(f.jsx)(j.g,{}),children:[Object(f.jsx)(h.b,{to:"/account/myShopping/orders/".concat(t._id),children:"View Detail"}),"pending"===t.status&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Accept Order",question:"You sure want to accept this order?",callback:P})},children:"Accept order"}),Object(f.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Order Cancellation",question:"You sure want to cancel this order?",callback:_})},children:"Cancel order"})]}),"approved"===t.status&&Object(f.jsx)(h.b,{to:"#",onClick:function(e){Object(u.Confirm)({label:"Order Cancellation",question:"You sure want to request cancellation for this order?",callback:D})},children:"Request Cancellation"})]})})]}),Object(f.jsx)(u.Modal,{className:"msg",open:S,children:S})]})},m=function(e){var t,n=e.history,a=e.match,i=Object(o.useContext)(d.d),l=i.user,b=i.userType,O=Object(o.useState)(null),p=Object(r.a)(O,2),m=p[0],g=p[1],y=Object(o.useState)(null),k=Object(r.a)(y,2),C=k[0],M=k[1],N=Object(o.useState)((null===(t=l.shopInfo)||void 0===t?void 0:t.shippingCost)||0),S=Object(r.a)(N,2),F=(S[0],S[1]),_=Object(o.useState)(null),P=Object(r.a)(_,2),D=(P[0],P[1],Object(o.useState)("")),w=Object(r.a)(D,2),A=(w[0],w[1],Object(o.useState)(!1)),T=Object(r.a)(A,2),I=T[0],Y=T[1],E=Object(o.useState)(!1),R=Object(r.a)(E,2),q=R[0],B=R[1],U=(Object(o.useRef)(),function(){fetch("/api/acceptOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"approved"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Order approved."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not accept order. Make sure you're online."})]})]}))}))}),L=function(){fetch("/api/declineOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"declined"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Order declined."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not decline order. Make sure you're online."})]})]}))}))},V=function(){fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id,status:"shipped"})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},C),{},{status:"shipped"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Order has been updated. Don't forget to upload proof of shipping below."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Order could not be updated. Try again."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Order could not be updated. Make sure you're online."})]})]}))}))},H=function(){fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:C._id,status:"delivered"})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M((function(e){return Object(s.a)(Object(s.a)({},C),{},{status:"delivered"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Order has been updated. Don't forget to upload proof of delivery below."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Order could not be updated. Try again."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Order could not be updated. Make sure you're online."})]})]}))}))};if(Object(o.useEffect)((function(){fetch("/api/singleOrder?_id=".concat(a.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(M(e.order),F(e.shippingCost)):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Orders does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get order. Make sure you're online."})]})]}))}))}),[]),C){var G,z,J,W,Z,K=C.products.reduce((function(e,t){return(e+Object(j.L)({product:t.product,gst:!0})*t.qty).fix()}),0),Q="percent"===(null===(G=C.coupon)||void 0===G?void 0:G.type)&&Math.min(K/100*C.coupon.amount,C.coupon.maxDiscount)||"flat"===(null===(z=C.coupon)||void 0===z?void 0:z.type)&&(null===(J=C.coupon)||void 0===J?void 0:J.amount)||0;((K-Q+C.shippingCost)/100*C.fee).fix();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"actions",children:[Object(f.jsxs)(h.b,{to:"/account/".concat("seller"===b?"myShop":"myShopping","/orders"),className:"back",children:[Object(f.jsx)(j.c,{}),"Back"]}),"approved"===C.status&&Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Mark Order as Shipped",question:"Did you ship the order?",callback:V})},children:"Mark as Shipped"}),"shipped"===C.status&&Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Mark Order as Delivered",question:"Has the order been delivered?",callback:H})},children:"Mark as Delivered"}),"pending"===C.status&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){Object(u.Confirm)({lable:"Accept Order",question:Object(f.jsx)(f.Fragment,{children:"You sure want to accept this order?"}),callback:U})},children:"Accept"}),Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Decline Order",question:"You sure want to decline this order?",callback:L})},children:"Decline"})]})]}),Object(f.jsxs)("div",{className:"singleOrder",children:[Object(f.jsxs)("div",{className:"summery",children:[Object(f.jsx)("h3",{children:"Order Summery"}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Buyer"}),Object(f.jsx)(j.H,{user:C.buyer})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Order ID"}),C._id]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Status"}),C.status]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Submitted at"}),Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mma",children:C.createdAt})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Note"}),C.note]}),Object(f.jsx)("li",{}),Object(f.jsxs)("li",{className:"devide",children:[Object(f.jsx)("label",{children:"Delivery Address"}),Object(f.jsx)("span",{})]}),Object.entries(C.deliveryDetail).map((function(e,t){var n=Object(r.a)(e,2),c=n[0],s=n[1];return"deliveryWithin"===c?Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Delivery within"}),C.deliveryDetail.deliveryWithin," days"]},t):Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:c}),s]},t)}))]})]}),Object(f.jsxs)("div",{className:"products",children:[Object(f.jsx)("h3",{children:"Products"}),Object(f.jsx)("ul",{children:C.products.map((function(e,t){var n=e.product,c=e.qty,s=e.available;return Object(f.jsxs)("li",{children:[Object(f.jsx)(j.n,{src:n.images[0]||"/open_box.png"}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsx)("p",{children:n.name}),Object(f.jsxs)("p",{className:"qty",children:["QTY: ",c]}),"pending"===C.status&&Object(f.jsxs)("p",{className:"available",children:["Available: ",s.toString()]})]}),Object(f.jsxs)("div",{className:"price",children:[Object(f.jsxs)("span",{children:[Object(j.L)({product:n,gst:!0})," x ",c]}),"\u20b9",(Object(j.L)({product:n,gst:!0})*c).fix()]})]},t)}))}),Object(f.jsxs)("div",{className:"total",children:[Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Total"}),"\u20b9",K]}),C.coupon&&Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"data",children:[Object(f.jsxs)("label",{children:["Coupon Code ",C.coupon.code,Object(f.jsx)("br",{}),"Discount"," ","percent"===C.coupon.type?Object(f.jsxs)(f.Fragment,{children:[C.coupon.amount,"% (Upto \u20b9",C.coupon.maxDiscount,")"]}):Object(f.jsx)(f.Fragment,{children:"flat"})]}),Object(f.jsxs)("span",{children:["\u20b9",Q]})]})}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Shipping"}),"\u20b9",C.shippingCost]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsxs)("label",{children:["Delivery Pay fee ",C.fee,"%"]}),"\u20b9",(C.total-C.total/(C.fee+100)*100).fix()]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Grand Total"}),"\u20b9",C.total.fix()]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"You'll recieve"}),"\u20b9",(C.total/(C.fee+100)*100).fix()]})]})]}),Object(f.jsxs)("div",{className:"milestones",children:[Object(f.jsx)("h3",{children:"Milestones"}),Object(f.jsx)("p",{className:"subtitle",children:"Click to view milestone detail."}),Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:"Date"}),Object(f.jsx)("td",{children:"Descrption"}),Object(f.jsx)("td",{children:"Amount"}),Object(f.jsx)("td",{children:"Status"})]})}),Object(f.jsxs)("tbody",{children:[C.milestones.map((function(e){return Object(f.jsxs)("tr",{onClick:function(){return n.push("/account/hold?q=".concat(e._id))},children:[Object(f.jsx)("td",{children:Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(f.jsx)("td",{children:e.dscr}),Object(f.jsxs)("td",{children:["\u20b9",e.amount]}),Object(f.jsx)("td",{children:e.status})]},e._id)})),0===C.milestones.length&&Object(f.jsx)("tr",{className:"placeholdert",children:Object(f.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(f.jsxs)("div",{className:"delivery",children:[Object(f.jsxs)("h3",{children:["Proof of delivery",("approved"===C.status||"shipped"===C.status)&&Object(f.jsx)("button",{onClick:function(){return B(!0)},children:"Upload proof of delivery"})]}),(null===(W=C.files)||void 0===W?void 0:W.length)>0?Object(f.jsx)("div",{className:"thumbs",children:Object(f.jsx)(j.q,{links:C.files})}):Object(f.jsx)(f.Fragment,{children:"No files added."})]}),Object(f.jsxs)("section",{className:"terms",children:[Object(f.jsx)("h3",{children:"Return Policy Terms"}),Object(f.jsx)("ul",{children:null===(Z=C.terms)||void 0===Z?void 0:Z.map((function(e,t){return Object(f.jsxs)("li",{children:[e," "]},t)}))})]})]}),Object(f.jsx)(u.Modal,{head:!0,label:"Create Milestone",setOpen:Y,className:"milestoneRequest",open:I,children:Object(f.jsx)(x,{action:"request",definedAmount:C.total,client:C.buyer,order:C._id,onSuccess:function(e){Y(!1),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(f.jsx)("h4",{children:"Milestone has been requested"})]}),Object(f.jsx)(h.b,{to:"/account/hold",onClick:function(){return g(null)},children:"Check your Delivery pay Hold"})]})),M((function(t){return Object(s.a)(Object(s.a)({},t),{},{milestones:[].concat(Object(c.a)(t.milestones),[e])})}))}})}),Object(f.jsx)(u.Modal,{head:!0,label:"Upload proof of shipping & delivery",setOpen:B,open:q,className:"fileUpload",children:Object(f.jsx)(v,{order:C,onSuccess:function(e){B(!1),M((function(t){return Object(s.a)(Object(s.a)({},t),{},{files:e.files})}))}})}),Object(f.jsx)(u.Modal,{className:"msg",open:m,children:m})]})}return Object(f.jsx)(f.Fragment,{children:"Loading"})},v=function(e){var t=e.order,n=e.onSuccess,c=Object(o.useState)(!1),s=Object(r.a)(c,2),a=s[0],d=s[1],b=Object(o.useState)([]),h=Object(r.a)(b,2),O=h[0],x=h[1],p=Object(o.useState)(null),m=Object(r.a)(p,2),v=m[0],g=m[1],y=function(){var e=Object(l.a)(i.a.mark((function e(){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d(!0),!O.length){e.next=7;break}return e.next=4,Object(j.G)({files:O,setMsg:g});case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=[];case 8:c=e.t0,fetch("/api/updateOrder",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t._id,files:c})}).then((function(e){return e.json()})).then((function(e){d(!1),"ok"===e.code?null===n||void 0===n||n(e.order):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upload files. Try again."})]})]}))})).catch((function(e){d(!1),console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upload files. Make sure you're online."})]})]}))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(u.Confirm)({title:"Upload Proof of Shipping & Delivery",question:Object(f.jsxs)(f.Fragment,{children:["You sure want to upload these files?",Object(f.jsx)("span",{className:"note",children:"Keep in mind these files can not be deleted later."})]}),callback:y})},children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Upload Images of the products, shipment reciept etc."}),Object(f.jsx)(j.k,{multiple:!0,accept:"image/*",required:!0,onChange:function(e){return x(e)}})]}),Object(f.jsx)("section",{className:"btns",children:Object(f.jsx)("button",{className:"submit",children:"Submit"})})]}),a&&Object(f.jsx)("div",{className:"spinnerContainer",children:Object(f.jsx)("div",{className:"spinner"})}),Object(f.jsx)(u.Modal,{className:"msg",open:v,children:v})]})},g=function(e){e.categories;var t=Object(o.useState)(0),n=Object(r.a)(t,2),c=n[0],a=n[1],i=Object(o.useState)(1),l=Object(r.a)(i,2),d=l[0],b=l[1],h=Object(o.useState)(20),O=Object(r.a)(h,2),x=O[0],m=O[1],v=Object(o.useState)(""),g=Object(r.a)(v,2),y=g[0],k=g[1],C=Object(o.useState)(""),M=Object(r.a)(C,2),N=M[0],S=M[1],F=Object(o.useState)({column:"createdAt",order:"dsc"}),_=Object(r.a)(F,2),P=_[0],D=(_[1],Object(o.useState)(null)),w=Object(r.a)(D,2),A=w[0],T=w[1],I=Object(o.useState)([]),Y=Object(r.a)(I,2),E=Y[0],R=Y[1],q=Object(o.useState)(!1),B=Object(r.a)(q,2),U=B[0],L=B[1],V=Object(o.useState)([]),H=Object(r.a)(V,2),G=H[0],z=H[1],J=Object(o.useState)(null),W=Object(r.a)(J,2),Z=W[0],K=W[1];return Object(o.useEffect)((function(){var e=Object(j.M)({time:null===A||void 0===A?void 0:A.startDate,format:"YYYY-MM-DD"}),t=Object(j.M)({time:null===A||void 0===A?void 0:A.endDate.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getOrders?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)({user:"seller"},N&&{q:N}),{},{page:d,perPage:x,sort:P.column,order:P.order},A&&{dateFrom:e,dateTo:t}),y&&{status:y})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(R(e.orders),a(e.total))})).catch((function(e){console.log(e),K(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return K(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[y,N,d,x,A]),Object(o.useEffect)((function(){U||z([])}),[U]),Object(o.useEffect)((function(){0===G.length&&L(!1)}),[G]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"benner",children:Object(f.jsx)("p",{children:"Order Management"})}),Object(f.jsxs)("div",{className:"filters",children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Total:"}),c]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Per Page:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return m(e.value)}})]}),Object(f.jsxs)("section",{className:"search",children:[Object(f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(f.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(f.jsx)("input",{value:N,onChange:function(e){return S(e.target.value)},placeholder:"Search for Buyer"}),N&&Object(f.jsx)("button",{onClick:function(){return S("")},children:Object(f.jsx)(j.I,{})})]}),Object(f.jsxs)("section",{className:"category",children:[Object(f.jsx)("label",{children:"Status:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Cancelled",value:"cancelled"},{label:"Hold",value:"Hold"},{label:"Shipped",value:"shipped"},{label:"Delivered",value:"delivered"},{label:"Refunded",value:"refunded"}],onChange:function(e){return k(e.value)}})]}),Object(f.jsx)("section",{className:"date",children:Object(f.jsx)(j.o,{dateRange:A,onChange:function(e){return T(e)}})})]}),G.length>0&&Object(f.jsx)("div",{className:"batchAction",children:Object(f.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(f.jsxs)("table",{className:"table orders",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Order"}),Object(f.jsx)("th",{className:"date",children:"Date"}),Object(f.jsx)("th",{children:"Total Price"}),Object(f.jsx)("th",{children:"Status"}),Object(f.jsx)("th",{children:"Actions"})]})}),Object(f.jsxs)("tbody",{children:[E.map((function(e,t){return Object(f.jsx)(p,{order:e,setOrders:R,selectAll:U,setBatch:z,batch:G},t)})),0===E.length&&Object(f.jsx)("tr",{className:"placeholder",children:Object(f.jsx)("td",{children:"No product yet."})})]})]}),Object(f.jsx)(j.u,{total:c,btns:5,currentPage:d,perPage:x,setPage:b}),Object(f.jsx)(u.Modal,{className:"msg",open:Z,children:Z})]})},y=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,159)).then((function(e){return{default:e.MilestoneForm}}))})),k=function(e){var t,n=e.refund,s=(e.setRefunds,e.selectAll),a=e.setBatch,i=(e.batch,Object(b.g)()),l=(Object(o.useContext)(d.d).user,Object(o.useState)(s||!1)),h=Object(r.a)(l,2),O=h[0],x=h[1],p=Object(o.useState)(!1),m=Object(r.a)(p,2),v=(m[0],m[1],Object(o.useState)(!1)),g=Object(r.a)(v,2),y=g[0];g[1];return Object(o.useEffect)((function(){x(s)}),[s]),Object(o.useEffect)((function(){a(O?function(e){return[].concat(Object(c.a)(e),[n._id])}:function(e){return e.filter((function(e){return e!==n._id}))})}),[O]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("tr",{className:"refund ".concat(O?"selected":""),onClick:function(){return i.push("/account/myShop/refunds/".concat(n._id))},children:[Object(f.jsx)("td",{className:"date",children:Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:n.createdAt})}),Object(f.jsx)("td",{children:Object(f.jsx)(j.H,{user:n.seller})}),Object(f.jsx)("td",{children:null===(t=n.order)||void 0===t?void 0:t.products.reduce((function(e,t){return e+t.qty}),0)}),Object(f.jsx)("td",{children:n.status}),Object(f.jsxs)("td",{children:["\u20b9",n.order.total]})]}),Object(f.jsx)(u.Modal,{className:"msg",open:y,children:y})]})},C=function(e){var t,n,a,b=e.history,O=e.match,x=Object(o.useContext)(d.d).userType,p=Object(o.useState)(null),m=Object(r.a)(p,2),v=m[0],g=m[1],k=Object(o.useState)(null),C=Object(r.a)(k,2),M=C[0],N=C[1],S=Object(o.useState)(null),F=Object(r.a)(S,2),_=F[0],P=F[1],D=Object(o.useState)(!1),w=Object(r.a)(D,2),A=w[0],T=w[1],I=Object(o.useState)(!1),Y=Object(r.a)(I,2),E=Y[0],R=Y[1],q=(Object(o.useRef)(),function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/updateRefund",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(s.a)(Object(s.a)({},t),{},{_id:M._id}))}).then((function(e){return e.json()})).then((function(e){if("ok"===e.code)return e.order;g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not update refund. Make sure you're online."})]})]}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),B=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/acceptRefund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:M._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"approved"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Refund request has been approved."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not accept refund request. Make sure you're online."})]})]}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/declineRefund",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:M._id})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(N((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"declined"})})),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Refund request has been declined."})]})]}))):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Refund request does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not decline refund request. Make sure you're online."})]})]}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){fetch("/api/singleRefund?_id=".concat(O.params._id)).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(P(e.refund.order),N(e.refund)):g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Refund does not exist."})]})]}))})).catch((function(e){console.log(e),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get Refund. Make sure you're online."})]})]}))}))}),[]),Object(o.useEffect)((function(){if(null===_||void 0===_?void 0:_.refundable){var e=0;switch(_.refundable){case"Upto 24 Hours After Delivery":e=1;break;case"Upto 7 Days After Delivery":e=7;break;case"Upto 15 Days After Delivery":e=15;break;default:return}var t=new Date((new Date).getTime()+864e5*e);new Date<t?R(t):R(null)}else R(null)}),[M]),M?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"actions",children:[Object(f.jsxs)(h.b,{to:"/account/".concat("seller"===x?"myShop":"myShopping","/refunds"),className:"back",children:[Object(f.jsx)(j.c,{}),"Back"]}),"productSent"===M.status&&Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Refund Resolved",question:"You sure want to mark this refund resolved?",callback:function(){q({status:"productRecieved"}).then((function(e){N((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"productRecieved"})}))}))}})},children:"Mark as Recieved"}),"pending"===M.status&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Refund",question:"Do you accept this refund request?",callback:B})},children:"Accept"}),Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Declining Refund",question:"Do you decline this refund?",callback:U})},children:"Decline"})]})]}),Object(f.jsxs)("div",{className:"singleOrder",children:[Object(f.jsxs)("div",{className:"summery",children:[Object(f.jsx)("h3",{children:"Summery"}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{className:"devide",children:[Object(f.jsx)("label",{children:"Order"}),Object(f.jsx)("span",{})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Seller"}),Object(f.jsx)(j.H,{user:_.seller})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Order ID"}),_._id]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Status"}),_.status]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Ordered at"}),Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mma",children:_.createdAt})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Delivered at"}),Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:_.deliveredAt})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Refundable"}),_.refundable||"N/A"]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Proof of delivery"}),(null===(t=_.files)||void 0===t?void 0:t.length)>0?Object(f.jsx)("div",{className:"thumbs",children:Object(f.jsx)(j.q,{links:_.files})}):Object(f.jsx)(f.Fragment,{children:"No files added."})]}),E&&Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Refund till"}),Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:E})]}),Object(f.jsx)("li",{}),Object(f.jsxs)("li",{className:"devide",children:[Object(f.jsx)("label",{children:"Refund"}),Object(f.jsx)("span",{})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Refund ID"}),M._id]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Status"}),M.status]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Submitted at"}),Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mma",children:M.createdAt})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Issue"}),M.issue]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Descrption"}),M.dscr]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Images"}),Object(f.jsx)("div",{className:"thumbs",children:M.files.length?Object(f.jsx)(j.q,{links:M.files}):Object(f.jsx)(f.Fragment,{children:"No Images has been provided."})})]}),Object(f.jsx)("li",{}),Object(f.jsxs)("li",{className:"devide",children:[Object(f.jsx)("label",{children:"Delivery Address"}),Object(f.jsx)("span",{})]}),Object(f.jsx)(f.Fragment,{children:Object.entries(_.deliveryDetail).map((function(e,t){var n=Object(r.a)(e,2),c=n[0],s=n[1];return"deliveryTime"===c?Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:"Delivery date"}),_.deliveryDetail.deliveryTime?Object(f.jsx)(j.s,{format:"DD MMM, YYYY hh:mma",children:_.deliveryDetail.deliveryTime}):"N/A"]},t):Object(f.jsxs)("li",{children:[Object(f.jsx)("label",{children:c}),s]},t)}))})]})]}),Object(f.jsxs)("div",{className:"products",children:[Object(f.jsx)("h3",{children:"Products"}),Object(f.jsx)("ul",{children:_.products.map((function(e,t){var n=e.product,c=e.qty;return Object(f.jsxs)("li",{children:[Object(f.jsx)(j.n,{src:n.images[0]||"/open_box.png"}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsx)("p",{children:n.name}),Object(f.jsxs)("p",{className:"qty",children:["QTY: ",c]})]}),Object(f.jsxs)("div",{className:"price",children:[Object(f.jsxs)("span",{children:[Object(j.L)({product:n,gst:!0})," x ",c]}),"\u20b9",Object(j.L)({product:n,gst:!0})*c]})]},t)}))}),Object(f.jsxs)("div",{className:"total",children:[Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Total"}),"\u20b9",_.products.reduce((function(e,t){return e+Object(j.L)({product:t.product,gst:!0})*t.qty}),0)]}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Shipping"}),_.shipping||"N/A"]}),Object(f.jsxs)("div",{className:"data",children:[Object(f.jsx)("label",{children:"Grand Total"}),"\u20b9",_.products.reduce((function(e,t){return e+Object(j.L)({product:t.product,gst:!0})*t.qty}),0)+(+_.shipping||0)]})]})]}),Object(f.jsxs)("div",{className:"milestones",children:[Object(f.jsxs)("h3",{children:["Milestones",("approved"===M.status||"productSent"===M.status||"productRecieved"===M.status)&&Object(f.jsx)("button",{onClick:function(){return T(!0)},children:"Create Milestone"})]}),"pending"===M.status&&Object(f.jsx)("p",{children:"You can create milestones once you accept the refund request."}),"declined"===M.status&&Object(f.jsx)("p",{children:"This refund request has been declined."}),!("declined"===M.status||"pending"===M.status)&&Object(f.jsxs)("table",{cellSpacing:0,cellPadding:0,children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:"Date"}),Object(f.jsx)("td",{children:"Descrption"}),Object(f.jsx)("td",{children:"Amount"}),Object(f.jsx)("td",{children:"Status"})]})}),Object(f.jsxs)("tbody",{children:[M.milestones.map((function(e){return Object(f.jsxs)("tr",{onClick:function(){return b.push("/account/hold?q=".concat(e._id))},children:[Object(f.jsx)("td",{children:Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mma",children:e.createdAt})}),Object(f.jsx)("td",{children:e.dscr}),Object(f.jsxs)("td",{children:["\u20b9",e.amount]}),Object(f.jsx)("td",{children:e.status})]},e._id)})),0===M.milestones.length&&Object(f.jsx)("tr",{className:"placeholdert",children:Object(f.jsx)("td",{children:"Nothing yet."})})]})]})]}),Object(f.jsxs)("section",{className:"terms",children:[Object(f.jsx)("h3",{children:"Return Policy Terms"}),Object(f.jsxs)("ul",{children:[null===(n=_.terms)||void 0===n?void 0:n.map((function(e,t){return Object(f.jsx)("li",{children:e},t)})),!(null===(a=_.terms)||void 0===a?void 0:a.length)&&Object(f.jsx)("li",{children:"No terms has been set by the seller yet."})]})]})]}),Object(f.jsx)(u.Modal,{head:!0,label:"Create Milestone",setOpen:T,className:"milestoneRequest",open:A,children:Object(f.jsx)(y,{action:"create",definedAmount:_.total,client:M.seller,refund:M._id,onSuccess:function(e){T(!1),g(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return g(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsxs)("h4",{className:"amount",children:["\u20b9",null===e||void 0===e?void 0:e.amount]}),Object(f.jsx)("h4",{children:"Milestone has been created"})]}),Object(f.jsx)(h.b,{to:"/account/hold",onClick:function(){return g(null)},children:"Check your Delivery pay Hold"})]})),N((function(t){return Object(s.a)(Object(s.a)({},t),{},{milestones:[].concat(Object(c.a)(t.milestones),[e])})}))}})}),Object(f.jsx)(u.Modal,{className:"msg",open:v,children:v})]}):Object(f.jsx)(f.Fragment,{children:"Loading"})},M=function(e){e.history,e.location;var t=Object(o.useContext)(d.d).userType,n=Object(o.useState)(0),c=Object(r.a)(n,2),a=c[0],i=c[1],l=Object(o.useState)(1),b=Object(r.a)(l,2),h=b[0],O=b[1],x=Object(o.useState)(20),p=Object(r.a)(x,2),m=p[0],v=p[1],g=Object(o.useState)(""),y=Object(r.a)(g,2),C=y[0],M=y[1],N=Object(o.useState)(""),S=Object(r.a)(N,2),F=S[0],_=S[1],P=Object(o.useState)({column:"createdAt",order:"dsc"}),D=Object(r.a)(P,2),w=D[0],A=(D[1],Object(o.useState)(null)),T=Object(r.a)(A,2),I=T[0],Y=T[1],E=Object(o.useState)([]),R=Object(r.a)(E,2),q=R[0],B=R[1],U=Object(o.useState)(!1),L=Object(r.a)(U,2),V=L[0],H=L[1],G=Object(o.useState)([]),z=Object(r.a)(G,2),J=z[0],W=z[1],Z=Object(o.useState)(null),K=Object(r.a)(Z,2),Q=K[0],$=K[1];return Object(o.useEffect)((function(){var e,n=Object(j.M)({time:null===I||void 0===I?void 0:I.startDate,format:"YYYY-MM-DD"}),c=Object(j.M)({time:null===(e=new Date(null===I||void 0===I?void 0:I.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/getRefunds?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)({user:t},C&&{q:C}),{},{page:h,perPage:m,sort:w.column,order:w.order},I&&{dateFrom:n,dateTo:c}),F&&{status:F})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(B(e.refunds),i(e.total))})).catch((function(e){console.log(e),$(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return $(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get orders."})]})]}))}))}),[C,h,m,I,F]),Object(o.useEffect)((function(){V||W([])}),[V]),Object(o.useEffect)((function(){0===J.length&&H(!1)}),[J]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"benner",children:Object(f.jsx)("p",{children:"My Refunds"})}),Object(f.jsxs)("div",{className:"filters",children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Total:"}),a]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Per Page:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return v(e.value)}})]}),Object(f.jsxs)("section",{className:"search",children:[Object(f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(f.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(f.jsx)("input",{value:C,onChange:function(e){return M(e.target.value)},placeholder:"Search for Customer"}),C&&Object(f.jsx)("button",{onClick:function(){return M("")},children:Object(f.jsx)(j.I,{})})]}),Object(f.jsxs)("section",{className:"category",children:[Object(f.jsx)("label",{children:"Status:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Product Sent",value:"productSent"},{label:"Product Recieved",value:"productRecieved"},{label:"Resolved",value:"resolved"}],onChange:function(e){return _(e.value)}})]}),Object(f.jsx)("section",{className:"date",children:Object(f.jsx)(j.o,{dateRange:I,onChange:function(e){return Y(e)}})})]}),J.length>0&&Object(f.jsx)("div",{className:"batchAction",children:Object(f.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(f.jsxs)("table",{className:"table refunds",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{className:"date",children:"Date"}),Object(f.jsx)("th",{children:"Customer"}),Object(f.jsx)("th",{children:"QTY"}),Object(f.jsx)("th",{children:"Status"}),Object(f.jsx)("th",{children:"Total Price"})]})}),Object(f.jsxs)("tbody",{children:[q.map((function(e){return Object(f.jsx)(k,{refund:e,setRefunds:B,selectAll:V,setBatch:W,batch:J},e._id)})),0===q.length&&Object(f.jsx)("tr",{className:"placeholder",children:Object(f.jsx)("td",{children:"No product yet."})})]})]}),Object(f.jsx)(j.u,{total:a,btns:5,currentPage:h,perPage:m,setPage:O}),Object(f.jsx)(u.Modal,{className:"msg",open:Q,children:Q})]})},N=(n(46),function(e){var t,n,a,i,l,O,x=e.coupon,p=e.setCoupons,m=e.selectAll,v=e.setBatch,g=e.batch,y=Object(o.useRef)(),k=Object(o.useRef)(),C=(Object(b.g)(),Object(o.useContext)(d.d).user,Object(o.useState)(m||!1)),M=Object(r.a)(C,2),N=M[0],S=M[1],F=Object(o.useState)(!1),_=Object(r.a)(F,2),P=(_[0],_[1],Object(o.useState)(!1)),D=Object(r.a)(P,2),w=D[0],A=D[1],T=Object(o.useState)(!1),I=Object(r.a)(T,2),Y=I[0],E=I[1];return Object(o.useEffect)((function(){S(m)}),[m]),Object(o.useEffect)((function(){v(N?function(e){return[].concat(Object(c.a)(e),[x._id])}:function(e){return e.filter((function(e){return e!==x._id}))})}),[N]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("tr",{className:"coupon ".concat(N?"selected":""),onClick:function(e){e.nativeEvent.path.includes(y.current)||e.nativeEvent.path.includes(k.current)||g.length>0||E(x)},children:[Object(f.jsx)("td",{className:"date",children:Object(f.jsx)(j.s,{format:"DD MMM YY",children:x.createdAt})}),Object(f.jsx)("td",{children:x.title}),Object(f.jsx)("td",{children:x.status}),Object(f.jsx)("td",{children:x.code}),Object(f.jsx)("td",{className:"discount",children:"percent"===x.type?Object(f.jsxs)(f.Fragment,{children:[x.amount,"%",Object(f.jsxs)("span",{children:["Up to \u20b9",x.maxDiscount]})]}):Object(f.jsxs)(f.Fragment,{children:["\u20b9",x.amount]})}),Object(f.jsxs)("td",{children:["\u20b9",x.threshold]}),Object(f.jsxs)("td",{children:[Object(f.jsx)(j.s,{format:"DD MMM YY",children:null===(t=x.date)||void 0===t?void 0:t.from}),"-",Object(f.jsx)(j.s,{format:"DD MMM YY",children:null===(n=x.date)||void 0===n?void 0:n.to})]}),Object(f.jsx)("td",{children:x.accept?"Yes":"No"}),Object(f.jsx)("td",{ref:y,children:0===g.length&&Object(f.jsxs)(j.a,{icon:Object(f.jsx)(j.g,{}),children:[Object(f.jsx)("button",{onClick:function(){return E(x)},children:"View Detail"}),x.accept&&Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Coupon code",question:"You sure want to take part in this campaign and accept this coupon code?",callback:function(){return e=x._id,void fetch("/api/declineCoupon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(p((function(t){return t.map((function(t){return t._id===e?Object(s.a)(Object(s.a)({},t),{},{accept:!1}):t}))})),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Coupon code declined. Buyers can no longer apply this coupon code on your shop."})]})]}))):A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not decline Coupon code. please try again."})]})]}))})).catch((function(e){console.log(e),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not decline Coupon code. Make sure you're online."})]})]}))}));var e}})},children:"Decline"}),new Date(null===(a=x.date)||void 0===a?void 0:a.to)>=new Date(Object(j.M)({time:new Date,format:"YYYY-MM-DD"}))&&!x.accept&&Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Accepting Coupon code",question:"You sure want to take part in this campaign and accept this coupon code?",callback:function(){return e=x._id,void fetch("/api/acceptCoupon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(p((function(t){return t.map((function(t){return t._id===e?Object(s.a)(Object(s.a)({},t),{},{accept:!0}):t}))})),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Coupon code accepted. Now Buyers can apply this coupon code on your shop."})]})]}))):A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not accept Coupon code. please try again."})]})]}))})).catch((function(e){console.log(e),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not accept Coupon code. Make sure you're online."})]})]}))}));var e}})},children:"Accept"})]})})]}),Object(f.jsx)(u.Modal,{className:"msg",open:w,children:w}),Object(f.jsx)(u.Modal,{open:Y,head:!0,label:"Coupon Detail",setOpen:E,className:"couponDetail",children:Object(f.jsxs)("div",{className:"content",children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Campaign Title"}),Object(f.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.title})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Campaign Description"}),Object(f.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.dscr})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Coupon Code"}),Object(f.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.code})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Coupon code status"}),Object(f.jsx)("p",{children:null===Y||void 0===Y?void 0:Y.status})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Discount"}),Object(f.jsx)("p",{children:"percent"===(null===Y||void 0===Y?void 0:Y.type)?Object(f.jsxs)(f.Fragment,{children:[null===Y||void 0===Y?void 0:Y.amount,"% up to \u20b9",Y.maxDiscount]}):Object(f.jsxs)(f.Fragment,{children:["\u20b9",null===Y||void 0===Y?void 0:Y.amount]})})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Validity"}),Object(f.jsxs)("p",{children:[Object(f.jsx)(j.s,{format:"DD MMM YY",children:null===(i=Y.date)||void 0===i?void 0:i.from}),"-",Object(f.jsx)(j.s,{format:"DD MMM YY",children:null===(l=Y.date)||void 0===l?void 0:l.to})]})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Accept"}),Object(f.jsx)("p",{children:Y.accept?"Yes":"No"})]}),Y.termsUrl&&Object(f.jsxs)("section",{className:"termsUrl",children:[Object(f.jsx)("label",{children:"Terms"}),Object(f.jsx)(h.b,{to:Y.termsUrl,target:"_blank",children:"Terms of the Campaign"})]}),(null===(O=Y.terms)||void 0===O?void 0:O.length)?Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Terms"}),Object(f.jsx)("ul",{children:Y.terms.map((function(e,t){return Object(f.jsx)("li",{children:e},t)}))})]}):null]})})]})}),S=function(e){e.categories;var t=Object(o.useState)(0),n=Object(r.a)(t,2),c=n[0],a=n[1],i=Object(o.useState)(1),l=Object(r.a)(i,2),d=l[0],b=l[1],h=Object(o.useState)(20),O=Object(r.a)(h,2),x=O[0],p=O[1],m=Object(o.useState)(""),v=Object(r.a)(m,2),g=v[0],y=v[1],k=Object(o.useState)(""),C=Object(r.a)(k,2),M=C[0],S=C[1],F=Object(o.useState)({column:"createdAt",coupon:"dsc"}),_=Object(r.a)(F,2),P=_[0],D=(_[1],Object(o.useState)([])),w=Object(r.a)(D,2),A=w[0],T=w[1],I=Object(o.useState)(!1),Y=Object(r.a)(I,2),E=Y[0],R=Y[1],q=Object(o.useState)([]),B=Object(r.a)(q,2),U=B[0],L=B[1],V=Object(o.useState)(null),H=Object(r.a)(V,2),G=H[0],z=H[1];return Object(o.useEffect)((function(){fetch("/api/getCoupons?".concat(new URLSearchParams(Object(s.a)(Object(s.a)({},M&&{q:M}),{},{page:d,perPage:x,sort:P.column,order:P.order},g&&{status:g})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(T(e.coupons),a(e.total))})).catch((function(e){console.log(e),z(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return z(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get coupons."})]})]}))}))}),[g,M,d,x]),Object(o.useEffect)((function(){E||L([])}),[E]),Object(o.useEffect)((function(){0===U.length&&R(!1)}),[U]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"benner",children:Object(f.jsx)("p",{children:"Order Management"})}),Object(f.jsxs)("div",{className:"filters",children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Total:"}),c]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Per Page:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return p(e.value)}})]}),Object(f.jsxs)("section",{className:"search",children:[Object(f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(f.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(f.jsx)("input",{value:M,onChange:function(e){return S(e.target.value)},placeholder:"Search for Buyer"}),M&&Object(f.jsx)("button",{onClick:function(){return S("")},children:Object(f.jsx)(j.I,{})})]}),Object(f.jsxs)("section",{className:"category",children:[Object(f.jsx)("label",{children:"Status:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Pending",value:"draft"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],onChange:function(e){return y(e.value)}})]})]}),U.length>0&&Object(f.jsx)("div",{className:"batchAction",children:Object(f.jsx)("button",{onClick:function(){return console.log("batch delete")},children:"Delete"})}),Object(f.jsxs)("table",{className:"table coupons",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{className:"date",children:"Date"}),Object(f.jsx)("th",{children:"Title"}),Object(f.jsx)("th",{children:"Status"}),Object(f.jsx)("th",{children:"Code"}),Object(f.jsx)("th",{children:"Discount"}),Object(f.jsx)("th",{children:"Threshold"}),Object(f.jsx)("th",{children:"Validity"}),Object(f.jsx)("th",{children:"Accept"}),Object(f.jsx)("th",{children:"Actions"})]})}),Object(f.jsxs)("tbody",{children:[A.map((function(e,t){return Object(f.jsx)(N,{coupon:e,setCoupons:T,selectAll:E,setBatch:L,batch:U},t)})),0===A.length&&Object(f.jsx)("tr",{className:"placeholder",children:Object(f.jsx)("td",{children:"No Campaign yet."})})]})]}),Object(f.jsx)(j.u,{total:c,btns:5,currentPage:d,perPage:x,setPage:b}),Object(f.jsx)(u.Modal,{className:"msg",open:G,children:G})]})},F=n(160);n(249);var _=function(e){var t=e.label,n=e.defaultStatus,c=e.children,s=e.disabled,a=e.className,i=e.data,l=(e.step,Object(o.useState)(i?!i:null)),d=Object(r.a)(l,2),u=d[0],b=d[1];return Object(o.useEffect)((function(){b(n)}),[n]),Object(f.jsxs)("div",{className:"step ".concat(u||n?"open":""," ").concat(s?"disabled":""," ").concat(a||""),children:[Object(f.jsxs)("div",{className:"head",onClick:function(){n||b(!u)},children:[Object(f.jsx)(j.g,{className:"chev"})," ",t,Object(f.jsx)("div",{className:"status",children:i&&Object(f.jsx)(j.B,{})})]}),(u||n)&&Object(f.jsx)("div",{className:"body",children:c})]})},P=function(e){var t,n,c=e.setLoading,a=Object(o.useContext)(d.d),i=a.user,l=a.setUser,u=window.FB,b=Object(o.useState)([]),h=Object(r.a)(b,2),O=h[0],x=h[1],p=Object(o.useState)(null),m=Object(r.a)(p,2),v=m[0],g=m[1];return Object(o.useEffect)((function(){var e,t;(null===(e=i.fbMarket)||void 0===e||null===(t=e.business)||void 0===t?void 0:t.id)||u.api("/me","GET",{fields:"businesses{picture{url},name,id,created_time}",access_token:i.fbMarket.user.access_token},(function(e){e.businesses&&x(e.businesses.data)}))}),[i]),Object(f.jsx)(f.Fragment,{children:(null===(t=i.fbMarket)||void 0===t||null===(n=t.businessManager)||void 0===n?void 0:n.id)?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"The Business Manager that owns all your Facebook business accounts."}),Object(f.jsx)("ul",{children:Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:i.fbMarket.businessManager.profileImg}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(i.fbMarket.businessManager.id),children:[i.fbMarket.businessManager.name," ",Object(f.jsx)(j.j,{})]}),Object(f.jsxs)("span",{children:["ID: ",i.fbMarket.businessManager.id]}),Object(f.jsxs)("span",{children:["Created at:"," ",Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:i.fbMarket.businessManager.created_time})]})]})]}),Object(f.jsx)("button",{onClick:function(){Object(F.updateProfileInfo)({"fbMarket.businessManager":{},"fbMarket.facebookPage":{},"fbMarket.commerceAccount":{},"fbMarket.userAgreement":!1}).then((function(e){var t=e.user;l((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},className:"btn",children:"Disconnect"})]})})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"Connect the Business Manager you use to manage your business Page, accounts, and product catalog. You can only connect a Business Manager you have admin access to."}),Object(f.jsx)("p",{className:"note",children:"After you connect, you may receive a verification email from Facebook. If so, you\u2019ll need to confirm your business email address before proceeding."}),v&&Object(f.jsx)("div",{className:"err",children:v}),Object(f.jsxs)("ul",{children:[O.map((function(e,t){return Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:e.picture.data.url}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(e.business_id,"&asset_id=").concat(e.asset_id),children:[e.name," ",Object(f.jsx)(j.j,{})]}),Object(f.jsxs)("span",{children:["ID: ",e.id]}),Object(f.jsxs)("span",{children:["Created at:"," ",Object(f.jsx)(j.s,{format:"DD MMM YYYY, hh:mm a",children:e.created_time})]})]})]}),Object(f.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.businessManager.id":e.id,"fbMarket.businessManager.name":e.name,"fbMarket.businessManager.createdAt":e.created_time,"fbMarket.businessManager.profileImg":e.picture.data.url}).then((function(e){var t=e.user;l((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Connect"})]},t)})),Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:"/profile-user.jpg"}),Object(f.jsx)("p",{children:"Create Business Manager"})]}),Object(f.jsx)("button",{className:"btn",onClick:function(){var e,t,n,s;c(!0),console.log("/".concat(null===(e=i.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id,"/businesses")),u.api("/".concat(null===(n=i.fbMarket)||void 0===n||null===(s=n.user)||void 0===s?void 0:s.id,"/businesses"),"POST",{name:"Delivery Pay Business Manager",vertical:"ECOMMERCE"},(function(e){c(!1),console.log(e),e.id&&u.api("/me","GET",{fields:"businesses{picture{url},name,id,created_time}"},(function(e){e.businesses&&x(e.businesses.data)})),e.error&&(1===e.error.code?g(Object(f.jsx)(f.Fragment,{children:"You have reached maximum number of business manager one user can have. Use one of existing business manager instead of creating a new one."})):3947===e.error.code?g(Object(f.jsx)(f.Fragment,{children:'You already have a Business Manager with the same name. Select "Delivery Pay Business Manager" instead of creating a new one. or Choose another.'})):g(Object(f.jsx)(f.Fragment,{children:e.error.error_user_msg||e.error.message})))}))},children:"Create new"})]})]})]})})},D=function(){var e,t,n=window.FB,c=Object(o.useContext)(d.d),a=c.user,i=c.setUser,l=Object(o.useState)([]),b=Object(r.a)(l,2),h=b[0],O=b[1],x=Object(o.useState)(!1),p=Object(r.a)(x,2),m=p[0],v=p[1];return Object(o.useEffect)((function(){var e,t;(null===(e=a.fbMarket)||void 0===e||null===(t=e.business)||void 0===t?void 0:t.id)||n.api("/me/accounts","GET",{fields:"picture{url},access_token,name,category,business",access_token:a.fbMarket.user.access_token},(function(e){console.log("facebook pages:",e),e.data&&O(e.data)}))}),[a]),Object(f.jsxs)(f.Fragment,{children:[(null===(e=a.fbMarket)||void 0===e||null===(t=e.facebookPage)||void 0===t?void 0:t.id)?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"The Facebook business Page that you use to sell your products or post ads."}),Object(f.jsx)("ul",{children:Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:a.fbMarket.facebookPage.profileImg}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(a.fbMarket.businessManager.id),children:[a.fbMarket.facebookPage.name," ",Object(f.jsx)(j.j,{})]}),Object(f.jsxs)("span",{children:["Category: ",a.fbMarket.facebookPage.category]})]})]}),Object(f.jsx)("button",{onClick:function(){Object(F.updateProfileInfo)({fbMarket:{user:a.fbMarket.user,businessManager:a.fbMarket.businessManager}}).then((function(e){var t=e.user;i((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},className:"btn",children:"Disconnect"})]})})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"Connect the business Page you use to sell products or post ads. You can only connect a Page you have admin access to."}),Object(f.jsxs)("ul",{children:[h.map((function(e,t){return Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:e.picture.data.url}),Object(f.jsxs)("div",{className:"detail",children:[Object(f.jsxs)("a",{href:"https://business.facebook.com/latest/home?nav_ref=bm_home_redirect&business_id=".concat(e.business_id,"&asset_id=").concat(e.asset_id),children:[e.name," ",Object(f.jsx)(j.j,{})]}),Object(f.jsx)("span",{children:e.category})]})]}),Object(f.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.facebookPage.id":e.id,"fbMarket.facebookPage.name":e.name,"fbMarket.facebookPage.access_token":e.access_token,"fbMarket.facebookPage.profileImg":e.picture.data.url,"fbMarket.facebookPage.category":e.category}).then((function(e){var t=e.user;i((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Connect"})]},t)})),Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:"/profile-user.jpg"}),Object(f.jsx)("p",{children:"Create Page"})]}),Object(f.jsx)("button",{className:"btn",onClick:function(){return v(!0)},children:"Create new"})]})]})]}),Object(f.jsx)(u.Modal,{head:!0,label:"Create a new Facebook business Page",open:m,setOpen:function(){v(!1),n.api("/me/accounts","GET",{fields:"picture{url},access_token,name,category,business",access_token:a.fbMarket.user.access_token},(function(e){console.log("facebook pages:",e),e.data&&O(e.data)}))},className:"createNewPage",children:Object(f.jsxs)("div",{className:"content",children:[Object(f.jsx)("p",{children:"You'll be redirected to Facebook where you can create a new business Page. All you need for now are basic details such as:"}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Business Page name"}),Object(f.jsx)("li",{children:"Business Page category"}),Object(f.jsx)("li",{children:"Profile Photo"}),Object(f.jsx)("li",{children:"Cover photo"}),Object(f.jsx)("li",{children:"Store description"})]}),Object(f.jsx)("p",{children:"As soon as you add these details, return to Delivery Pay and finish setup. You can always update your Page later."}),Object(f.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/pages/create/?ref_type=hc",children:[Object(f.jsx)(j.j,{})," Go to Facebook"]})]})})]})},w=function(e){var t,n,c,a=e.setStep,u=window.FB,b=Object(o.useContext)(d.d),h=b.user,O=b.setUser,x=Object(o.useState)(null),p=Object(r.a)(x,2),m=p[0],v=p[1];return Object(o.useEffect)(Object(l.a)(i.a.mark((function e(){var t,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(t=h.fbMarket)||void 0===t?void 0:t.instagramAccount)||u.api("/".concat(null===(n=h.fbMarket.facebookPage)||void 0===n?void 0:n.id),"GET",{fields:"instagram_business_account",access_token:null===(c=h.fbMarket)||void 0===c?void 0:c.user.access_token},(function(e){var t;e.instagram_business_account&&(console.log("insta id",e),u.api("/".concat(e.instagram_business_account.id),"GET",{fields:"username,profile_picture_url",access_token:null===(t=h.fbMarket)||void 0===t?void 0:t.user.access_token},(function(e){console.log("ig account",e),e.id&&(v(e),Object(F.updateProfileInfo)({"fbMarket.instagramAccount":m}).then((function(e){var t=e.user;console.log("updated"),O((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))})))})))}));case 1:case"end":return e.stop()}}),e)}))),[h]),Object(f.jsx)(f.Fragment,{children:(null===(t=h.fbMarket)||void 0===t||null===(n=t.instagramAccount)||void 0===n?void 0:n.id)?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"Post on Instagram directly from the product dashboard."}),Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:null===(c=h.fbMarket.instagramAccount)||void 0===c?void 0:c.profile_picture_url}),Object(f.jsx)("div",{className:"detail",children:h.fbMarket.instagramAccount.username})]})})})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{className:"note",children:"Connect Instagram account to post about your product directly from Delivery Pay product dashboard."}),m&&Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:m.profile_picture_url}),Object(f.jsx)("div",{className:"detail",children:m.username})]})})}),!m&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"err",children:Object(f.jsxs)("p",{children:["The connected Business Manager doesn\u2019t own any Instagram accounts connected to the Facebook Page. Add your Instagram account to the connected Business Manager and Facebook Page or learn more about"," ",Object(f.jsx)("a",{href:"https://help.instagram.com/502981923235522",target:"_blank",children:"how to create a new business account on Instagram"})," ",Object(f.jsx)(j.j,{})]})}),Object(f.jsxs)("p",{children:["If you can\u2019t find an Instagram account, learn more about how to"," ",Object(f.jsxs)("a",{href:"https://help.instagram.com/502981923235522",target:"_blank",children:["create a new account ",Object(f.jsx)(j.j,{})]})," ","or how to"," ",Object(f.jsxs)("a",{href:"https://www.facebook.com/business/help/1125825714110549?id=420299598837059",target:"_blank",children:["add an account to your Business Manager ",Object(f.jsx)(j.j,{})]}),"."]})]}),Object(f.jsx)("div",{className:"btns",children:Object(f.jsx)("button",{className:"btn_clear",onClick:function(){a("commerceAccount"),Object(F.updateProfileInfo)({"fbMarket.instagramAccount":null}).then((function(e){var t=e.user;O((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Skip"})})]})})},A=function(e){var t,n,c=e.setStep,a=window.FB,u=Object(o.useContext)(d.d),b=u.user,h=u.setUser,O=Object(o.useState)([]),x=Object(r.a)(O,2),p=(x[0],x[1],Object(o.useState)(null===(t=b.fbMarket)||void 0===t||null===(n=t.commerceAccount)||void 0===n?void 0:n.catalog)),m=Object(r.a)(p,2),v=m[0],g=m[1],y=Object(o.useState)(null),k=Object(r.a)(y,2),C=k[0],M=k[1];return Object(o.useEffect)((function(){var e,t;g(null===(e=b.fbMarket)||void 0===e||null===(t=e.commerceAccount)||void 0===t?void 0:t.catalog)}),[b]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("p",{className:"note",children:["Create a Commerce account to start selling on Facebook, Instagram, or both. Once you have an account you\u2019ll be able to customize your Shop and collections in the"," ",Object(f.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/business/help/2371372636254534",children:["Facebook Commerce Manager ",Object(f.jsx)(j.j,{})]}),"."]}),C&&Object(f.jsx)("div",{className:"err",children:C}),Object(f.jsxs)("ul",{children:[v&&Object(f.jsxs)("li",{className:"catalog",children:[Object(f.jsx)("p",{children:"PRODUCTS WILL BE SYNCED TO THIS CATALOG"}),Object(f.jsx)("p",{children:v.name}),Object(f.jsxs)("span",{children:["ID: ",v.id]})]}),!v&&Object(f.jsxs)("li",{children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:"/profile-user.jpg"}),Object(f.jsx)("p",{children:"Create a new Commerce Account"})]}),Object(f.jsx)("button",{className:"btn",onClick:function(){a.api("/".concat(b.fbMarket.businessManager.id,"/owned_product_catalogs"),"GET",{access_token:b.fbMarket.user.access_token},function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=t.error,console.log(n,r),r&&M(r.message),e.t0=null===n||void 0===n?void 0:n.find((function(e){return"Delivery Pay Product Catalog"===e.name})),e.t0){e.next=8;break}return e.next=7,a.api("/".concat(b.fbMarket.businessManager.id,"/owned_product_catalogs"),"POST",{name:"Delivery Pay Product Catalog",access_token:b.fbMarket.user.access_token},(function(e){return console.log(e.id),e.id?Object(s.a)(Object(s.a)({},e),{},{name:"Delivery Pay Product Catalog"}):null}));case 7:e.t0=e.sent;case 8:(l=e.t0)&&(g(l),Object(F.updateProfileInfo)({"fbMarket.commerceAccount.catalog":l}).then((function(e){var t=e.user;h((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})})),c("terms")})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Create new"})]})]})]})},T=function(){var e,t,n,c,a,i,l,b,O,x,p,m,v,g,y,k,C,M,N,S,T,I,Y,E,R,q,B,U,L=Object(o.useState)(null),V=Object(r.a)(L,2),H=V[0],G=V[1],z=Object(o.useContext)(d.d),J=z.user,W=z.setUser,Z=window.FB,K=Object(o.useState)(""),Q=Object(r.a)(K,2),$=Q[0],X=Q[1],ee=Object(o.useState)(!1),te=Object(r.a)(ee,2),ne=(te[0],te[1]);return Object(o.useEffect)((function(){var e,t,n,c,s,r,a,i,l,o,d;console.log(J.fbMarket),(null===(e=J.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)?(null===(n=J.fbMarket)||void 0===n||null===(c=n.businessManager)||void 0===c?void 0:c.id)?(null===(s=J.fbMarket)||void 0===s||null===(r=s.facebookPage)||void 0===r?void 0:r.id)?void 0===(null===(a=J.fbMarket)||void 0===a?void 0:a.instagramAccount)?X("instagramAccount"):(null===(i=J.fbMarket)||void 0===i||null===(l=i.commerceAccount)||void 0===l||null===(o=l.catalog)||void 0===o?void 0:o.id)?(null===(d=J.fbMarket)||void 0===d?void 0:d.userAgreement)||X("terms"):X("commerceAccount"):X("fbPage"):X("businessManager"):X("account")}),[J]),Object(f.jsxs)("div",{className:"fbMarket",children:[Object(f.jsx)("h1",{children:"Facebook marketplace"}),Object(f.jsxs)("div",{className:"setup",children:[Object(f.jsxs)(_,{data:(null===(e=J.fbMarket)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)?J.fbMarket.user:null,defaultStatus:"account"===$,step:$,label:"Facebook Account",children:[Object(f.jsx)("p",{className:"note",children:"Delivery Pay uses your personal Facebook account to access your business accounts."}),Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)("div",{className:"user",children:(null===(n=J.fbMarket)||void 0===n||null===(c=n.user)||void 0===c?void 0:c.id)?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.n,{src:J.fbMarket.user.profileImg||"/profile-user.jpg"},"img"),Object(f.jsx)("p",{children:J.fbMarket.user.name})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.n,{src:"/profile-user.jpg"},"placeholder"),Object(f.jsx)("p",{children:"Connect your Facebook account to get started"})]})}),(null===(a=J.fbMarket)||void 0===a||null===(i=a.user)||void 0===i?void 0:i.id)?Object(f.jsx)("button",{className:"btn",onClick:function(){Z.logout((function(e){console.log(e)})),j.p.remove("facebook_user_accessToken"),j.p.remove("facebook_page_accessToken"),Object(F.updateProfileInfo)({"fbMarket.user":{},"fbMarket.businessManager":{},"fbMarket.facebookPage":{},"fbMarket.dataSharing":null,"fbMarket.instagramAccount":{},"fbMarket.commerceAccount":{},"fbMarket.userAgreement":!1}).then((function(e){var t=e.user;W((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})}))}))},children:"Disconnect"}):Object(f.jsx)("button",{className:"btn",onClick:function(){Z.login((function(e){var t;if(null===(t=e.authResponse)||void 0===t?void 0:t.accessToken){var n=e.authResponse.accessToken;fetch("/api/addFbMarketUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:n})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&W((function(t){return Object(s.a)(Object(s.a)({},t),{},{fbMarket:e.fbMarket})}))}))}}),{scope:"business_management,catalog_management,pages_read_engagement,pages_show_list,instagram_basic,instagram_content_publish",return_scopes:!0})},children:"Connect Account"})]})]}),Object(f.jsx)(_,{disabled:!(null===(l=J.fbMarket)||void 0===l||null===(b=l.user)||void 0===b?void 0:b.id),data:(null===(O=J.fbMarket)||void 0===O||null===(x=O.businessManager)||void 0===x?void 0:x.id)?J.fbMarket.businessManager:null,defaultStatus:"businessManager"===$,label:"Business Manager",className:"businessManager",children:Object(f.jsx)(P,{setLoading:ne})}),Object(f.jsx)(_,{data:(null===(p=J.fbMarket)||void 0===p||null===(m=p.facebookPage)||void 0===m?void 0:m.id)?J.fbMarket.facebookPage:null,defaultStatus:"fbPage"===$,label:"Facebook Page",className:"page",disabled:!(null===(v=J.fbMarket)||void 0===v||null===(g=v.businessManager)||void 0===g?void 0:g.id),children:Object(f.jsx)(D,{})}),Object(f.jsx)(_,{data:(null===(y=J.fbMarket)||void 0===y||null===(k=y.instagramAccount)||void 0===k?void 0:k.id)?J.fbMarket.instagramAccount:null,disabled:!(null===(C=J.fbMarket)||void 0===C||null===(M=C.facebookPage)||void 0===M?void 0:M.id),label:"Instagram Account",defaultStatus:"instagramAccount"===$,className:"instagramAccount",children:Object(f.jsx)(w,{setStep:X})}),Object(f.jsx)(_,{data:(null===(N=J.fbMarket)||void 0===N||null===(S=N.commerceAccount)||void 0===S||null===(T=S.catalog)||void 0===T?void 0:T.id)?J.fbMarket.commerceAccount:null,disabled:!(null===(I=J.fbMarket)||void 0===I||null===(Y=I.facebookPage)||void 0===Y?void 0:Y.id),label:"Facebook Commerce Account",defaultStatus:"commerceAccount"===$,className:"commerceAccount",children:Object(f.jsx)(A,{setStep:X})}),Object(f.jsxs)(_,{disabled:!(null===(E=J.fbMarket)||void 0===E||null===(R=E.commerceAccount)||void 0===R||null===(q=R.catalog)||void 0===q?void 0:q.id),data:(null===(B=J.fbMarket)||void 0===B?void 0:B.userAgreement)||null,defaultStatus:"terms"===$,label:"Terms and Conditions",children:[Object(f.jsxs)("p",{children:["By proceeding, you accept"," ",Object(f.jsxs)("a",{target:"_blank",href:"https://www.facebook.com/legal/commerce_product_merchant_agreement",children:["Facebook Commerce Terms ",Object(f.jsx)(j.j,{})]}),"."]}),!(null===(U=J.fbMarket)||void 0===U?void 0:U.userAgreement)&&Object(f.jsx)("button",{className:"btn",onClick:function(){Object(F.updateProfileInfo)({"fbMarket.userAgreement":!0}).then((function(e){var t=e.user;W((function(e){return Object(s.a)(Object(s.a)({},e),{},{fbMarket:t.fbMarket})})),X(""),G(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return G(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Facebook marketplace has been setup successfully. Now you can add products to facebook marketplace directly from Delivery Pay."}),Object(f.jsx)(h.b,{to:"/account/myShop/products",children:"Add your first product"})]})]}))}))},children:"Finish setup"})]})]}),Object(f.jsx)(u.Modal,{open:H,className:"msg",children:H})]})},I=n(123),Y=n(250);n(254);var E=function(e){var t,n,a,b,x,p=e.prefill,m=e.onSuccess,v=e.categories,g=Object(o.useContext)(d.d).user,y=Object(o.useState)(!1),k=Object(r.a)(y,2),C=k[0],M=k[1],N=Object(o.useState)((null===p||void 0===p?void 0:p.type)||"product"),S=Object(r.a)(N,2),F=S[0],_=S[1],P=Object(o.useState)((null===p||void 0===p?void 0:p.category)||""),D=Object(r.a)(P,2),w=D[0],A=D[1],T=Object(o.useState)({type:(null===p||void 0===p||null===(t=p.discount)||void 0===t?void 0:t.type)||null,amount:(null===p||void 0===p||null===(n=p.discount)||void 0===n?void 0:n.amount)||0,dscr:(null===p||void 0===p||null===(a=p.discount)||void 0===a?void 0:a.dscr)||""}),I=Object(r.a)(T,2),Y=I[0],E=I[1],R=Object(o.useState)((null===p||void 0===p?void 0:p.name)||""),q=Object(r.a)(R,2),B=q[0],U=q[1],L=Object(o.useState)((null===p||void 0===p?void 0:p.dscr)||""),V=Object(r.a)(L,2),H=V[0],G=V[1],z=Object(o.useState)((null===p||void 0===p?void 0:p.price)||""),J=Object(r.a)(z,2),W=J[0],Z=J[1],K=Object(o.useState)((null===p||void 0===p?void 0:p.images)||[]),Q=Object(r.a)(K,2),$=Q[0],X=Q[1],ee=Object(o.useState)((null===p||void 0===p?void 0:p.gst)||(null===(b=g.gst)||void 0===b?void 0:b.verified)?g.gst.amount:0),te=Object(r.a)(ee,2),ne=te[0],ce=te[1],se=Object(o.useState)((null===p||void 0===p?void 0:p.hsn)||""),re=Object(r.a)(se,2),ae=re[0],ie=re[1],le=Object(o.useState)(null===p||void 0===p?void 0:p.available),oe=Object(r.a)(le,2),de=oe[0],je=oe[1],ue=Object(o.useState)(null),be=Object(r.a)(ue,2),he=be[0],Oe=be[1],fe=Object(o.useState)((null===p||void 0===p?void 0:p.tags)||[]),xe=Object(r.a)(fe,2),pe=xe[0],me=xe[1],ve=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),M(!0),!$.length){e.next=8;break}return e.next=5,Object(j.G)({files:$,setMsg:Oe});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:n=e.t0,fetch("/api/".concat(p?"edit":"add","Product"),{method:p?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(s.a)({type:F,name:B,dscr:H,price:+W,images:n,category:w,tags:pe,available:!0===de||!1===de?de:+de,gst:ne,discount:Y},p&&{_id:p._id}))}).then((function(e){return e.json()})).then((function(e){M(!1),"ok"===e.code?null===m||void 0===m||m(e.product):403===e.code?Oe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"You can't add more that 100 product at a time. Delete a product/service and try again."})]})]})):Oe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add product. please try again."})]})]}))})).catch((function(e){M(!1),console.log(e),Oe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return Oe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add product. Make sure you're online."})]})]}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("form",{onSubmit:ve,className:C?"loading":"",children:[Object(f.jsxs)("section",{className:"type",children:[Object(f.jsx)("label",{children:"Type"}),Object(f.jsx)(j.h,{defaultValue:F,options:[{label:"Product",value:"product"},{label:"Service",value:"service"},{label:"Other",value:"other"}],onChange:function(e){_(e.value)}})]}),Object(f.jsxs)("section",{className:"name",children:[Object(f.jsx)("label",{children:"Name of the product/service"}),Object(f.jsx)("input",{value:B,onChange:function(e){return U(e.target.value)},required:!0})]}),Object(f.jsxs)("section",{className:"category",children:[Object(f.jsxs)("label",{children:["Category"," ",Object(f.jsxs)(j.F,{children:["You can Add/Edit/Delete your categories"," ",Object(f.jsx)(h.b,{to:"/account/myShop/settings",children:"here"})]})]}),Object(f.jsx)(j.h,{required:!0,defaultValue:w,options:v.map((function(e){return{label:e,value:e}})),onChange:function(e){return A(e.value)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Price \u20b9"}),Object(f.jsx)(j.t,{defaultValue:W,onChange:function(e){return Z(e.target.value)},required:!0})]}),Object(f.jsx)("section",{className:"available",children:"product"===F?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("label",{children:"Available in stock"}),Object(f.jsx)(j.t,{required:!0,defaultValue:de,onChange:function(e){return je(e.target.value)}})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("label",{children:"Availability"}),Object(f.jsx)(j.h,{defaultValue:de,required:!0,options:[{label:"Available",value:!0},{label:"Not available",value:!1}],onChange:function(e){return je(e.value)}})]})}),Object(f.jsxs)("section",{className:"dscr",children:[Object(f.jsx)("label",{children:"Description of the product/service"}),Object(f.jsx)(O.a,{value:H,onChange:function(e){return G(e.target.value)},required:!0})]}),Object(f.jsxs)("section",{className:"tags",children:[Object(f.jsx)("label",{children:"Tags"}),Object(f.jsxs)("ul",{children:[pe.map((function(e){return Object(f.jsxs)("li",{children:[e,Object(f.jsx)("button",{onClick:function(){me((function(t){return t.filter((function(t){return t!==e}))}))},children:Object(f.jsx)(j.I,{})})]},e)})),Object(f.jsxs)("li",{className:"form",children:[Object(f.jsx)("input",{placeholder:"addNewTag",onKeyPress:function(e){var t="".concat(e.target.value.trim());if(13===e.charCode){if(e.preventDefault(),!t)return;me((function(e){return[].concat(Object(c.a)(e.filter((function(e){return e!==t}))),[t])})),e.target.focus(),e.target.value=""}}}),Object(f.jsx)("button",{type:"button",onClick:function(e){var t=e.target.previousElementSibling,n="".concat(e.target.previousElementSibling.value.trim());n&&(me((function(e){return[].concat(Object(c.a)(e.filter((function(e){return e!==n}))),[n])})),t.value="",t.focus())},children:"Add Tag"})]})]})]}),Object(f.jsxs)("section",{className:"images",children:[Object(f.jsx)("label",{children:"Images of the product"}),Object(f.jsx)(j.k,{multiple:!0,prefill:null===p||void 0===p?void 0:p.images,accept:"image/*",onChange:function(e){return X(e)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"HSN Code"}),Object(f.jsx)("input",{value:ae,onChange:function(e){return ie(e.target.value)}})]}),(null===(x=g.gst)||void 0===x?void 0:x.verified)&&Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"GST (%)"}),Object(f.jsx)(j.t,{defaultValue:ne,onChange:function(e){return ce(e.target.value)}})]}),Object(f.jsxs)("section",{className:"discountType",children:[Object(f.jsx)("label",{children:"Discount Type"}),Object(f.jsx)(j.h,{defaultValue:Y.type,options:[{label:"None",value:null},{label:"Percent",value:"percent"},{label:"Flat",value:"flat"}],onChange:function(e){return E((function(t){return Object(s.a)(Object(s.a)({},t),{},{type:e.value})}))}})]}),null!==Y.type&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("section",{className:"discountAmount",children:[Object(f.jsxs)("label",{children:["Amount ","percent"===Y.type&&"(%)"]}),Object(f.jsx)(j.t,{defaultValue:Y.amount,onChange:function(e){return E((function(t){return Object(s.a)(Object(s.a)({},t),{},{amount:e.target.value})}))}})]}),Object(f.jsxs)("section",{className:"discountDscr",children:[Object(f.jsx)("label",{children:"Discount description"}),Object(f.jsx)(O.a,{defaultValue:Y.dscr,onChange:function(e){return E((function(t){return Object(s.a)(Object(s.a)({},t),{},{dscr:e.target.value})}))}})]})]}),W&&Object(f.jsxs)("section",{className:"finalPrice",children:[Object(f.jsxs)("p",{children:[Object(f.jsx)("label",{children:"Input price"}),W]}),+ne>0&&Object(f.jsxs)("p",{className:"gst",children:[Object(f.jsxs)("label",{children:["GST ",ne,"%"]}),"+",(+W/100*+ne).fix()]}),Y.amount>0&&"flat"===Y.type&&Object(f.jsxs)("p",{children:[Object(f.jsx)("label",{children:"Discount flat"}),"- \u20b9",(+Y.amount).fix()]}),Y.amount>0&&"percent"===Y.type&&Object(f.jsxs)("p",{children:[Object(f.jsxs)("label",{children:["Discount ",Y.amount,"%"]}),"- \u20b9",(+W/100*Y.amount).fix()]}),Object(f.jsxs)("p",{className:"final",children:[Object(f.jsx)("label",{children:"Listing Price"}),"\u20b9",(+W+ +W/100*+ne-("percent"===Y.type?+W/100*Y.amount:0)-("flat"===Y.type?Y.amount:0)).fix()]})]}),Object(f.jsx)("section",{className:"btns",children:Object(f.jsx)("button",{className:"submit",type:"submit",children:"Submit"})}),Object(f.jsx)("div",{className:"pBtm"})]}),C&&Object(f.jsx)("div",{className:"spinnerContainer",children:Object(f.jsx)("div",{className:"spinner"})}),Object(f.jsx)(u.Modal,{className:"msg",open:he,children:he})]})},R=function(e){var t,n=e.categories,a=e.shopSetupComplete,i=Object(o.useContext)(d.d).user,l=(window.FB,Object(o.useState)(!1)),b=Object(r.a)(l,2),O=b[0],x=b[1],p=Object(o.useState)(0),m=Object(r.a)(p,2),v=m[0],g=m[1],y=Object(o.useState)(1),k=Object(r.a)(y,2),C=k[0],M=k[1],N=Object(o.useState)(20),S=Object(r.a)(N,2),F=S[0],_=S[1],P=Object(o.useState)(""),D=Object(r.a)(P,2),w=D[0],A=D[1],T=Object(o.useState)(""),I=Object(r.a)(T,2),Y=I[0],R=I[1],B=Object(o.useState)({column:"createdAt",order:"dsc"}),L=Object(r.a)(B,2),V=L[0],H=(L[1],Object(o.useState)(null)),G=Object(r.a)(H,2),z=G[0],J=G[1],W=Object(o.useState)(""),Z=Object(r.a)(W,2),K=Z[0],Q=Z[1],$=Object(o.useState)([]),X=Object(r.a)($,2),ee=X[0],te=X[1],ne=Object(o.useState)(!1),ce=Object(r.a)(ne,2),se=ce[0],re=ce[1],ae=Object(o.useState)([]),ie=Object(r.a)(ae,2),le=ie[0],oe=ie[1],de=Object(o.useState)(!1),je=Object(r.a)(de,2),ue=je[0],be=je[1],he=Object(o.useState)(null),Oe=Object(r.a)(he,2),fe=Oe[0],xe=Oe[1],pe=function(e){e.length&&fetch("/api/deleteProducts",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?(oe([]),te((function(t){return t.filter((function(t){return!e.some((function(e){return e===t._id}))}))}))):xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not delete products. Try again."})]})]}))})).catch((function(e){console.log(e),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not delete products. Make sure you're online."})]})]}))}))},me=function(){return pe(le)},ve=function(e){fetch("/api/addToFbMarket",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e})}).then((function(e){return e.json()})).then((function(e){var t=e.code,n=e.fb_products;if("ok"===t){var c=[],r=[];n.forEach((function(e,t){e.success?c.push(e):r.push(e)})),te((function(e){return e.map((function(e){var t=n.find((function(t){return t._id===e._id}));return t?Object(s.a)(Object(s.a)({},e),{},{fbMarketId:t.fbMarketId}):e}))})),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsx)("div",{children:0===r.length?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.D,{}),Object(f.jsxs)("h4",{children:[c.length," products has been added."]})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.i,{}),Object(f.jsxs)("h4",{children:[r.length," products failed."]})]})})]}))}else xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products to Facebook Marketplace."})]})]}))})).catch((function(e){console.log(e),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products to Facebook Marketplace. Make sure you're online."})]})]}))}))},ge=function(e){fetch("/api/removeFromFbMarket",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({_ids:e,access_token:j.p.get("facebook_user_accessToken")})}).then((function(e){return e.json()})).then((function(e){var t=e.code,n=e.fb_products;if("ok"===t){var c=[],r=[];n.forEach((function(e,t){e.success?c.push(e):r.push(e)})),te((function(e){return e.map((function(e){var t=n.find((function(t){return t._id===e._id}));return t?Object(s.a)(Object(s.a)({},e),{},{fbMarketId:t.fbMarketId}):e}))})),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsx)("div",{children:0===r.length?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.D,{}),Object(f.jsxs)("h4",{children:[c.length," products has been removed."]})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.i,{}),Object(f.jsxs)("h4",{children:[r.length," products failed to remove."]})]})})]}))}else xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not remove products from Facebook Marketplace."})]})]}))})).catch((function(e){console.log(e),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not remove products from Facebook Marketplace. Make sure you're online."})]})]}))}))};return Object(o.useEffect)((function(){var e,t=Object(j.M)({time:null===z||void 0===z?void 0:z.startDate,format:"YYYY-MM-DD"}),n=Object(j.M)({time:null===(e=new Date(null===z||void 0===z?void 0:z.endDate))||void 0===e?void 0:e.setHours(24,0,0,0),format:"YYYY-MM-DD"});fetch("/api/products?".concat(new URLSearchParams(Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},Y&&{q:Y}),{},{page:C,perPage:F,sort:V.column,order:V.order},z&&{dateFrom:t,dateTo:n}),w&&{category:w}),K&&{type:K})))).then((function(e){return e.json()})).then((function(e){"ok"===e.code&&(te(e.products),g(e.total))})).catch((function(e){console.log(e),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not get products."})]})]}))}))}),[w,Y,C,F,K,ue,z]),Object(o.useEffect)((function(){se||oe([])}),[se]),Object(o.useEffect)((function(){0===le.length&&re(!1)}),[le]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"benner",children:[Object(f.jsx)("p",{children:"Product Management"}),a?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("button",{className:"pill",onClick:function(){return x(!0)},children:[Object(f.jsx)(j.v,{})," Add Product"]}),Object(f.jsxs)("button",{className:"pill batchUpload",onClick:function(){return be(!0)},children:[Object(f.jsx)(j.v,{})," Batch Upload"]})]}):Object(f.jsx)(h.b,{to:"/account/myShop/settings",className:"err",children:Object(f.jsx)("p",{children:"Please complete your shop information to add product."})})]}),Object(f.jsxs)("div",{className:"filters",children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Total:"}),v]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Per Page:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"20",value:20},{label:"30",value:30},{label:"50",value:50}],onChange:function(e){return _(e.value)}})]}),Object(f.jsxs)("section",{className:"search",children:[Object(f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 23 23",children:Object(f.jsx)("path",{id:"Icon_ionic-ios-search","data-name":"Icon ionic-ios-search",d:"M27.23,25.828l-6.4-6.455a9.116,9.116,0,1,0-1.384,1.4L25.8,27.188a.985.985,0,0,0,1.39.036A.99.99,0,0,0,27.23,25.828ZM13.67,20.852a7.2,7.2,0,1,1,5.091-2.108A7.155,7.155,0,0,1,13.67,20.852Z",transform:"translate(-4.5 -4.493)",fill:"#707070",opacity:"0.74"})}),Object(f.jsx)("input",{value:Y,onChange:function(e){return R(e.target.value)},placeholder:"Search for products & services"}),Y&&Object(f.jsx)("button",{onClick:function(){return R("")},children:Object(f.jsx)(j.I,{})})]}),Object(f.jsxs)("section",{className:"type",children:[Object(f.jsx)("label",{children:"Type:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""},{label:"Product",value:"product"},{label:"Service",value:"service"},{label:"Other",value:"other"}],onChange:function(e){return Q(e.value)}})]}),Object(f.jsxs)("section",{className:"category",children:[Object(f.jsx)("label",{children:"Category:"}),Object(f.jsx)(j.h,{defaultValue:0,options:[{label:"All",value:""}].concat(Object(c.a)(n.map((function(e){return{label:e,value:e}})))),onChange:function(e){return A(e.value)}})]}),Object(f.jsx)("section",{className:"date",children:Object(f.jsx)(j.o,{dateRange:z,onChange:function(e){return J(e)}})})]}),Object(f.jsxs)("table",{className:"table products",children:[Object(f.jsx)("thead",{children:le.length>0?Object(f.jsxs)("tr",{className:"batchAction",children:[Object(f.jsx)("th",{className:"checkContainer",children:Object(f.jsx)(j.f,{value:se,defaultValue:se,onChange:function(e){return re(e)}})}),Object(f.jsx)("th",{children:Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Batch delete",question:"You sure you want to delete these ".concat(le.length," items?"),callback:me})},children:"Delete"})}),(null===(t=i.fbMarket)||void 0===t?void 0:t.userAgreement)&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("th",{children:Object(f.jsx)("button",{onClick:function(){ve(le),oe([])},children:"Add to Facebook"})}),Object(f.jsx)("th",{children:Object(f.jsx)("button",{onClick:function(){ge(le),oe([])},children:"Remove from Facebook"})})]})]}):Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{className:"checkContainer",children:Object(f.jsx)(j.f,{value:se,defaultValue:se,onChange:function(e){return re(e)}})}),Object(f.jsx)("th",{className:"date",children:"Date"}),Object(f.jsx)("th",{children:"Image"}),Object(f.jsx)("th",{className:"name",children:"Name"}),Object(f.jsx)("th",{children:"Type"}),Object(f.jsx)("th",{children:"Facebook Marketplace"}),Object(f.jsx)("th",{children:"Available"}),Object(f.jsx)("th",{children:"Price"}),Object(f.jsx)("th",{children:"GST"}),Object(f.jsx)("th",{children:"Discount"}),Object(f.jsx)("th",{children:"Listing Price"}),Object(f.jsx)("th",{children:"Actions"})]})}),Object(f.jsxs)("tbody",{children:[ee.map((function(e){return Object(f.jsx)(q,{categories:n,product:e,setProducts:te,selectAll:se,setBatch:oe,batch:le,deleteItems:pe,addToFbMarket:ve,removeFromFbMarket:ge},e._id)})),0===ee.length&&Object(f.jsx)("tr",{className:"placeholder",children:Object(f.jsx)("td",{children:"No product yet."})})]})]}),Object(f.jsx)(j.u,{total:v,btns:5,currentPage:C,perPage:F,setPage:M}),Object(f.jsx)(u.Modal,{className:"msg",open:fe,children:fe}),Object(f.jsx)(u.Modal,{head:!0,label:"Edit Product/Service",setOpen:x,open:O,className:"productForm",children:Object(f.jsx)(E,{categories:n,onSuccess:function(e){te((function(t){return[].concat(Object(c.a)(t),[e])})),x(!1),xe(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return xe(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Product added."})]})]}))}})}),Object(f.jsx)(u.Modal,{open:ue,head:!0,label:"Batch product upload",setOpen:be,className:"batchItemPreview",children:Object(f.jsx)(U,{categories:n,onSuccess:function(){be(!1)}})})]})},q=function(e){var t,n,s,a,i,l,b=e.product,O=e.setProducts,x=e.categories,p=e.selectAll,m=e.setBatch,v=e.batch,g=e.deleteItems,y=e.addToFbMarket,k=e.removeFromFbMarket,C=Object(o.useContext)(d.d).user,M=Object(o.useState)(p||!1),N=Object(r.a)(M,2),S=N[0],F=N[1],_=Object(o.useState)(!1),P=Object(r.a)(_,2),D=P[0],w=P[1],A=Object(o.useState)(!1),T=Object(r.a)(A,2),Y=T[0],R=T[1],q=Object(o.useState)(!1),U=Object(r.a)(q,2),L=U[0],V=U[1];return Object(o.useEffect)((function(){F(p)}),[p]),Object(o.useEffect)((function(){m(S?function(e){return[].concat(Object(c.a)(e),[b._id])}:function(e){return e.filter((function(e){return e!==b._id}))})}),[S]),Object(f.jsxs)("tr",{className:"product ".concat(S?"selected":""),children:[Object(f.jsx)("td",{className:"checkContainer",children:Object(f.jsx)(j.f,{defaultValue:S,value:S,onChange:function(e){F(e)}})}),Object(f.jsx)("td",{className:"date",children:Object(f.jsx)(j.s,{format:"DD-MM-YY",children:b.createdAt})}),Object(f.jsx)("td",{className:"thumbs",children:Object(f.jsx)(j.q,{links:b.images})}),Object(f.jsx)("td",{className:"name",children:b.name}),Object(f.jsx)("td",{children:b.type}),Object(f.jsx)("td",{children:b.fbMarketId?"Added":"N/A"}),Object(f.jsxs)("td",{children:[b.available," ",!0===b.available&&"Available",!1===b.available&&"Unavailable"]}),Object(f.jsxs)("td",{children:["\u20b9",b.price]}),Object(f.jsx)("td",{children:(null===(t=C.gst)||void 0===t?void 0:t.verified)?(b.gst||(null===(n=C.gst)||void 0===n?void 0:n.amount)||0)+"%":"N/A"}),Object(f.jsxs)("td",{children:["\u20b9",Object(j.K)(b)||0]}),Object(f.jsxs)("td",{children:["\u20b9",Object(j.L)({product:b,gst:C.gst})||0]}),Object(f.jsx)("td",{children:0===v.length&&Object(f.jsxs)(j.a,{icon:Object(f.jsx)(j.g,{}),children:[Object(f.jsx)(h.b,{to:"/marketplace/".concat(b._id),target:"_blank",children:"View"}),(null===(s=C.fbMarket)||void 0===s?void 0:s.userAgreement)&&Object(f.jsx)(f.Fragment,{children:b.fbMarketId?Object(f.jsx)("button",{onClick:function(){return k([b._id])},children:"Remove from Facebook"}):Object(f.jsx)("button",{onClick:function(){return y([b._id])},children:"Add to Facebook"})}),(null===(a=C.fbMarket)||void 0===a||null===(i=a.instagramAccount)||void 0===i?void 0:i.id)&&Object(f.jsx)("button",{onClick:function(){return R(!0)},children:"Post to instagram"}),!(null===(l=C.fbMarket)||void 0===l?void 0:l.userAgreement)&&Object(f.jsx)(h.b,{to:"/account/myShop/fbMarketplace",className:"edit",children:"Setup FB Marketplace"}),Object(f.jsx)(I.a,{resetButtonStyle:!1,url:"deliverypay.in/marketplace/".concat(b._id),children:"Post on Facebook"}),Object(f.jsx)("button",{className:"edit",onClick:function(){return w(!0)},children:"Edit"}),Object(f.jsx)("button",{className:"delete",onClick:function(){return Object(u.Confirm)({label:"Removing Product",question:"You sure want to delete this product?",callback:function(){return g([b._id])}})},children:"Delete"})]})}),Object(f.jsx)(u.Modal,{head:!0,label:"Edit Product/Service",open:D,setOpen:w,className:"productForm",children:Object(f.jsx)(E,{categories:x,onSuccess:function(e){O((function(t){return t.map((function(t){return t._id===e._id?e:t}))})),w(!1),V(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return V(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Product updated."})]})]}))},prefill:b})}),Object(f.jsx)(u.Modal,{head:!0,label:"Post to Instagram",open:Y,setOpen:R,className:"instaForm",children:Object(f.jsx)(B,{product:b,onSuccess:function(){return R(!1)}})}),Object(f.jsx)(u.Modal,{className:"msg",open:L,children:L})]})},B=function(e){var t,n,c,s,a,i=e.product,l=e.onSuccess,b=window.FB,h=Object(o.useContext)(d.d).user,x=Object(o.useState)(null),p=Object(r.a)(x,2),m=p[0],v=p[1],g=Object(o.useState)(!1),y=Object(r.a)(g,2),k=y[0],C=y[1],M=Object(o.useState)(i.images[0]),N=Object(r.a)(M,2),S=N[0],F=N[1],_=Object(o.useState)(""),P=Object(r.a)(_,2),D=P[0],w=P[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("form",{className:"content",onSubmit:function(e){var t,n;e.preventDefault(),C(!0),b.api("/".concat(null===(t=h.fbMarket)||void 0===t||null===(n=t.instagramAccount)||void 0===n?void 0:n.id,"/media"),"POST",{caption:D,image_url:S,access_token:h.fbMarket.user.access_token},(function(e){var t,n;if(e.error)return console.log(e.error),v(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){v(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:e.error.message})]})]})),void C(!1);b.api("/".concat(null===(t=h.fbMarket)||void 0===t||null===(n=t.instagramAccount)||void 0===n?void 0:n.id,"/media_publish"),"POST",{creation_id:e.id,access_token:h.fbMarket.user.access_token},(function(e){if(C(!1),e.error)return console.log(e.error),void v(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){v(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:e.error.message})]})]}));console.log(e),v(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){v(null),null===l||void 0===l||l()},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.D,{}),Object(f.jsx)("h4",{children:"Successfully posted."})]})]}))}))}))},children:[Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)(j.n,{src:null===(t=h.fbMarket)||void 0===t||null===(n=t.instagramAccount)||void 0===n?void 0:n.profile_picture_url}),Object(f.jsx)("p",{children:null===(c=h.fbMarket)||void 0===c||null===(s=c.instagramAccount)||void 0===s?void 0:s.username})]}),Object(f.jsx)(j.n,{src:S,className:"main"}),Object(f.jsx)("div",{className:"thumbs",children:null===(a=i.images)||void 0===a?void 0:a.map((function(e,t){return Object(f.jsx)(j.n,{src:e,onClick:function(){return F(e)}},t)}))}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Caption"}),Object(f.jsx)(O.a,{value:D,onChange:function(e){return w(e.target.value)},maxLength:2200})]}),Object(f.jsx)("section",{className:"btns",children:Object(f.jsx)("button",{className:"submit pill",children:"Post"})})]}),Object(f.jsx)(u.Modal,{className:"msg",open:m,children:m}),k&&Object(f.jsx)("div",{className:"spinnerContainer",children:Object(f.jsx)("div",{className:"spinner"})})]})},U=function(e){var t=e.onSuccess,a=e.categories,d=Object(o.useState)(!1),b=Object(r.a)(d,2),h=b[0],O=b[1],x=Object(o.useState)(1),p=Object(r.a)(x,2),m=p[0],v=p[1],g=Object(o.useState)(null),y=Object(r.a)(g,2),k=y[0],C=y[1],M=Object(o.useState)([]),N=Object(r.a)(M,2),S=N[0],F=N[1],P=Object(o.useState)(null),D=Object(r.a)(P,2),w=D[0],A=D[1],T=Object(o.useState)(""),I=Object(r.a)(T,2),E=I[0],R=I[1],q=Object(o.useState)(null),B=Object(r.a)(q,2),U=B[0],L=B[1],V=function(){O(!0),fetch("/api/updateDraft",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:k})}).then((function(e){return e.json()})).then((function(e){var n=e.code,c=e.updated;O(!1),A("ok"===n?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){A(null),null===t||void 0===t||t()},children:"Okay"}),Object(f.jsxs)("div",{children:[c?Object(f.jsx)(j.D,{}):Object(f.jsx)(j.i,{}),Object(f.jsxs)("h4",{children:[c," items has been updated."]})]})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products. Try again."})]})]}))})).catch((function(e){O(!1),console.log(e),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))}))},H=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O(!0),e.next=4,Object(j.G)({files:S,setMsg:A});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:if((n=e.t0).length===S.length){e.next=11;break}return A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upload images. Please try again."})]})]})),e.abrupt("return");case 11:fetch("/api/uploadProductImg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:n,category:E})}).then((function(e){return e.json()})).then((function(e){if("ok"===e.code){var t=Object.entries({Images:"images",id:"_id",Name:"name",Description:"dscr",Material:"material","Size [Please specify mm, cm, inch or KG]":"size",Category:"category",Type:"type","Price in INR.":"price","Units Available":"available","HSN Code":"hsn","GST %":"gst"}).map((function(e){var t=Object(r.a)(e,2);return{label:t[0],key:t[1]}}));L({headers:t,data:e.products,filename:"Delivery Pay Product Draft.csv"})}else A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))})).catch((function(e){O(!1),console.log(e),A(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return A(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add products. Make sure you're online."})]})]}))}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"content",children:[Object(f.jsx)(_,{label:"Create Draft",className:"createDraft",defaultStatus:1===m,data:U,children:Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("form",{onSubmit:H,children:[Object(f.jsxs)("section",{className:"category",children:[Object(f.jsx)("label",{children:"Choose category"}),Object(f.jsx)(j.h,{options:a.map((function(e){return{label:e,value:e.toLowerCase()}})),required:!0,onChange:function(e){return R(e.value)}})]}),Object(f.jsxs)("p",{children:["Choose images"," ",Object(f.jsx)("span",{children:"Choose 1 image for each product. you can add multiple images later."})]}),Object(f.jsx)(j.k,{onChange:function(e){return F(e)},multiple:!0}),Object(f.jsxs)("section",{className:"btns",children:[Object(f.jsx)("button",{className:"clean",type:"button",onClick:function(){return v(3)},children:"Already have a draft"}),U?Object(f.jsx)(Y.CSVLink,Object(s.a)(Object(s.a)({},U),{},{className:"submit",type:"submit",onClick:function(){L(null),v(2)},children:"Download Draft"})):Object(f.jsx)("button",{className:"submit",children:"Create Draft"})]})]})})}),Object(f.jsxs)(_,{label:"Populate With data",defaultStatus:2===m,children:[Object(f.jsx)("p",{children:"Populate the Sheet with real product data. Don't Change the header."}),Object(f.jsx)("button",{className:"submit",onClick:function(){return v(3)},children:"Next"})]}),Object(f.jsxs)(_,{label:"Upload Draft",defaultStatus:3===m,children:[!!(null===k||void 0===k?void 0:k.length)&&Object(f.jsxs)("table",{className:"table",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Type"}),Object(f.jsx)("th",{children:"Images"}),Object(f.jsx)("th",{className:"name",children:"Name"}),Object(f.jsx)("th",{className:"dscr",children:"Description"}),Object(f.jsx)("th",{children:"Available"}),Object(f.jsx)("th",{children:"Price"}),Object(f.jsx)("th",{children:"GST"}),Object(f.jsx)("th",{children:"Action"})]})}),Object(f.jsx)("tbody",{children:null===k||void 0===k?void 0:k.map((function(e,t){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:e.type}),Object(f.jsx)("td",{className:"thumbs",children:Object(f.jsx)(j.q,{links:e.images})}),Object(f.jsx)("td",{className:"name",children:e.name}),Object(f.jsx)("td",{className:"dscr",children:e.dscr}),Object(f.jsxs)("td",{children:[e.available,!0===e.available&&"Available",!1===e.available&&"Unavailable"]}),Object(f.jsx)("td",{children:e.price}),Object(f.jsx)("td",{children:e.gst}),Object(f.jsx)("td",{children:Object(f.jsx)("button",{className:"remove",onClick:function(){return C((function(e){var n=Object(c.a)(e);return n.splice(t,1),n}))},children:Object(f.jsx)(j.I,{})})})]},t)}))})]}),!(null===k||void 0===k?void 0:k.length)&&Object(f.jsxs)("div",{className:"uploadFile",children:[Object(f.jsxs)("p",{children:["Upload xlsx/csv file in. See the example file"," ",Object(f.jsx)("a",{href:"/batch_product_upload_xlsx_file_example.csv",target:"_blank",children:"here"}),"."]}),Object(f.jsx)("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:function(e){e.target.files[0]&&function(e,t){e.name;var c=new FileReader;c.onload=function(){var e=Object(l.a)(i.a.mark((function e(c){var s,r,a,l,o,d,j,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.target.result,e.next=3,Promise.all([n.e(25),n.e(26)]).then(n.t.bind(null,284,7));case 3:r=e.sent,a=r.read(s,{type:"binary"}),l=a.SheetNames[0],o=a.Sheets[l],d=r.utils.sheet_to_json(o,{header:1}),j=[],u=d.shift(),d.forEach((function(e,t){var n={};u.forEach((function(t,c){var s;switch(t){case"Images":s="images";break;case"Name":s="name";break;case"Description":s="dscr";break;case"Material":s="material";break;case"Size [Please specify mm, cm, inch or KG]":s="size";break;case"Category":s="category";break;case"Type":s="type";break;case"Price in INR.":s="price";break;case"Units Available":s="available";break;case"HSN Code":s="hsn";break;case"GST %":s="gst";break;case"id":s="_id"}n[s]=e[c]})),j.push(n)})),t(j);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c.readAsBinaryString(e)}(e.target.files[0],(function(e){(null===e||void 0===e?void 0:e.length)&&C(e.filter((function(e){return e.type&&e.category&&e.name&&e.dscr&&void 0!==e.price})).map((function(e){return Object(s.a)(Object(s.a)({},e),{},{status:"",images:e.images.split(/,( |\n)/).filter((function(e){return e.trim()}))})})))})),e.target.value=null}})]}),!!(null===k||void 0===k?void 0:k.length)&&Object(f.jsx)("button",{className:"submit",onClick:function(){return Object(u.Confirm)({label:"Adding Batch products",question:"You sure want to add all these items?",callback:V})},children:"Add"})]}),h&&Object(f.jsx)("div",{className:"spinnerContainer",children:Object(f.jsx)("div",{className:"spinner"})}),Object(f.jsx)(u.Modal,{className:"msg",open:w,children:w})]})},L=["Buyer will be responsible for paying for shipping costs & for returning the item.","Shipping costs are nonrefundable.","Orders must be returned with Original Packaging & Securely.","Orders must be Returned Via Trackable / Traceable Courier Services Only.","Proof of Return via Photo of Tracking Number & Dispatch Ticket is Required.","Refund is Only Issued Upon Delivery of Return Package."],V=function(e){var t,n,c,s,a,i,l,b,h,O,x,p,m,v,g,y,k,C,M,N,S,F,_,P,D,w,A,T,I,Y,E,R,q,B,U,L,V,W,Z,K=e.categories,Q=e.setCategories,$=Object(o.useContext)(d.d),X=$.user,ee=($.setUser,Object(o.useState)(!1)),te=Object(r.a)(ee,2),ne=te[0],ce=te[1],se=Object(o.useState)(!1),re=Object(r.a)(se,2),ae=re[0],ie=re[1],le=Object(o.useState)(),oe=Object(r.a)(le,2),de=oe[0],je=oe[1],ue=Object(o.useState)(!1),be=Object(r.a)(ue,2),he=be[0],Oe=be[1],fe=Object(o.useState)(null),xe=Object(r.a)(fe,2),pe=xe[0],me=xe[1];return Object(f.jsxs)("div",{className:"settings",children:[Object(f.jsxs)("div",{className:"caution",children:[!(null===K||void 0===K?void 0:K.length)&&Object(f.jsx)("p",{className:"err",children:"Add at least 1 category."}),!(null===(t=X.shopInfo)||void 0===t||null===(n=t.terms)||void 0===n?void 0:n.length)&&Object(f.jsx)("p",{className:"err",children:"Add Return policy terms"}),(void 0===(null===(c=X.shopInfo)||void 0===c?void 0:c.shippingCost)||null===(null===(s=X.shopInfo)||void 0===s?void 0:s.shippingCost)||void 0===(null===(a=X.shopInfo)||void 0===a?void 0:a.deliveryWithin)||null===(null===(i=X.shopInfo)||void 0===i?void 0:i.deliveryWithin)||void 0===(null===(l=X.shopInfo)||void 0===l?void 0:l.refundable))&&Object(f.jsx)("p",{className:"err",children:"Add Shipping & Delivery detail"}),Object.values((null===(b=X.shopInfo)||void 0===b?void 0:b.paymentMethod)||{}).length<6&&Object(f.jsx)("p",{className:"err",children:"Add valid payment method"})]}),Object(f.jsxs)("div",{className:"cat",children:[Object(f.jsx)("h2",{className:"head",children:"Categories"}),Object(f.jsxs)("ul",{className:"categories",children:[K.map((function(e,t){return Object(f.jsxs)("li",{children:[e," ",Object(f.jsx)("button",{onClick:function(){return Object(u.Confirm)({label:"Remove Category",question:"You sure want to remove this category?",callback:function(){fetch("/api/categories",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e})}).then((function(e){return e.json()})).then((function(t){"ok"===t.code?Q((function(t){return t.filter((function(t){return t!==e}))})):me(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not delete category. Try again."})]})]}))})).catch((function(e){console.log(e),me(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not delete category. Make sure you're online."})]})]}))}))}})},children:Object(f.jsx)(j.I,{})})]},t)})),0===K.length&&Object(f.jsx)("li",{className:"placeholder",children:"No category found."})]}),Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.querySelector("input");fetch("/api/addCategory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:t.value})}).then((function(e){return e.json()})).then((function(e){"ok"===e.code?(Q(e.categories),t.value=""):me(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add category. Try again."})]})]}))})).catch((function(e){console.log(e),me(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return me(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not add category. Make sure you're online."})]})]}))}))},children:[Object(f.jsx)("input",{type:"text",required:!0,placeholder:"New Category. ie Mobile"}),Object(f.jsx)("button",{children:"Add category"})]})]}),Object(f.jsxs)("div",{className:"gst",children:[Object(f.jsxs)("h2",{className:"head",children:["GST"," ",!ne&&Object(f.jsx)("button",{onClick:function(){return ce(!0)},children:"Edit"})]}),Object(f.jsxs)("p",{className:"status",children:["Status:"," ",Object(f.jsx)("strong",{children:(null===(h=X.gst)||void 0===h?void 0:h.verified)?"Verified":"Unverified"})]}),ne?Object(f.jsx)(H,{setOpen:ce,setMsg:me}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("p",{children:["GST Registration number: ",(null===(O=X.gst)||void 0===O||null===(x=O.detail)||void 0===x?void 0:x.reg)||"N/A"]}),Object(f.jsxs)("p",{children:["GST amount: ",(null===(p=X.gst)||void 0===p?void 0:p.amount)?X.gst.amount+"%":"N/A"]}),Object(f.jsxs)("p",{children:["Files for verification:"," ",!(null===(m=X.gst)||void 0===m||null===(v=m.detail)||void 0===v||null===(g=v.files)||void 0===g?void 0:g.length)&&"N/A"]}),(null===(y=X.gst)||void 0===y||null===(k=y.detail)||void 0===k||null===(C=k.files)||void 0===C?void 0:C.length)&&Object(f.jsx)("ul",{className:"thumbs",children:Object(f.jsx)(j.q,{links:null===(M=X.gst)||void 0===M||null===(N=M.detail)||void 0===N?void 0:N.files})})]}),!(null===(S=X.gst)||void 0===S?void 0:S.verified)&&Object(f.jsx)("p",{className:"note",children:"*GST will apply once we review and verify your GST registraion."})]}),Object(f.jsxs)("div",{className:"payment",children:[Object(f.jsxs)("h2",{className:"head",children:["Payment Method"," ",!he&&Object(f.jsx)("button",{onClick:function(){return Oe(!0)},children:"Edit"})]}),he?Object(f.jsx)(J,{prefill:null===(F=X.shopInfo)||void 0===F?void 0:F.paymentMethod,setOpen:Oe,setMsg:me}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("p",{children:["Name: ",(null===(_=X.shopInfo)||void 0===_||null===(P=_.paymentMethod)||void 0===P?void 0:P.name)||"--"]}),Object(f.jsxs)("p",{children:["Bank: ",(null===(D=X.shopInfo)||void 0===D||null===(w=D.paymentMethod)||void 0===w?void 0:w.bank)||"--"]}),Object(f.jsxs)("p",{children:["City: ",(null===(A=X.shopInfo)||void 0===A||null===(T=A.paymentMethod)||void 0===T?void 0:T.city)||"--"]}),Object(f.jsxs)("p",{children:["Account type: ",(null===(I=X.shopInfo)||void 0===I||null===(Y=I.paymentMethod)||void 0===Y?void 0:Y.accountType)||"--"]}),Object(f.jsxs)("p",{children:["Account Number:"," ",(null===(E=X.shopInfo)||void 0===E||null===(R=E.paymentMethod)||void 0===R?void 0:R.accountNumber)||"--"]}),Object(f.jsxs)("p",{children:["ifsc: ",(null===(q=X.shopInfo)||void 0===q||null===(B=q.paymentMethod)||void 0===B?void 0:B.ifsc)||"--"]})]})]}),Object(f.jsxs)("div",{className:"terms shipping",children:[Object(f.jsxs)("h2",{className:"head",children:["Shipping & Delivery"," ",!ae&&Object(f.jsx)("button",{onClick:function(){return ie(!0)},children:"Edit"})]}),ae?Object(f.jsx)(G,{setOpen:ie,setMsg:me}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("p",{children:["Shipping cost:"," ",(null===(U=X.shopInfo)||void 0===U?void 0:U.shippingCost)?"\u20b9"+(null===(L=X.shopInfo)||void 0===L?void 0:L.shippingCost):"N/A"]}),Object(f.jsxs)("p",{children:["Delivery within (days): ",(null===(V=X.shopInfo)||void 0===V?void 0:V.deliveryWithin)||"N/A"]}),Object(f.jsxs)("p",{children:["Refundable: ",(null===(W=X.shopInfo)||void 0===W||null===(Z=W.refundable)||void 0===Z?void 0:Z.toString())||"N/A"]})]})]}),Object(f.jsxs)("div",{className:"terms return",children:[Object(f.jsxs)("h2",{className:"head",children:["Return Policy Terms"," ",!de&&Object(f.jsx)("button",{onClick:function(){return je(!0)},children:"Edit"})]}),Object(f.jsx)(z,{setOpen:je,termsEdit:de,setMsg:me})]}),Object(f.jsx)(u.Modal,{className:"msg",open:pe,children:pe})]})},H=function(e){var t,n,c,a,u,b,h,O=e.setOpen,x=e.setMsg,p=Object(o.useContext)(d.d),m=p.user,v=p.setUser,g=Object(o.useState)(!1),y=Object(r.a)(g,2),k=(y[0],y[1]),C=Object(o.useState)([]),M=Object(r.a)(C,2),N=M[0],S=M[1],_=Object(o.useState)(null===(t=m.gst)||void 0===t||null===(n=t.detail)||void 0===n?void 0:n.reg),P=Object(r.a)(_,2),D=P[0],w=P[1],A=Object(o.useState)(null===(c=m.gst)||void 0===c?void 0:c.amount),T=Object(r.a)(A,2),I=T[0],Y=T[1],E=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),k(!0),e.next=4,Object(j.G)({files:N,setMsg:x});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:n=e.t0,Object(F.updateProfileInfo)({"gst.detail.files":n,"gst.detail.reg":D,"gst.amount":I}).then((function(e){var t=e.user;k(!1),t&&(v((function(e){return Object(s.a)(Object(s.a)({},e),{},{gst:t.gst})})),O(!1))})).catch((function(e){k(!1),console.log(e),x(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return x(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upadte GST Information. Make sure you're online"})]})]}))}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("form",{onSubmit:E,children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"GST Registration Nubmer"}),Object(f.jsx)("input",{required:!0,type:"text",defaultValue:null===(a=m.gst)||void 0===a?void 0:a.detail.reg,name:"gst.detail.reg",onChange:function(e){return w(e.target.value)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"GST percentage (%)"}),Object(f.jsx)(j.t,{required:!0,defaultValue:null===(u=m.gst)||void 0===u?void 0:u.amount,name:"gst.detail.reg",onChange:function(e){return Y(e.target.value)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Upload files for verification"}),Object(f.jsx)(j.k,{multiple:!0,prefill:null===(b=m.gst)||void 0===b||null===(h=b.detail)||void 0===h?void 0:h.files,name:"gst.detail.files",onChange:function(e){return S(e)}})]}),Object(f.jsxs)("section",{className:"btns",children:[Object(f.jsx)("button",{children:"Save Changes"}),Object(f.jsx)("button",{type:"button",onClick:function(){return O(!1)},children:"Cancel"})]})]})},G=function(e){var t,n,c,a=e.setOpen,i=e.setMsg,l=Object(o.useContext)(d.d),u=l.user,b=l.setUser,h=Object(o.useState)((null===(t=u.shopInfo)||void 0===t?void 0:t.shippingCost)||0),O=Object(r.a)(h,2),x=O[0],p=O[1],m=Object(o.useState)(null===(n=u.shopInfo)||void 0===n?void 0:n.deliveryWithin),v=Object(r.a)(m,2),g=v[0],y=v[1],k=Object(o.useState)((null===(c=u.shopInfo)||void 0===c?void 0:c.refundable)||null),C=Object(r.a)(k,2),M=C[0],N=C[1];return Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.shippingCost":x,"shopInfo.deliveryWithin":g,"shopInfo.refundable":M}).then((function(e){var t=e.user;t&&(b((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:t.shopInfo})})),a(!1))})).catch((function(e){console.log(e),i(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return i(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upadte Terms. Make sure you're online"})]})]}))}))},children:[Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Shipping Cost \u20b9"}),Object(f.jsx)(j.t,{required:!0,defaultValue:x,name:"shippingCost",onChange:function(e){return p(e.target.value)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Delivery Within (days)"}),Object(f.jsx)(j.t,{required:!0,defaultValue:g,name:"deliveryWithin",min:1,step:"0",placeholder:"ie. 4 Days",onChange:function(e){return y(e.target.value)}})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("label",{children:"Refundable"}),Object(f.jsx)(j.h,{required:!0,defaultValue:0,onChange:function(e){return N(e.value)},options:[{label:"No",value:null},{label:"Upto 24 Hours After Delivery",value:"Upto 24 Hours After Delivery"},{label:"Upto 7 Days After Delivery",value:"Upto 7 Days After Delivery"},{label:"Upto 15 Days After Delivery",value:"Upto 15 Days After Delivery"}]})]}),Object(f.jsxs)("section",{className:"btns",children:[Object(f.jsx)("button",{children:"Save Changes"}),Object(f.jsx)("button",{type:"button",onClick:function(){return a(!1)},children:"Cancel"})]})]})},z=function(e){var t,n=e.setOpen,a=e.termsEdit,i=e.setMsg,l=Object(o.useContext)(d.d),u=l.user,b=l.setUser,h=Object(o.useState)((null===(t=u.shopInfo)||void 0===t?void 0:t.terms)||[]),x=Object(r.a)(h,2),p=x[0],m=x[1],v=Object(o.useState)(""),g=Object(r.a)(v,2),y=g[0],k=g[1];return Object(o.useEffect)((function(){var e;a?0===p.length&&m(L):m((null===(e=u.shopInfo)||void 0===e?void 0:e.terms)||[])}),[a]),Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.terms":p}).then((function(e){var t,c=e.user;c&&(b((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:c.shopInfo})})),n(!1),m(null===(t=c.shopInfo)||void 0===t?void 0:t.terms))})).catch((function(e){console.log(e),i(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return i(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not upadte Terms. Make sure you're online"})]})]}))}))},children:[Object(f.jsxs)("ul",{children:[p.map((function(e,t){return Object(f.jsxs)("li",{children:[e," ",a&&Object(f.jsx)("button",{type:"button",onClick:function(){return m((function(t){return t.filter((function(t){return t!==e}))}))},children:Object(f.jsx)(j.I,{})})]},t)})),0===p.length&&Object(f.jsx)("li",{children:"No terms has been added."})]}),a&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("section",{className:"addTerm",children:[Object(f.jsx)(O.a,{value:y,placeholder:"Add auditional term",onChange:function(e){return k(e.target.value)}}),Object(f.jsx)("button",{type:"button",onClick:function(){m((function(e){return y?[].concat(Object(c.a)(e.filter((function(e){return e!==y}))),[y]):e})),k("")},children:"Add Term"})]}),Object(f.jsxs)("section",{className:"btns",children:[Object(f.jsx)("button",{children:"Save Changes"}),Object(f.jsx)("button",{type:"button",onClick:function(){var e,t;n(!1),m((null===(e=u.shopInfo)||void 0===e||null===(t=e.terms)||void 0===t?void 0:t.length)?u.shopInfo.terms:L)},children:"Cancel"})]})]})]})},J=function(e){var t=e.prefill,n=(e.onSuccess,e.setMsg),c=e.setOpen,a=Object(o.useContext)(d.d).setUser,i=Object(o.useState)((null===t||void 0===t?void 0:t.bank)||""),l=Object(r.a)(i,2),u=l[0],b=l[1],h=Object(o.useState)((null===t||void 0===t?void 0:t.name)||""),O=Object(r.a)(h,2),x=O[0],p=O[1],m=Object(o.useState)((null===t||void 0===t?void 0:t.ifsc)||""),v=Object(r.a)(m,2),g=v[0],y=v[1],k=Object(o.useState)((null===t||void 0===t?void 0:t.city)||""),C=Object(r.a)(k,2),M=C[0],N=C[1],S=Object(o.useState)((null===t||void 0===t?void 0:t.accountType)||""),_=Object(r.a)(S,2),P=_[0],D=_[1],w=Object(o.useState)((null===t||void 0===t?void 0:t.accountNumber)||""),A=Object(r.a)(w,2),T=A[0],I=A[1];return Object(f.jsxs)("form",{className:"paymentMethodForm netBanking",onSubmit:function(e){e.preventDefault(),Object(F.updateProfileInfo)({"shopInfo.paymentMethod":{name:x,bank:u,city:M,accountType:P,ifsc:g,accountNumber:T}}).then((function(e){var t=e.user;t?(a((function(e){return Object(s.a)(Object(s.a)({},e),{},{shopInfo:t.shopInfo})})),c(!1)):n(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not update payment method. Please try again."})]})]}))})).catch((function(e){console.log(e),n(Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return n(null)},children:"Okay"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.i,{}),Object(f.jsx)("h4",{children:"Could not updated payment method. Make sure you're online."})]})]}))}))},children:[Object(f.jsxs)("section",{className:"inputs",children:[Object(f.jsx)("input",{type:"text",name:"name",placeholder:"Full name",value:x,onChange:function(e){return p(e.target.value)},required:!0}),Object(f.jsx)("input",{type:"text",name:"bank",placeholder:"Bank",value:u,onChange:function(e){return b(e.target.value)},required:!0}),Object(f.jsx)("input",{type:"text",name:"city",placeholder:"City",value:M,onChange:function(e){return N(e.target.value)},required:!0}),Object(f.jsx)("input",{type:"text",name:"type",placeholder:"Account type ie. Savings / Current",value:P,onChange:function(e){return D(e.target.value)},required:!0}),Object(f.jsx)("input",{type:"text",name:"accountNumber",placeholder:"Account Number",value:T,onChange:function(e){return I(e.target.value)},required:!0}),Object(f.jsx)("input",{type:"text",name:"ifsc",placeholder:"IFSC",value:g,onChange:function(e){return y(e.target.value)},required:!0})]}),Object(f.jsxs)("section",{className:"btns",children:[Object(f.jsx)("button",{type:"submit",children:"Save Changes"}),Object(f.jsx)("button",{type:"button",onClick:function(){return c(!1)},children:"Cancel"})]})]})};t.default=function(e){e.history,e.location,e.match;var t=Object(o.useContext)(d.d),n=t.user,c=t.userType,s=(window.FB,Object(o.useState)(null)),a=Object(r.a)(s,2),i=a[0],l=(a[1],Object(o.useState)([])),h=Object(r.a)(l,2),O=h[0],x=h[1],p=Object(o.useState)(!1),v=Object(r.a)(p,2),y=v[0],k=v[1];return Object(o.useEffect)((function(){fetch("/api/categories").then((function(e){return e.json()})).then((function(e){x(e.categories)}))}),[]),Object(o.useEffect)((function(){var e,t,c,s,r,a,i,l;!(null===O||void 0===O?void 0:O.length)||!(null===(e=n.shopInfo)||void 0===e||null===(t=e.terms)||void 0===t?void 0:t.length)||void 0===(null===(c=n.shopInfo)||void 0===c?void 0:c.shippingCost)||null===(null===(s=n.shopInfo)||void 0===s?void 0:s.shippingCost)||void 0===(null===(r=n.shopInfo)||void 0===r?void 0:r.deliveryWithin)||null===(null===(a=n.shopInfo)||void 0===a?void 0:a.deliveryWithin)||void 0===(null===(i=n.shopInfo)||void 0===i?void 0:i.refundable)||Object.values((null===(l=n.shopInfo)||void 0===l?void 0:l.paymentMethod)||{}).length<6?k(!1):k(!0)}),[O,n]),Object(o.useEffect)((function(){}),[n]),Object(f.jsxs)(f.Fragment,{children:["buyer"===c&&Object(f.jsx)(b.a,{to:"/account/orders/current"}),Object(f.jsxs)("div",{className:"myShop",children:[Object(f.jsx)("div",{style:{display:"none"},children:Object(f.jsx)(j.I,{})}),Object(f.jsx)(j.E,{basepath:"/account/myShop/",tabs:[{label:"Products & Services",path:"products"},{label:"Orders",path:"orders"},{label:"Refunds",path:"refunds"},{label:"Campaigns",path:"campaigns"},{label:"FB Marketplace",path:"fbMarketplace"},{label:"Settings",path:"settings"}]}),Object(f.jsxs)(b.d,{children:[Object(f.jsx)(b.b,{path:"/account/myShop/products",children:Object(f.jsx)(R,{categories:O,shopSetupComplete:y})}),Object(f.jsx)(b.b,{path:"/account/myShop/orders/:_id",component:m}),Object(f.jsx)(b.b,{path:"/account/myShop/orders",children:Object(f.jsx)(g,{categories:O})}),Object(f.jsx)(b.b,{path:"/account/myShop/refunds/:_id",component:C}),Object(f.jsx)(b.b,{path:"/account/myShop/refunds",component:M}),Object(f.jsx)(b.b,{path:"/account/myShop/campaigns",component:S}),Object(f.jsx)(b.b,{path:"/account/myShop/fbMarketplace",component:T}),Object(f.jsx)(b.b,{path:"/account/myShop/settings",children:Object(f.jsx)(V,{categories:O,setCategories:x})})]}),Object(f.jsx)(u.Modal,{className:"msg",open:i,children:i})]})]})}},174:function(e,t,n){"use strict";var c=n(11),s=n(24),r=n(1),a=r.useLayoutEffect,i=function(e){var t=Object(r.useRef)(e);return a((function(){t.current=e})),t},l=function(e,t){"function"!==typeof e?e.current=t:e(t)},o=function(e,t){var n=Object(r.useRef)();return Object(r.useCallback)((function(c){e.current=c,n.current&&l(n.current,null),n.current=t,t&&l(t,c)}),[t])},d={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},j=function(e){Object.keys(d).forEach((function(t){e.style.setProperty(t,d[t],"important")}))},u=null;var b=function(){},h=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],O=!!document.documentElement.currentStyle,f=function(e,t){var n=e.cacheMeasurements,a=e.maxRows,l=e.minRows,d=e.onChange,f=void 0===d?b:d,x=e.onHeightChange,p=void 0===x?b:x,m=Object(s.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var v=void 0!==m.value,g=Object(r.useRef)(null),y=o(g,t),k=Object(r.useRef)(0),C=Object(r.useRef)(),M=function(){var e=g.current,t=n&&C.current?C.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,c=(n=t,h.reduce((function(e,t){return e[t]=n[t],e}),{})),s=c.boxSizing;return""===s?null:(O&&"border-box"===s&&(c.width=parseFloat(c.width)+parseFloat(c.borderRightWidth)+parseFloat(c.borderLeftWidth)+parseFloat(c.paddingRight)+parseFloat(c.paddingLeft)+"px"),{sizingStyle:c,paddingSize:parseFloat(c.paddingBottom)+parseFloat(c.paddingTop),borderSize:parseFloat(c.borderBottomWidth)+parseFloat(c.borderTopWidth)})}(e);if(t){C.current=t;var c=function(e,t,n,c){void 0===n&&(n=1),void 0===c&&(c=1/0),u||((u=document.createElement("textarea")).setAttribute("tabindex","-1"),u.setAttribute("aria-hidden","true"),j(u)),null===u.parentNode&&document.body.appendChild(u);var s=e.paddingSize,r=e.borderSize,a=e.sizingStyle,i=a.boxSizing;Object.keys(a).forEach((function(e){var t=e;u.style[t]=a[t]})),j(u),u.value=t;var l=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize}(u,e);u.value="x";var o=u.scrollHeight-s,d=o*n;"border-box"===i&&(d=d+s+r),l=Math.max(d,l);var b=o*c;return"border-box"===i&&(b=b+s+r),[l=Math.min(b,l),o]}(t,e.value||e.placeholder||"x",l,a),s=c[0],r=c[1];k.current!==s&&(k.current=s,e.style.setProperty("height",s+"px","important"),p(s,{rowHeight:r}))}};return Object(r.useLayoutEffect)(M),function(e){var t=i(e);Object(r.useLayoutEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[])}(M),Object(r.createElement)("textarea",Object(c.a)({},m,{onChange:function(e){v||M(),f(e)},ref:y}))},x=Object(r.forwardRef)(f);t.a=x},197:function(e,t,n){},219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=t.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},a=t.isJsons=function(e){return Array.isArray(e)&&e.every((function(e){return"object"===("undefined"===typeof e?"undefined":c(e))&&!(e instanceof Array)}))},i=t.isArrays=function(e){return Array.isArray(e)&&e.every((function(e){return Array.isArray(e)}))},l=t.jsonsHeaders=function(e){return Array.from(e.map((function(e){return Object.keys(e)})).reduce((function(e,t){return new Set([].concat(s(e),s(t)))}),[]))},o=t.jsons2arrays=function(e,t){var n=t=t||l(e),c=t;a(t)&&(n=t.map((function(e){return e.label})),c=t.map((function(e){return e.key})));var r=e.map((function(e){return c.map((function(t){return d(t,e)}))}));return[n].concat(s(r))},d=t.getHeaderValue=function(e,t){var n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce((function(e,t,n,c){if(void 0!==e[t])return e[t];c.splice(1)}),t);return void 0===n?e in t?t[e]:"":n},j=t.elementOrEmpty=function(e){return e||0===e?e:""},u=t.joiner=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'"';return e.filter((function(e){return e})).map((function(e){return e.map((function(e){return j(e)})).map((function(e){return""+n+e+n})).join(t)})).join("\n")},b=t.arrays2csv=function(e,t,n,c){return u(t?[t].concat(s(e)):e,n,c)},h=t.jsons2csv=function(e,t,n,c){return u(o(e,t),n,c)},O=t.string2csv=function(e,t,n,c){return t?t.join(n)+"\n"+e:e},f=t.toCSV=function(e,t,n,c){if(a(e))return h(e,t,n,c);if(i(e))return b(e,t,n,c);if("string"===typeof e)return O(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};t.buildURI=function(e,t,n,c,s){var a=f(e,n,c,s),i=r()?"application/csv":"text/csv",l=new Blob([t?"\ufeff":"",a],{type:i}),o="data:"+i+";charset=utf-8,"+(t?"\ufeff":"")+a,d=window.URL||window.webkitURL;return"undefined"===typeof d.createObjectURL?o:d.createObjectURL(l)}},220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropsNotForwarded=t.defaultProps=t.propTypes=void 0;var c,s=n(1),r=((c=s)&&c.__esModule,n(29));t.propTypes={data:(0,r.oneOfType)([r.string,r.array]).isRequired,headers:r.array,target:r.string,separator:r.string,filename:r.string,uFEFF:r.bool,onClick:r.func,asyncOnClick:r.bool},t.defaultProps={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1},t.PropsNotForwarded=["data","headers"]},249:function(e,t,n){},250:function(e,t,n){e.exports=n(251)},251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CSVLink=t.CSVDownload=void 0;var c=r(n(252)),s=r(n(253));function r(e){return e&&e.__esModule?e:{default:e}}t.CSVDownload=c.default,t.CSVLink=s.default},252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}return function(t,n,c){return n&&e(t.prototype,n),c&&e(t,c),t}}(),r=n(1),a=(c=r)&&c.__esModule?c:{default:c},i=n(219),l=n(220);var o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"buildURI",value:function(){return i.buildURI.apply(void 0,arguments)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,c=e.separator,s=e.enclosingCharacter,r=e.uFEFF,a=e.target,i=e.specs,l=e.replace;this.state.page=window.open(this.buildURI(t,r,n,c,s),a,i,l)}},{key:"getWindow",value:function(){return this.state.page}},{key:"render",value:function(){return null}}]),t}(a.default.Component);o.defaultProps=Object.assign(l.defaultProps,{target:"_blank"}),o.propTypes=l.propTypes,t.default=o},253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}return function(t,n,c){return n&&e(t.prototype,n),c&&e(t,c),t}}(),a=n(1),i=(c=a)&&c.__esModule?c:{default:c},l=n(219),o=n(220);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildURI=n.buildURI.bind(n),n.state={href:""},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,c=e.separator,s=e.uFEFF,r=e.enclosingCharacter;this.setState({href:this.buildURI(t,s,n,c,r)})}},{key:"componentDidUpdate",value:function(e){if(this.props!==e){var t=this.props,n=t.data,c=t.headers,s=t.separator,r=t.uFEFF;this.setState({href:this.buildURI(n,r,c,s)})}}},{key:"buildURI",value:function(){return l.buildURI.apply(void 0,arguments)}},{key:"handleLegacy",value:function(e){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();var t=this.props,n=t.data,c=t.headers,s=t.separator,r=t.filename,a=t.enclosingCharacter,i=t.uFEFF,o=new Blob([i?"\ufeff":"",(0,l.toCSV)(n,c,s,a)]);return window.navigator.msSaveBlob(o,r),!1}}},{key:"handleAsyncClick",value:function(e){var t=this;this.props.onClick(e,(function(n){!1!==n?t.handleLegacy(e):e.preventDefault()}))}},{key:"handleSyncClick",value:function(e){!1===this.props.onClick(e)?e.preventDefault():this.handleLegacy(e)}},{key:"handleClick",value:function(){var e=this;return function(t){if("function"===typeof e.props.onClick)return e.props.asyncOnClick?e.handleAsyncClick(t):e.handleSyncClick(t);e.handleLegacy(t)}}},{key:"render",value:function(){var e=this,t=this.props,n=(t.data,t.headers,t.separator,t.filename),c=(t.uFEFF,t.children),r=(t.onClick,t.asyncOnClick,t.enclosingCharacter,function(e,t){var n={};for(var c in e)t.indexOf(c)>=0||Object.prototype.hasOwnProperty.call(e,c)&&(n[c]=e[c]);return n}(t,["data","headers","separator","filename","uFEFF","children","onClick","asyncOnClick","enclosingCharacter"]));return i.default.createElement("a",s({download:n},r,{ref:function(t){return e.link=t},target:"_self",href:this.state.href,onClick:this.handleClick()}),c)}}]),t}(i.default.Component);d.defaultProps=o.defaultProps,d.propTypes=o.propTypes,t.default=d},254:function(e,t,n){}}]);
//# sourceMappingURL=12.05e3e7c9.chunk.js.map